ğŸš€ BBU Training Launcher
   ğŸ“„ Config: base_flat_v2 | ğŸ–¥ï¸ GPUs: 0,1,2,3,4,5 | ğŸ“Š Log: INFO
   ğŸ“„ Output redirected to run.log
ğŸŒ Setting up environment...
âœ… Environment configured (Python: /opt/conda/envs/ms/bin/python)
ğŸš€ Multi-GPU detected (6 GPUs) - DeepSpeed ENABLED
   ğŸ”§ BBU_DEEPSPEED_ENABLED=true
   âš™ï¸  BBU_DEEPSPEED_CONFIG=scripts/zero2.json
   ğŸ–¥ï¸  BBU_NUM_GPUS=6
ğŸ” Validating configuration...
âœ… DeepSpeed config validated: scripts/zero2.json
âœ… Configuration validation passed
ğŸš€ Multi-GPU Training with DeepSpeed
   ğŸ–¥ï¸  GPUs: 6 devices (0,1,2,3,4,5)
   âš™ï¸  DeepSpeed Config: scripts/zero2.json
   ğŸ“„ Training Config: base_flat_v2
   ğŸ“Š Log Level: INFO (Verbose: true)
   ğŸ”— Master Port: 24295 (randomly generated)
ğŸ“„ Loading configuration...
ğŸ“„ Using legacy configuration system
âœ… Legacy config loaded: configs/base_flat_v2.yaml
ğŸ“Š Configuring logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸš€ BBU Training Started - Direct Configuration System
2025-07-04 09:08:33 - INFO - training - ğŸ“„ Config: base_flat_v2
2025-07-04 09:08:33 - INFO - training - ğŸ“Š Logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸŒ Environment: All variables handled by launcher script
2025-07-04 09:08:33 - INFO - training - ğŸ”§ Configuration loaded and validated successfully
ğŸ“„ Loading configuration...
ğŸ“„ Using legacy configuration system
ğŸ“„ Loading configuration...
ğŸ“„ Using legacy configuration system
ğŸ“„ Loading configuration...
ğŸ“„ Using legacy configuration system
âœ… Legacy config loaded: configs/base_flat_v2.yaml
ğŸ“Š Configuring logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸš€ BBU Training Started - Direct Configuration System
2025-07-04 09:08:33 - INFO - training - ğŸ“„ Config: base_flat_v2
2025-07-04 09:08:33 - INFO - training - ğŸ“Š Logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸŒ Environment: All variables handled by launcher script
2025-07-04 09:08:33 - INFO - training - ğŸ”§ Configuration loaded and validated successfully
âœ… Legacy config loaded: configs/base_flat_v2.yaml
ğŸ“Š Configuring logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸš€ BBU Training Started - Direct Configuration System
2025-07-04 09:08:33 - INFO - training - ğŸ“„ Config: base_flat_v2
2025-07-04 09:08:33 - INFO - training - ğŸ“Š Logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸŒ Environment: All variables handled by launcher script
2025-07-04 09:08:33 - INFO - training - ğŸ”§ Configuration loaded and validated successfully
âœ… Legacy config loaded: configs/base_flat_v2.yaml
ğŸ“Š Configuring logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸš€ BBU Training Started - Direct Configuration System
2025-07-04 09:08:33 - INFO - training - ğŸ“„ Config: base_flat_v2
2025-07-04 09:08:33 - INFO - training - ğŸ“Š Logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸŒ Environment: All variables handled by launcher script
2025-07-04 09:08:33 - INFO - training - ğŸ”§ Configuration loaded and validated successfully
ğŸ“„ Loading configuration...
ğŸ“„ Using legacy configuration system
ğŸ“„ Loading configuration...
ğŸ“„ Using legacy configuration system
âœ… Legacy config loaded: configs/base_flat_v2.yaml
ğŸ“Š Configuring logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸš€ BBU Training Started - Direct Configuration System
2025-07-04 09:08:33 - INFO - training - ğŸ“„ Config: base_flat_v2
2025-07-04 09:08:33 - INFO - training - ğŸ“Š Logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸŒ Environment: All variables handled by launcher script
2025-07-04 09:08:33 - INFO - training - ğŸ”§ Configuration loaded and validated successfully
âœ… Legacy config loaded: configs/base_flat_v2.yaml
ğŸ“Š Configuring logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸš€ BBU Training Started - Direct Configuration System
2025-07-04 09:08:33 - INFO - training - ğŸ“„ Config: base_flat_v2
2025-07-04 09:08:33 - INFO - training - ğŸ“Š Logging: Level=INFO, Verbose=True, Console=INFO
2025-07-04 09:08:33 - INFO - training - ğŸŒ Environment: All variables handled by launcher script
2025-07-04 09:08:33 - INFO - training - ğŸ”§ Configuration loaded and validated successfully
[2025-07-04 09:08:36,379] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-07-04 09:08:36,469] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-07-04 09:08:36,481] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-07-04 09:08:36,495] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-07-04 09:08:36,498] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-07-04 09:08:36,499] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-07-04 09:08:37 - INFO - datasets - PyTorch version 2.4.0 available.
2025-07-04 09:08:37 - INFO - datasets - PyTorch version 2.4.0 available.
2025-07-04 09:08:37 - INFO - datasets - PyTorch version 2.4.0 available.
2025-07-04 09:08:37 - INFO - datasets - PyTorch version 2.4.0 available.
2025-07-04 09:08:37 - INFO - datasets - PyTorch version 2.4.0 available.
2025-07-04 09:08:37 - INFO - training - ğŸ”§ Creating TrainingArguments with DeepSpeed configuration...
[2025-07-04 09:08:37,696] [INFO] [comm.py:669:init_distributed] cdb=None
[W704 09:08:37.176791004 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
2025-07-04 09:08:37 - INFO - datasets - PyTorch version 2.4.0 available.
2025-07-04 09:08:37 - INFO - training - ğŸ”§ Creating TrainingArguments with DeepSpeed configuration...
[2025-07-04 09:08:37,801] [INFO] [comm.py:669:init_distributed] cdb=None
[W704 09:08:37.282225521 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
2025-07-04 09:08:37 - INFO - training - ğŸ”§ Creating TrainingArguments with DeepSpeed configuration...
[2025-07-04 09:08:37,833] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-07-04 09:08:37,833] [INFO] [comm.py:700:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[W704 09:08:37.315412701 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
2025-07-04 09:08:37 - INFO - training - ğŸ”§ Creating TrainingArguments with DeepSpeed configuration...
[2025-07-04 09:08:37,846] [INFO] [comm.py:669:init_distributed] cdb=None
[W704 09:08:37.331260371 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
2025-07-04 09:08:37 - INFO - training - ğŸ”§ Creating TrainingArguments with DeepSpeed configuration...
[2025-07-04 09:08:37,867] [INFO] [comm.py:669:init_distributed] cdb=None
[W704 09:08:37.350364555 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
2025-07-04 09:08:37 - INFO - training - ğŸ”§ Creating TrainingArguments with DeepSpeed configuration...
[2025-07-04 09:08:37,958] [INFO] [comm.py:669:init_distributed] cdb=None
[W704 09:08:37.439371158 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
2025-07-04 09:08:38 - INFO - training - ğŸ‹ï¸ Creating unified BBU trainer...
2025-07-04 09:08:38 - INFO - training - ğŸ”§ Setting up model with UNIFIED loading mechanism...
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ UNIFIED MODEL LOADING: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader -    Mode: TRAINING
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ Applying comprehensive Qwen2.5-VL fixes...
2025-07-04 09:08:38 - INFO - patches - âœ… Official mRoPE fix applied (with batch dimension fix)
2025-07-04 09:08:38 - INFO - patches - âœ… Safe visual forward patch applied for generation
2025-07-04 09:08:38 - INFO - patches - ğŸ”‡ qwenvl Flash-Attention override skipped â€“ using HF default
2025-07-04 09:08:38 - INFO - patches - âœ… All Qwen2.5-VL fixes applied successfully
2025-07-04 09:08:38 - INFO - patches -    - mRoPE: Uses official doubling logic + batch fix
2025-07-04 09:08:38 - INFO - patches -    - Visual: Safe processing for generation
2025-07-04 09:08:38 - INFO - patches -    - Dimension handling: Robust edge case management
2025-07-04 09:08:38 - INFO - patches -    - Batch handling: Fixed mrope_section duplication
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ¯ Detection mode from config: False
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”¤ Loading tokenizer from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - training - ğŸ‹ï¸ Creating unified BBU trainer...
2025-07-04 09:08:38 - INFO - training - ğŸ”§ Setting up model with UNIFIED loading mechanism...
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ UNIFIED MODEL LOADING: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader -    Mode: TRAINING
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ Applying comprehensive Qwen2.5-VL fixes...
2025-07-04 09:08:38 - INFO - patches - âœ… Official mRoPE fix applied (with batch dimension fix)
2025-07-04 09:08:38 - INFO - patches - âœ… Safe visual forward patch applied for generation
2025-07-04 09:08:38 - INFO - patches - ğŸ”‡ qwenvl Flash-Attention override skipped â€“ using HF default
2025-07-04 09:08:38 - INFO - patches - âœ… All Qwen2.5-VL fixes applied successfully
2025-07-04 09:08:38 - INFO - patches -    - mRoPE: Uses official doubling logic + batch fix
2025-07-04 09:08:38 - INFO - patches -    - Visual: Safe processing for generation
2025-07-04 09:08:38 - INFO - patches -    - Dimension handling: Robust edge case management
2025-07-04 09:08:38 - INFO - patches -    - Batch handling: Fixed mrope_section duplication
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ¯ Detection mode from config: False
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”¤ Loading tokenizer from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - training - ğŸ‹ï¸ Creating unified BBU trainer...
2025-07-04 09:08:38 - INFO - training - ğŸ”§ Setting up model with UNIFIED loading mechanism...
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ UNIFIED MODEL LOADING: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader -    Mode: TRAINING
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ Applying comprehensive Qwen2.5-VL fixes...
2025-07-04 09:08:38 - INFO - patches - âœ… Official mRoPE fix applied (with batch dimension fix)
2025-07-04 09:08:38 - INFO - patches - âœ… Safe visual forward patch applied for generation
2025-07-04 09:08:38 - INFO - patches - ğŸ”‡ qwenvl Flash-Attention override skipped â€“ using HF default
2025-07-04 09:08:38 - INFO - patches - âœ… All Qwen2.5-VL fixes applied successfully
2025-07-04 09:08:38 - INFO - patches -    - mRoPE: Uses official doubling logic + batch fix
2025-07-04 09:08:38 - INFO - patches -    - Visual: Safe processing for generation
2025-07-04 09:08:38 - INFO - patches -    - Dimension handling: Robust edge case management
2025-07-04 09:08:38 - INFO - patches -    - Batch handling: Fixed mrope_section duplication
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ¯ Detection mode from config: False
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”¤ Loading tokenizer from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - training - ğŸ‹ï¸ Creating unified BBU trainer...
2025-07-04 09:08:38 - INFO - training - ğŸ”§ Setting up model with UNIFIED loading mechanism...
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ UNIFIED MODEL LOADING: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader -    Mode: TRAINING
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ Applying comprehensive Qwen2.5-VL fixes...
2025-07-04 09:08:38 - INFO - patches - âœ… Official mRoPE fix applied (with batch dimension fix)
2025-07-04 09:08:38 - INFO - patches - âœ… Safe visual forward patch applied for generation
2025-07-04 09:08:38 - INFO - patches - ğŸ”‡ qwenvl Flash-Attention override skipped â€“ using HF default
2025-07-04 09:08:38 - INFO - patches - âœ… All Qwen2.5-VL fixes applied successfully
2025-07-04 09:08:38 - INFO - patches -    - mRoPE: Uses official doubling logic + batch fix
2025-07-04 09:08:38 - INFO - patches -    - Visual: Safe processing for generation
2025-07-04 09:08:38 - INFO - patches -    - Dimension handling: Robust edge case management
2025-07-04 09:08:38 - INFO - patches -    - Batch handling: Fixed mrope_section duplication
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ¯ Detection mode from config: False
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”¤ Loading tokenizer from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - training - ğŸ‹ï¸ Creating unified BBU trainer...
2025-07-04 09:08:38 - INFO - training - ğŸ”§ Setting up model with UNIFIED loading mechanism...
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ UNIFIED MODEL LOADING: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader -    Mode: TRAINING
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ Applying comprehensive Qwen2.5-VL fixes...
2025-07-04 09:08:38 - INFO - patches - âœ… Official mRoPE fix applied (with batch dimension fix)
2025-07-04 09:08:38 - INFO - patches - âœ… Safe visual forward patch applied for generation
2025-07-04 09:08:38 - INFO - patches - ğŸ”‡ qwenvl Flash-Attention override skipped â€“ using HF default
2025-07-04 09:08:38 - INFO - patches - âœ… All Qwen2.5-VL fixes applied successfully
2025-07-04 09:08:38 - INFO - patches -    - mRoPE: Uses official doubling logic + batch fix
2025-07-04 09:08:38 - INFO - training - ğŸ‹ï¸ Creating unified BBU trainer...
2025-07-04 09:08:38 - INFO - patches -    - Visual: Safe processing for generation
2025-07-04 09:08:38 - INFO - patches -    - Dimension handling: Robust edge case management
2025-07-04 09:08:38 - INFO - training - ğŸ”§ Setting up model with UNIFIED loading mechanism...
2025-07-04 09:08:38 - INFO - patches -    - Batch handling: Fixed mrope_section duplication
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ¯ Detection mode from config: False
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”¤ Loading tokenizer from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ UNIFIED MODEL LOADING: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader -    Mode: TRAINING
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”§ Applying comprehensive Qwen2.5-VL fixes...
2025-07-04 09:08:38 - INFO - patches - âœ… Official mRoPE fix applied (with batch dimension fix)
2025-07-04 09:08:38 - INFO - patches - âœ… Safe visual forward patch applied for generation
2025-07-04 09:08:38 - INFO - patches - ğŸ”‡ qwenvl Flash-Attention override skipped â€“ using HF default
2025-07-04 09:08:38 - INFO - patches - âœ… All Qwen2.5-VL fixes applied successfully
2025-07-04 09:08:38 - INFO - patches -    - mRoPE: Uses official doubling logic + batch fix
2025-07-04 09:08:38 - INFO - patches -    - Visual: Safe processing for generation
2025-07-04 09:08:38 - INFO - patches -    - Dimension handling: Robust edge case management
2025-07-04 09:08:38 - INFO - patches -    - Batch handling: Fixed mrope_section duplication
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ¯ Detection mode from config: False
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ”¤ Loading tokenizer from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“„ Loading BASE model (no detection)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“„ Loading BASE model (no detection)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“„ Loading BASE model (no detection)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“„ Loading BASE model (no detection)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“„ Loading BASE model (no detection)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“„ Loading BASE model (no detection)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  7.10it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  6.94it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 10.57it/s]
2025-07-04 09:08:38 - INFO - unified_loader - âœ… Base model loaded successfully
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“Š Loading processor from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - data_conversion.vision_process - set VIDEO_TOTAL_PIXELS: 90316800
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 10.40it/s]
2025-07-04 09:08:38 - INFO - unified_loader - âœ… Base model loaded successfully
2025-07-04 09:08:38 - INFO - unified_loader - ğŸ“Š Loading processor from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:38 - INFO - data_conversion.vision_process - set VIDEO_TOTAL_PIXELS: 90316800
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  6.99it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 10.41it/s]
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Base model loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ“Š Loading processor from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:39 - INFO - data_conversion.vision_process - set VIDEO_TOTAL_PIXELS: 90316800
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  7.10it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  6.96it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  6.94it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 10.54it/s]
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Base model loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ“Š Loading processor from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:39 - INFO - data_conversion.vision_process - set VIDEO_TOTAL_PIXELS: 90316800
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 10.39it/s]
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Base model loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ“Š Loading processor from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:39 - INFO - data_conversion.vision_process - set VIDEO_TOTAL_PIXELS: 90316800
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 10.36it/s]
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Base model loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ“Š Loading processor from: /data4/Qwen2.5-VL-main/model_cache/Qwen/Qwen2.5-VL-3B-Instruct
2025-07-04 09:08:39 - INFO - data_conversion.vision_process - set VIDEO_TOTAL_PIXELS: 90316800
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Processor loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ”§ Applying training chat template...
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Training chat template applied
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ” Verifying Qwen2.5-VL patches...
2025-07-04 09:08:39 - INFO - patches - âœ… mRoPE patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… Safe visual forward patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… All patch verifications successful
2025-07-04 09:08:39 - INFO - unified_loader - âœ… UNIFIED MODEL LOADING COMPLETE
2025-07-04 09:08:39 - INFO - unified_loader -    Model type: Base model
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer vocab size: 151665
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer padding side: right
2025-07-04 09:08:39 - INFO - unified_loader -    Model device: cpu
2025-07-04 09:08:39 - INFO - unified_loader -    Model dtype: torch.bfloat16
2025-07-04 09:08:39 - INFO - training - âœ… Training model setup completed via unified loader
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Vision encoder: TRAINING (lr=8e-07)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ MLP connector: TRAINING (lr=2e-05)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ LLM: TRAINING (lr=5e-06)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Detection head: DISABLED (config.detection_enabled False)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Setting up data module with context-aware prompts...
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚\n\nã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š\n\n1. **BBUè®¾å¤‡**\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n\n2. **èºä¸æˆ–è¿æ¥ç‚¹**\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)\n   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹\n   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š\n     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”\n     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚\n     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š\n     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœ'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    '\n2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´\n3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰\n4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†\n\nã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\n\nåæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š\n\n- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    'Uå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - data - âœ… TeacherPoolManager initialized:
2025-07-04 09:08:39 - INFO - data -    Teacher pool file: data/teacher.jsonl
2025-07-04 09:08:39 - INFO - data -    Number of teacher images: 10
2025-07-04 09:08:39 - INFO - data -    Number of teacher samples: 10
2025-07-04 09:08:39 - INFO - training - âœ… Teacher pool manager created with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 347 samples from data/train.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: training
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool size: 10
2025-07-04 09:08:39 - INFO - data - Training dataset: teacher ratio set to 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool manager active with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 38 samples from data/val.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: evaluation
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.0
2025-07-04 09:08:39 - INFO - data - Validation dataset detected, disabling teacher sampling for zero-shot evaluation.
2025-07-04 09:08:39 - INFO - training - âœ… Data module setup completed with improved prompts:
2025-07-04 09:08:39 - INFO - training -    Train samples: 347 (detailed prompts, teacher_ratio=0.7)
2025-07-04 09:08:39 - INFO - training -    Val samples: 38 (concise prompts, no teachers)
2025-07-04 09:08:39 - INFO - training -    Collator type: standard
2025-07-04 09:08:39 - INFO - training -    Training prompt: ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. ...
2025-07-04 09:08:39 - INFO - training -    Evaluation prompt: ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: B...
/data4/Qwen2.5-VL-main/src/training/trainer.py:135: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `BBUTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Processor loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ”§ Applying training chat template...
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Training chat template applied
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ” Verifying Qwen2.5-VL patches...
2025-07-04 09:08:39 - INFO - patches - âœ… mRoPE patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… Safe visual forward patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… All patch verifications successful
2025-07-04 09:08:39 - INFO - unified_loader - âœ… UNIFIED MODEL LOADING COMPLETE
2025-07-04 09:08:39 - INFO - unified_loader -    Model type: Base model
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer vocab size: 151665
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer padding side: right
2025-07-04 09:08:39 - INFO - unified_loader -    Model device: cpu
2025-07-04 09:08:39 - INFO - unified_loader -    Model dtype: torch.bfloat16
2025-07-04 09:08:39 - INFO - training - âœ… Training model setup completed via unified loader
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Vision encoder: TRAINING (lr=8e-07)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ MLP connector: TRAINING (lr=2e-05)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ LLM: TRAINING (lr=5e-06)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Detection head: DISABLED (config.detection_enabled False)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Setting up data module with context-aware prompts...
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚\n\nã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š\n\n1. **BBUè®¾å¤‡**\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n\n2. **èºä¸æˆ–è¿æ¥ç‚¹**\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)\n   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹\n   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š\n     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”\n     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚\n     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š\n     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœ'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    '\n2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´\n3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰\n4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†\n\nã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\n\nåæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š\n\n- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    'Uå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - data - âœ… TeacherPoolManager initialized:
2025-07-04 09:08:39 - INFO - data -    Teacher pool file: data/teacher.jsonl
2025-07-04 09:08:39 - INFO - data -    Number of teacher images: 10
2025-07-04 09:08:39 - INFO - data -    Number of teacher samples: 10
2025-07-04 09:08:39 - INFO - training - âœ… Teacher pool manager created with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 347 samples from data/train.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: training
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool size: 10
2025-07-04 09:08:39 - INFO - data - Training dataset: teacher ratio set to 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool manager active with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 38 samples from data/val.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: evaluation
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.0
2025-07-04 09:08:39 - INFO - data - Validation dataset detected, disabling teacher sampling for zero-shot evaluation.
2025-07-04 09:08:39 - INFO - training - âœ… Data module setup completed with improved prompts:
2025-07-04 09:08:39 - INFO - training -    Train samples: 347 (detailed prompts, teacher_ratio=0.7)
2025-07-04 09:08:39 - INFO - training -    Val samples: 38 (concise prompts, no teachers)
2025-07-04 09:08:39 - INFO - training -    Collator type: standard
2025-07-04 09:08:39 - INFO - training -    Training prompt: ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. ...
2025-07-04 09:08:39 - INFO - training -    Evaluation prompt: ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: B...
/data4/Qwen2.5-VL-main/src/training/trainer.py:135: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `BBUTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Processor loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ”§ Applying training chat template...
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Training chat template applied
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ” Verifying Qwen2.5-VL patches...
2025-07-04 09:08:39 - INFO - patches - âœ… mRoPE patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… Safe visual forward patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… All patch verifications successful
2025-07-04 09:08:39 - INFO - unified_loader - âœ… UNIFIED MODEL LOADING COMPLETE
2025-07-04 09:08:39 - INFO - unified_loader -    Model type: Base model
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer vocab size: 151665
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer padding side: right
2025-07-04 09:08:39 - INFO - unified_loader -    Model device: cpu
2025-07-04 09:08:39 - INFO - unified_loader -    Model dtype: torch.bfloat16
2025-07-04 09:08:39 - INFO - training - âœ… Training model setup completed via unified loader
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Vision encoder: TRAINING (lr=8e-07)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ MLP connector: TRAINING (lr=2e-05)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ LLM: TRAINING (lr=5e-06)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Detection head: DISABLED (config.detection_enabled False)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Setting up data module with context-aware prompts...
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚\n\nã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š\n\n1. **BBUè®¾å¤‡**\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n\n2. **èºä¸æˆ–è¿æ¥ç‚¹**\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)\n   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹\n   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š\n     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”\n     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚\n     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š\n     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœ'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    '\n2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´\n3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰\n4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†\n\nã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\n\nåæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š\n\n- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    'Uå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - data - âœ… TeacherPoolManager initialized:
2025-07-04 09:08:39 - INFO - data -    Teacher pool file: data/teacher.jsonl
2025-07-04 09:08:39 - INFO - data -    Number of teacher images: 10
2025-07-04 09:08:39 - INFO - data -    Number of teacher samples: 10
2025-07-04 09:08:39 - INFO - training - âœ… Teacher pool manager created with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 347 samples from data/train.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: training
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool size: 10
2025-07-04 09:08:39 - INFO - data - Training dataset: teacher ratio set to 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool manager active with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 38 samples from data/val.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: evaluation
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.0
2025-07-04 09:08:39 - INFO - data - Validation dataset detected, disabling teacher sampling for zero-shot evaluation.
2025-07-04 09:08:39 - INFO - training - âœ… Data module setup completed with improved prompts:
2025-07-04 09:08:39 - INFO - training -    Train samples: 347 (detailed prompts, teacher_ratio=0.7)
2025-07-04 09:08:39 - INFO - training -    Val samples: 38 (concise prompts, no teachers)
2025-07-04 09:08:39 - INFO - training -    Collator type: standard
2025-07-04 09:08:39 - INFO - training -    Training prompt: ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. ...
2025-07-04 09:08:39 - INFO - training -    Evaluation prompt: ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: B...
/data4/Qwen2.5-VL-main/src/training/trainer.py:135: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `BBUTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Processor loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ”§ Applying training chat template...
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Training chat template applied
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ” Verifying Qwen2.5-VL patches...
2025-07-04 09:08:39 - INFO - patches - âœ… mRoPE patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… Safe visual forward patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… All patch verifications successful
2025-07-04 09:08:39 - INFO - unified_loader - âœ… UNIFIED MODEL LOADING COMPLETE
2025-07-04 09:08:39 - INFO - unified_loader -    Model type: Base model
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer vocab size: 151665
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer padding side: right
2025-07-04 09:08:39 - INFO - unified_loader -    Model device: cpu
2025-07-04 09:08:39 - INFO - unified_loader -    Model dtype: torch.bfloat16
2025-07-04 09:08:39 - INFO - training - âœ… Training model setup completed via unified loader
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Vision encoder: TRAINING (lr=8e-07)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ MLP connector: TRAINING (lr=2e-05)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ LLM: TRAINING (lr=5e-06)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Detection head: DISABLED (config.detection_enabled False)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Setting up data module with context-aware prompts...
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚\n\nã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š\n\n1. **BBUè®¾å¤‡**\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n\n2. **èºä¸æˆ–è¿æ¥ç‚¹**\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)\n   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹\n   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š\n     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”\n     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚\n     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š\n     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœ'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    '\n2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´\n3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰\n4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†\n\nã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\n\nåæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š\n\n- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    'Uå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - data - âœ… TeacherPoolManager initialized:
2025-07-04 09:08:39 - INFO - data -    Teacher pool file: data/teacher.jsonl
2025-07-04 09:08:39 - INFO - data -    Number of teacher images: 10
2025-07-04 09:08:39 - INFO - data -    Number of teacher samples: 10
2025-07-04 09:08:39 - INFO - training - âœ… Teacher pool manager created with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 347 samples from data/train.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: training
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool size: 10
2025-07-04 09:08:39 - INFO - data - Training dataset: teacher ratio set to 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool manager active with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 38 samples from data/val.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: evaluation
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.0
2025-07-04 09:08:39 - INFO - data - Validation dataset detected, disabling teacher sampling for zero-shot evaluation.
2025-07-04 09:08:39 - INFO - training - âœ… Data module setup completed with improved prompts:
2025-07-04 09:08:39 - INFO - training -    Train samples: 347 (detailed prompts, teacher_ratio=0.7)
2025-07-04 09:08:39 - INFO - training -    Val samples: 38 (concise prompts, no teachers)
2025-07-04 09:08:39 - INFO - training -    Collator type: standard
2025-07-04 09:08:39 - INFO - training -    Training prompt: ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. ...
2025-07-04 09:08:39 - INFO - training -    Evaluation prompt: ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: B...
/data4/Qwen2.5-VL-main/src/training/trainer.py:135: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `BBUTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-07-04 09:08:39 - INFO - training - âœ… Added 2 special tokens to the tokenizer.
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Processor loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ”§ Applying training chat template...
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Training chat template applied
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ” Verifying Qwen2.5-VL patches...
2025-07-04 09:08:39 - INFO - patches - âœ… mRoPE patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… Safe visual forward patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… All patch verifications successful
2025-07-04 09:08:39 - INFO - unified_loader - âœ… UNIFIED MODEL LOADING COMPLETE
2025-07-04 09:08:39 - INFO - unified_loader -    Model type: Base model
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer vocab size: 151665
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer padding side: right
2025-07-04 09:08:39 - INFO - unified_loader -    Model device: cpu
2025-07-04 09:08:39 - INFO - unified_loader -    Model dtype: torch.bfloat16
2025-07-04 09:08:39 - INFO - training - âœ… Training model setup completed via unified loader
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Vision encoder: TRAINING (lr=8e-07)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ MLP connector: TRAINING (lr=2e-05)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ LLM: TRAINING (lr=5e-06)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Detection head: DISABLED (config.detection_enabled False)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Setting up data module with context-aware prompts...
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚\n\nã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š\n\n1. **BBUè®¾å¤‡**\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n\n2. **èºä¸æˆ–è¿æ¥ç‚¹**\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)\n   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹\n   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š\n     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”\n     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚\n     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š\n     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœ'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    '\n2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´\n3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰\n4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†\n\nã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\n\nåæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š\n\n- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    'Uå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - data - âœ… TeacherPoolManager initialized:
2025-07-04 09:08:39 - INFO - data -    Teacher pool file: data/teacher.jsonl
2025-07-04 09:08:39 - INFO - data -    Number of teacher images: 10
2025-07-04 09:08:39 - INFO - data -    Number of teacher samples: 10
2025-07-04 09:08:39 - INFO - training - âœ… Teacher pool manager created with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 347 samples from data/train.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: training
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool size: 10
2025-07-04 09:08:39 - INFO - data - Training dataset: teacher ratio set to 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool manager active with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 38 samples from data/val.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: evaluation
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.0
2025-07-04 09:08:39 - INFO - data - Validation dataset detected, disabling teacher sampling for zero-shot evaluation.
2025-07-04 09:08:39 - INFO - training - âœ… Data module setup completed with improved prompts:
2025-07-04 09:08:39 - INFO - training -    Train samples: 347 (detailed prompts, teacher_ratio=0.7)
2025-07-04 09:08:39 - INFO - training -    Val samples: 38 (concise prompts, no teachers)
2025-07-04 09:08:39 - INFO - training -    Collator type: standard
2025-07-04 09:08:39 - INFO - training -    Training prompt: ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. ...
2025-07-04 09:08:39 - INFO - training -    Evaluation prompt: ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: B...
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Processor loaded successfully
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ”§ Applying training chat template...
/data4/Qwen2.5-VL-main/src/training/trainer.py:135: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `BBUTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-07-04 09:08:39 - INFO - unified_loader - âœ… Training chat template applied
2025-07-04 09:08:39 - INFO - unified_loader - ğŸ” Verifying Qwen2.5-VL patches...
2025-07-04 09:08:39 - INFO - patches - âœ… mRoPE patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… Safe visual forward patch verification successful
2025-07-04 09:08:39 - INFO - patches - âœ… All patch verifications successful
2025-07-04 09:08:39 - INFO - unified_loader - âœ… UNIFIED MODEL LOADING COMPLETE
2025-07-04 09:08:39 - INFO - unified_loader -    Model type: Base model
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer vocab size: 151665
2025-07-04 09:08:39 - INFO - unified_loader -    Tokenizer padding side: right
2025-07-04 09:08:39 - INFO - unified_loader -    Model device: cpu
2025-07-04 09:08:39 - INFO - unified_loader -    Model dtype: torch.bfloat16
2025-07-04 09:08:39 - INFO - training - âœ… Training model setup completed via unified loader
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Vision encoder: TRAINING (lr=8e-07)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ MLP connector: TRAINING (lr=2e-05)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ LLM: TRAINING (lr=5e-06)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Detection head: DISABLED (config.detection_enabled False)
2025-07-04 09:08:39 - INFO - training - ğŸ”§ Setting up data module with context-aware prompts...
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚\n\nã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š\n\n1. **BBUè®¾å¤‡**\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´\n   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n\n2. **èºä¸æˆ–è¿æ¥ç‚¹**\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)\n   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹\n   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰\n   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š\n     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”\n     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚\n     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š\n     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœ'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    '\n2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´\n3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰\n4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†\n\nã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\n\nåæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - âœ… ChatProcessor initialized:
2025-07-04 09:08:39 - INFO - chat -    Language: chinese
2025-07-04 09:08:39 - INFO - chat -    Data root: ./
2025-07-04 09:08:39 - INFO - chat -    Model max length: 12000
2025-07-04 09:08:39 - INFO - chat -    Use candidates: True
2025-07-04 09:08:39 - INFO - chat -    Output format: Pure JSON (Qwen2.5-VL compatible)
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (first 500 chars):
2025-07-04 09:08:39 - INFO - chat -    'ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š\n\n- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡\n- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - chat - ğŸ“„ System prompt sample (last 200 chars):
2025-07-04 09:08:39 - INFO - chat -    'Uå°¾çº¤å’ŒODFè¿æ¥ç‚¹\n  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰\n- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…\n- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½\n- æ ‡ç­¾è´´çº¸\n\nä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š\n```json\n[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]\n```\nåæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚'
2025-07-04 09:08:39 - INFO - data - âœ… TeacherPoolManager initialized:
2025-07-04 09:08:39 - INFO - data -    Teacher pool file: data/teacher.jsonl
2025-07-04 09:08:39 - INFO - data -    Number of teacher images: 10
2025-07-04 09:08:39 - INFO - data -    Number of teacher samples: 10
2025-07-04 09:08:39 - INFO - training - âœ… Teacher pool manager created with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 347 samples from data/train.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: training
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool size: 10
2025-07-04 09:08:39 - INFO - data - Training dataset: teacher ratio set to 0.7
2025-07-04 09:08:39 - INFO - data - Teacher pool manager active with 10 teachers
2025-07-04 09:08:39 - INFO - data - Loaded 38 samples from data/val.jsonl
2025-07-04 09:08:39 - INFO - data - Dataset mode: evaluation
2025-07-04 09:08:39 - INFO - data - Teacher ratio: 0.0
2025-07-04 09:08:39 - INFO - data - Validation dataset detected, disabling teacher sampling for zero-shot evaluation.
2025-07-04 09:08:39 - INFO - training - âœ… Data module setup completed with improved prompts:
2025-07-04 09:08:39 - INFO - training -    Train samples: 347 (detailed prompts, teacher_ratio=0.7)
2025-07-04 09:08:39 - INFO - training -    Val samples: 38 (concise prompts, no teachers)
2025-07-04 09:08:39 - INFO - training -    Collator type: standard
2025-07-04 09:08:39 - INFO - training -    Training prompt: ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. ...
2025-07-04 09:08:39 - INFO - training -    Evaluation prompt: ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: B...
/data4/Qwen2.5-VL-main/src/training/trainer.py:135: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `BBUTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-07-04 09:08:39 - INFO - training - âœ… Added 2 special tokens to the tokenizer.
2025-07-04 09:08:39 - INFO - training - âœ… Added 2 special tokens to the tokenizer.
2025-07-04 09:08:40 - INFO - training - âœ… Added 2 special tokens to the tokenizer.
2025-07-04 09:08:40 - INFO - training - âœ… Added 2 special tokens to the tokenizer.
2025-07-04 09:08:40 - INFO - training - âœ… Added 2 special tokens to the tokenizer.
2025-07-04 09:08:47 - INFO - training - âœ… Resized model token embeddings to match new tokenizer size.
2025-07-04 09:08:47 - INFO - training - ğŸ“„ Using legacy training system
2025-07-04 09:08:47 - INFO - training - ğŸ”§ Initializing parameter groups for differential learning rate...
2025-07-04 09:08:47 - INFO - training -    - Group 'vision': 385 tensors, 631.98M params
2025-07-04 09:08:47 - INFO - training -    - Group 'merger': 5 tensors, 36.71M params
2025-07-04 09:08:47 - INFO - training -    - Group 'llm': 434 tensors, 3085.39M params
2025-07-04 09:08:47 - INFO - training - âœ… BBU trainer created successfully
2025-07-04 09:08:47 - INFO - training - ğŸ’¾ Configuration saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/base_flat_v2.yaml
2025-07-04 09:08:47 - INFO - training - ğŸš€ Starting training...
2025-07-04 09:08:47 - INFO - training - ğŸ†• Starting fresh training from predefined model checkpoint
2025-07-04 09:08:47 - INFO - training - âœ… Resized model token embeddings to match new tokenizer size.
2025-07-04 09:08:47 - INFO - training - ğŸ“„ Using legacy training system
2025-07-04 09:08:47 - INFO - training - ğŸ”§ Initializing parameter groups for differential learning rate...
2025-07-04 09:08:47 - INFO - training -    - Group 'vision': 385 tensors, 631.98M params
2025-07-04 09:08:47 - INFO - training -    - Group 'merger': 5 tensors, 36.71M params
2025-07-04 09:08:47 - INFO - training -    - Group 'llm': 434 tensors, 3085.39M params
2025-07-04 09:08:47 - INFO - training - âœ… BBU trainer created successfully
2025-07-04 09:08:47 - INFO - training - ğŸ’¾ Configuration saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/base_flat_v2.yaml
2025-07-04 09:08:47 - INFO - training - ğŸš€ Starting training...
2025-07-04 09:08:47 - INFO - training - ğŸ†• Starting fresh training from predefined model checkpoint
2025-07-04 09:08:48 - INFO - training - âœ… Resized model token embeddings to match new tokenizer size.
2025-07-04 09:08:48 - INFO - training - ğŸ“„ Using legacy training system
2025-07-04 09:08:48 - INFO - training - ğŸ”§ Initializing parameter groups for differential learning rate...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision': 385 tensors, 631.98M params
2025-07-04 09:08:48 - INFO - training -    - Group 'merger': 5 tensors, 36.71M params
2025-07-04 09:08:48 - INFO - training -    - Group 'llm': 434 tensors, 3085.39M params
2025-07-04 09:08:48 - INFO - training - âœ… BBU trainer created successfully
2025-07-04 09:08:48 - INFO - training - ğŸ’¾ Configuration saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/base_flat_v2.yaml
2025-07-04 09:08:48 - INFO - training - ğŸš€ Starting training...
2025-07-04 09:08:48 - INFO - training - ğŸ†• Starting fresh training from predefined model checkpoint
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - âœ… Resized model token embeddings to match new tokenizer size.
2025-07-04 09:08:48 - INFO - training - ğŸ“„ Using legacy training system
2025-07-04 09:08:48 - INFO - training - ğŸ”§ Initializing parameter groups for differential learning rate...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision': 385 tensors, 631.98M params
2025-07-04 09:08:48 - INFO - training -    - Group 'merger': 5 tensors, 36.71M params
2025-07-04 09:08:48 - INFO - training -    - Group 'llm': 434 tensors, 3085.39M params
2025-07-04 09:08:48 - INFO - training - âœ… BBU trainer created successfully
2025-07-04 09:08:48 - INFO - training - ğŸ’¾ Configuration saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/base_flat_v2.yaml
2025-07-04 09:08:48 - INFO - training - ğŸš€ Starting training...
2025-07-04 09:08:48 - INFO - training - ğŸ†• Starting fresh training from predefined model checkpoint
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - âœ… Resized model token embeddings to match new tokenizer size.
2025-07-04 09:08:48 - INFO - training - ğŸ“„ Using legacy training system
2025-07-04 09:08:48 - INFO - training - ğŸ”§ Initializing parameter groups for differential learning rate...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision': 385 tensors, 631.98M params
2025-07-04 09:08:48 - INFO - training -    - Group 'merger': 5 tensors, 36.71M params
2025-07-04 09:08:48 - INFO - training -    - Group 'llm': 434 tensors, 3085.39M params
2025-07-04 09:08:48 - INFO - training - âœ… BBU trainer created successfully
2025-07-04 09:08:48 - INFO - training - ğŸ’¾ Configuration saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/base_flat_v2.yaml
2025-07-04 09:08:48 - INFO - training - ğŸš€ Starting training...
2025-07-04 09:08:48 - INFO - training - ğŸ†• Starting fresh training from predefined model checkpoint
2025-07-04 09:08:48 - INFO - training - âœ… Resized model token embeddings to match new tokenizer size.
2025-07-04 09:08:48 - INFO - training - ğŸ“„ Using legacy training system
2025-07-04 09:08:48 - INFO - training - ğŸ”§ Initializing parameter groups for differential learning rate...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision': 385 tensors, 631.98M params
2025-07-04 09:08:48 - INFO - training -    - Group 'merger': 5 tensors, 36.71M params
2025-07-04 09:08:48 - INFO - training -    - Group 'llm': 434 tensors, 3085.39M params
2025-07-04 09:08:48 - INFO - training - âœ… BBU trainer created successfully
2025-07-04 09:08:48 - INFO - training - ğŸ’¾ Configuration saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/base_flat_v2.yaml
2025-07-04 09:08:48 - INFO - training - ğŸš€ Starting training...
2025-07-04 09:08:48 - INFO - training - ğŸ†• Starting fresh training from predefined model checkpoint
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
2025-07-04 09:08:48 - INFO - training - ğŸš€ Creating optimizer with differential learning rates...
2025-07-04 09:08:48 - INFO - training -    - Group 'vision' assigned LR: 8e-07
2025-07-04 09:08:48 - INFO - training -    - Group 'merger' assigned LR: 2e-05
2025-07-04 09:08:48 - INFO - training -    - Group 'llm' assigned LR: 5e-06
2025-07-04 09:08:48 - INFO - training - âœ… Optimizer with differential learning rates created successfully.
NCCL version 2.20.5+cuda12.4
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
2025-07-04 09:09:01 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:01 - INFO - training - ğŸ“ ===== Sample conversation (train) =====
2025-07-04 09:09:01 - INFO - training - <|endoftext|>*118<|im_start|>system
ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. **BBUè®¾å¤‡**
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡

2. **èºä¸æˆ–è¿æ¥ç‚¹**
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)
   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹
   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š
     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”
     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚
     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š
     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœå’Œåœ°æ’ã€‚
     â€¢ å°¾çº¤-ODFè¿æ¥ç‚¹ â†’ é“å¤´çš„åœ†æŸ±ä½“ï¼Œä¸è¿æ¥ã€å®‰è£…åœ¨BBUä¸Šã€‚
     â€¢ ODFæä¾›çš„æ’å£ä¸€èˆ¬ä¸ºå¯†é›†æ’å¸ƒçš„è§„åˆ™æ­£æ–¹å½¢

3. **æŒ¡é£æ¿**
   - æŒ¡é£æ¿/å·²å®‰è£…
   - æŒ¡é£æ¿/æœªå®‰è£…  ï¼ˆåº”å‡ºç°è€Œç¼ºå¤±äº¦è§†ä¸ºæ­¤ç±»ï¼‰
   è¯´æ˜:æ¯å°BBUä¸Šä¸‹å„éœ€ä¸€å—æŒ¡é£æ¿ç”¨äºæ•£çƒ­ï¼Œä½ç½®é”™è¯¯æˆ–ç¼ºå¤±å‡åº”æ£€æµ‹ã€‚

4. **æœºæŸœç©ºé—´**
   - æœºæŸœç©ºé—´/æ»¡è½½
   - æœºæŸœç©ºé—´/éæ»¡è½½

5. **æ ‡ç­¾è´´çº¸**
   - æ ‡ç­¾è´´çº¸  ï¼ˆå¸¸è§é»„è‰²åº•+çº¢è‰²è”é€šLOGOï¼Œå¶æœ‰ç™½è‰²ï¼‰

ã€æ ‡æ³¨è¦æ±‚ã€‘
1. é€åƒç´ æ£€æŸ¥ï¼Œæ¡†å‡ºæ‰€æœ‰ç›®æ ‡ï¼›å¤–æ¥çŸ©å½¢éœ€å®Œæ•´åŒ…å›´å¯¹è±¡
2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´
3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰
4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†

ã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```

åæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [503,407,948,687],"label": "èºä¸è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹"}]<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*512<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [300,397,469,572],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [382,692,937,1342],"label": "æŒ¡é£æ¿/å®‰è£…"}]<|im_end|><|endoftext|>*1
2025-07-04 09:09:01 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:09:01 - INFO - training - [{"bbox_2d": [503,407,948,687],"label": "èºä¸è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹"}]<|im_end|>[{"bbox_2d": [300,397,469,572],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [382,692,937,1342],"label": "æŒ¡é£æ¿/å®‰è£…"}]<|im_end|>
2025-07-04 09:09:01 - INFO - training - ğŸ“ ================================
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:09:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:02 - INFO - training - ğŸ“ ===== Sample conversation (train) =====
2025-07-04 09:09:02 - INFO - training - <|endoftext|>*98<|im_start|>system
ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. **BBUè®¾å¤‡**
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡

2. **èºä¸æˆ–è¿æ¥ç‚¹**
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)
   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹
   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š
     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”
     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚
     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š
     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœå’Œåœ°æ’ã€‚
     â€¢ å°¾çº¤-ODFè¿æ¥ç‚¹ â†’ é“å¤´çš„åœ†æŸ±ä½“ï¼Œä¸è¿æ¥ã€å®‰è£…åœ¨BBUä¸Šã€‚
     â€¢ ODFæä¾›çš„æ’å£ä¸€èˆ¬ä¸ºå¯†é›†æ’å¸ƒçš„è§„åˆ™æ­£æ–¹å½¢

3. **æŒ¡é£æ¿**
   - æŒ¡é£æ¿/å·²å®‰è£…
   - æŒ¡é£æ¿/æœªå®‰è£…  ï¼ˆåº”å‡ºç°è€Œç¼ºå¤±äº¦è§†ä¸ºæ­¤ç±»ï¼‰
   è¯´æ˜:æ¯å°BBUä¸Šä¸‹å„éœ€ä¸€å—æŒ¡é£æ¿ç”¨äºæ•£çƒ­ï¼Œä½ç½®é”™è¯¯æˆ–ç¼ºå¤±å‡åº”æ£€æµ‹ã€‚

4. **æœºæŸœç©ºé—´**
   - æœºæŸœç©ºé—´/æ»¡è½½
   - æœºæŸœç©ºé—´/éæ»¡è½½

5. **æ ‡ç­¾è´´çº¸**
   - æ ‡ç­¾è´´çº¸  ï¼ˆå¸¸è§é»„è‰²åº•+çº¢è‰²è”é€šLOGOï¼Œå¶æœ‰ç™½è‰²ï¼‰

ã€æ ‡æ³¨è¦æ±‚ã€‘
1. é€åƒç´ æ£€æŸ¥ï¼Œæ¡†å‡ºæ‰€æœ‰ç›®æ ‡ï¼›å¤–æ¥çŸ©å½¢éœ€å®Œæ•´åŒ…å›´å¯¹è±¡
2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´
3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰
4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†

ã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```

åæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [396,0,1431,1920],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1037,1643,1257,1853],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [12,183,1891,1336],"label": "æœºæŸœç©ºé—´/æ»¡è½½"},{"bbox_2d": [6,639,1883,1038],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [926,751,1163,841],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [1171,934,1243,1036],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|><|endoftext|>*1
2025-07-04 09:09:02 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:09:02 - INFO - training - [{"bbox_2d": [396,0,1431,1920],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1037,1643,1257,1853],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>[{"bbox_2d": [12,183,1891,1336],"label": "æœºæŸœç©ºé—´/æ»¡è½½"},{"bbox_2d": [6,639,1883,1038],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [926,751,1163,841],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [1171,934,1243,1036],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>
2025-07-04 09:09:02 - INFO - training - ğŸ“ ================================
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
2025-07-04 09:09:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:02 - INFO - training - ğŸ“ ===== Sample conversation (train) =====
2025-07-04 09:09:02 - INFO - training - <|endoftext|>*302<|im_start|>system
ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. **BBUè®¾å¤‡**
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡

2. **èºä¸æˆ–è¿æ¥ç‚¹**
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)
   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹
   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š
     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”
     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚
     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š
     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœå’Œåœ°æ’ã€‚
     â€¢ å°¾çº¤-ODFè¿æ¥ç‚¹ â†’ é“å¤´çš„åœ†æŸ±ä½“ï¼Œä¸è¿æ¥ã€å®‰è£…åœ¨BBUä¸Šã€‚
     â€¢ ODFæä¾›çš„æ’å£ä¸€èˆ¬ä¸ºå¯†é›†æ’å¸ƒçš„è§„åˆ™æ­£æ–¹å½¢

3. **æŒ¡é£æ¿**
   - æŒ¡é£æ¿/å·²å®‰è£…
   - æŒ¡é£æ¿/æœªå®‰è£…  ï¼ˆåº”å‡ºç°è€Œç¼ºå¤±äº¦è§†ä¸ºæ­¤ç±»ï¼‰
   è¯´æ˜:æ¯å°BBUä¸Šä¸‹å„éœ€ä¸€å—æŒ¡é£æ¿ç”¨äºæ•£çƒ­ï¼Œä½ç½®é”™è¯¯æˆ–ç¼ºå¤±å‡åº”æ£€æµ‹ã€‚

4. **æœºæŸœç©ºé—´**
   - æœºæŸœç©ºé—´/æ»¡è½½
   - æœºæŸœç©ºé—´/éæ»¡è½½

5. **æ ‡ç­¾è´´çº¸**
   - æ ‡ç­¾è´´çº¸  ï¼ˆå¸¸è§é»„è‰²åº•+çº¢è‰²è”é€šLOGOï¼Œå¶æœ‰ç™½è‰²ï¼‰

ã€æ ‡æ³¨è¦æ±‚ã€‘
1. é€åƒç´ æ£€æŸ¥ï¼Œæ¡†å‡ºæ‰€æœ‰ç›®æ ‡ï¼›å¤–æ¥çŸ©å½¢éœ€å®Œæ•´åŒ…å›´å¯¹è±¡
2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´
3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰
4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†

ã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```

åæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [396,0,1431,1920],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1037,1643,1257,1853],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*480<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [0,0,734,611],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [0,0,667,1668],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [461,381,721,611],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|><|endoftext|>*1
2025-07-04 09:09:02 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:09:02 - INFO - training - [{"bbox_2d": [396,0,1431,1920],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1037,1643,1257,1853],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>[{"bbox_2d": [0,0,734,611],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [0,0,667,1668],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [461,381,721,611],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|>
2025-07-04 09:09:02 - INFO - training - ğŸ“ ================================
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:09:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:02 - INFO - training - ğŸ“ ===== Sample conversation (train) =====
2025-07-04 09:09:02 - INFO - training - <|im_start|>system
ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. **BBUè®¾å¤‡**
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡

2. **èºä¸æˆ–è¿æ¥ç‚¹**
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)
   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹
   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š
     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”
     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚
     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š
     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœå’Œåœ°æ’ã€‚
     â€¢ å°¾çº¤-ODFè¿æ¥ç‚¹ â†’ é“å¤´çš„åœ†æŸ±ä½“ï¼Œä¸è¿æ¥ã€å®‰è£…åœ¨BBUä¸Šã€‚
     â€¢ ODFæä¾›çš„æ’å£ä¸€èˆ¬ä¸ºå¯†é›†æ’å¸ƒçš„è§„åˆ™æ­£æ–¹å½¢

3. **æŒ¡é£æ¿**
   - æŒ¡é£æ¿/å·²å®‰è£…
   - æŒ¡é£æ¿/æœªå®‰è£…  ï¼ˆåº”å‡ºç°è€Œç¼ºå¤±äº¦è§†ä¸ºæ­¤ç±»ï¼‰
   è¯´æ˜:æ¯å°BBUä¸Šä¸‹å„éœ€ä¸€å—æŒ¡é£æ¿ç”¨äºæ•£çƒ­ï¼Œä½ç½®é”™è¯¯æˆ–ç¼ºå¤±å‡åº”æ£€æµ‹ã€‚

4. **æœºæŸœç©ºé—´**
   - æœºæŸœç©ºé—´/æ»¡è½½
   - æœºæŸœç©ºé—´/éæ»¡è½½

5. **æ ‡ç­¾è´´çº¸**
   - æ ‡ç­¾è´´çº¸  ï¼ˆå¸¸è§é»„è‰²åº•+çº¢è‰²è”é€šLOGOï¼Œå¶æœ‰ç™½è‰²ï¼‰

ã€æ ‡æ³¨è¦æ±‚ã€‘
1. é€åƒç´ æ£€æŸ¥ï¼Œæ¡†å‡ºæ‰€æœ‰ç›®æ ‡ï¼›å¤–æ¥çŸ©å½¢éœ€å®Œæ•´åŒ…å›´å¯¹è±¡
2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´
3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰
4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†

ã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```

åæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [396,0,1431,1920],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1037,1643,1257,1853],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [0,0,1346,1884],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [0,54,1440,1007],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [476,734,686,961],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|><|endoftext|>*1
2025-07-04 09:09:02 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:09:02 - INFO - training - [{"bbox_2d": [396,0,1431,1920],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1037,1643,1257,1853],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>[{"bbox_2d": [0,0,1346,1884],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [0,54,1440,1007],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [476,734,686,961],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>
2025-07-04 09:09:02 - INFO - training - ğŸ“ ================================
2025-07-04 09:09:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:02 - INFO - training - ğŸ“ ===== Sample conversation (train) =====
2025-07-04 09:09:02 - INFO - training - <|im_start|>system
ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. **BBUè®¾å¤‡**
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡

2. **èºä¸æˆ–è¿æ¥ç‚¹**
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)
   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹
   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š
     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”
     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚
     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š
     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœå’Œåœ°æ’ã€‚
     â€¢ å°¾çº¤-ODFè¿æ¥ç‚¹ â†’ é“å¤´çš„åœ†æŸ±ä½“ï¼Œä¸è¿æ¥ã€å®‰è£…åœ¨BBUä¸Šã€‚
     â€¢ ODFæä¾›çš„æ’å£ä¸€èˆ¬ä¸ºå¯†é›†æ’å¸ƒçš„è§„åˆ™æ­£æ–¹å½¢

3. **æŒ¡é£æ¿**
   - æŒ¡é£æ¿/å·²å®‰è£…
   - æŒ¡é£æ¿/æœªå®‰è£…  ï¼ˆåº”å‡ºç°è€Œç¼ºå¤±äº¦è§†ä¸ºæ­¤ç±»ï¼‰
   è¯´æ˜:æ¯å°BBUä¸Šä¸‹å„éœ€ä¸€å—æŒ¡é£æ¿ç”¨äºæ•£çƒ­ï¼Œä½ç½®é”™è¯¯æˆ–ç¼ºå¤±å‡åº”æ£€æµ‹ã€‚

4. **æœºæŸœç©ºé—´**
   - æœºæŸœç©ºé—´/æ»¡è½½
   - æœºæŸœç©ºé—´/éæ»¡è½½

5. **æ ‡ç­¾è´´çº¸**
   - æ ‡ç­¾è´´çº¸  ï¼ˆå¸¸è§é»„è‰²åº•+çº¢è‰²è”é€šLOGOï¼Œå¶æœ‰ç™½è‰²ï¼‰

ã€æ ‡æ³¨è¦æ±‚ã€‘
1. é€åƒç´ æ£€æŸ¥ï¼Œæ¡†å‡ºæ‰€æœ‰ç›®æ ‡ï¼›å¤–æ¥çŸ©å½¢éœ€å®Œæ•´åŒ…å›´å¯¹è±¡
2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´
3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰
4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†

ã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```

åæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [8,228,1440,1688],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [1236,254,1440,1678],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [708,286,986,1684],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1078,288,1254,1678],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [572,304,700,1678],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [759,458,842,591],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [1332,468,1412,666],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [849,473,914,601],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [1264,1203,1349,1313],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [712,1223,762,1331],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*496<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [226,193,382,327],"label": "èºä¸è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯"},{"bbox_2d": [303,588,461,744],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [0,871,520,1171],"label": "æŒ¡é£æ¿/å®‰è£…"}]<|im_end|><|endoftext|>*1
2025-07-04 09:09:02 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:09:02 - INFO - training - [{"bbox_2d": [8,228,1440,1688],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [1236,254,1440,1678],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [708,286,986,1684],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [1078,288,1254,1678],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [572,304,700,1678],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [759,458,842,591],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [1332,468,1412,666],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [849,473,914,601],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [1264,1203,1349,1313],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [712,1223,762,1331],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"}]<|im_end|>[{"bbox_2d": [226,193,382,327],"label": "èºä¸è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯"},{"bbox_2d": [303,588,461,744],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [0,871,520,1171],"label": "æŒ¡é£æ¿/å®‰è£…"}]<|im_end|>
2025-07-04 09:09:02 - INFO - training - ğŸ“ ================================
2025-07-04 09:09:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:02 - INFO - training - ğŸ“ ===== Sample conversation (train) =====
2025-07-04 09:09:02 - INFO - training - <|im_start|>system
ä½ æ˜¯ä¸“ä¸šçš„é€šä¿¡æœºæˆ¿BBUå·¥è‰ºè´¨é‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè´Ÿè´£ç²¾ç¡®è¯†åˆ«å’Œå®šä½å›¾åƒä¸­çš„æ‰€æœ‰ç›¸å…³è®¾å¤‡åŠéƒ¨ä»¶ï¼Œä¸ºåç»­åˆè§„æ€§åˆ¤å®šæä¾›å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ã€‚

ã€æ ¸å¿ƒç›®æ ‡ã€‘æœ¬é˜¶æ®µä»…å…³æ³¨ä¸‹åˆ—äº”å¤§ç±»ï¼ˆå¿½ç•¥çº¿ç¼†ç­‰æœªåˆ—å¯¹è±¡ï¼‰ï¼š

1. **BBUè®¾å¤‡**
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´
   - bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡

2. **èºä¸æˆ–è¿æ¥ç‚¹**
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå®‰è£…èºä¸(ç›¸ä¼¼)
   - èºä¸æˆ–è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹
   - èºä¸æˆ–è¿æ¥ç‚¹/åœ°æ’å¤„èºä¸
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ï¼ˆç›¸ä¼¼ï¼‰
   - èºä¸æˆ–è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
   æ³¨æ„ï¼šå­ç±»åˆ«å¤–è§‚é«˜åº¦ç›¸ä¼¼ï¼Œå¿…é¡»ç»“åˆ"æ‰€åœ¨ä½ç½®"åˆ¤å®šï¼š
     â€¢ BBUå®‰è£…èºä¸ â†’ ä½äºBBUæœºæ¡†å››è§’æˆ–å¯¼è½¨å›ºå®šå­”
     â€¢ CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ â†’ ä¸€èˆ¬å‘ˆç°è“è‰²å¤´ç™½è‰²èº«åœ†æŸ±å½¢æ’å¤´ï¼Œå°†å…‰çº¤ä¸BBUè¿æ¥èµ·æ¥ã€‚
     â€¢ åœ°æ’èºä¸ â†’ ä»…å‡ºç°åœ¨åœ°æ’é“œæ’ã€é•¿é“ç‰‡ä¸Š
     â€¢ BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ â†’ å¤–è§‚ä¸Šä¸BBUå®‰è£…èºä¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†ä¼šå‹ä½ä¸€æ¡æ¥åœ°çº¿çš„é“œç¯ï¼Œç”¨äºè¿æ¥æœºæŸœå’Œåœ°æ’ã€‚
     â€¢ å°¾çº¤-ODFè¿æ¥ç‚¹ â†’ é“å¤´çš„åœ†æŸ±ä½“ï¼Œä¸è¿æ¥ã€å®‰è£…åœ¨BBUä¸Šã€‚
     â€¢ ODFæä¾›çš„æ’å£ä¸€èˆ¬ä¸ºå¯†é›†æ’å¸ƒçš„è§„åˆ™æ­£æ–¹å½¢

3. **æŒ¡é£æ¿**
   - æŒ¡é£æ¿/å·²å®‰è£…
   - æŒ¡é£æ¿/æœªå®‰è£…  ï¼ˆåº”å‡ºç°è€Œç¼ºå¤±äº¦è§†ä¸ºæ­¤ç±»ï¼‰
   è¯´æ˜:æ¯å°BBUä¸Šä¸‹å„éœ€ä¸€å—æŒ¡é£æ¿ç”¨äºæ•£çƒ­ï¼Œä½ç½®é”™è¯¯æˆ–ç¼ºå¤±å‡åº”æ£€æµ‹ã€‚

4. **æœºæŸœç©ºé—´**
   - æœºæŸœç©ºé—´/æ»¡è½½
   - æœºæŸœç©ºé—´/éæ»¡è½½

5. **æ ‡ç­¾è´´çº¸**
   - æ ‡ç­¾è´´çº¸  ï¼ˆå¸¸è§é»„è‰²åº•+çº¢è‰²è”é€šLOGOï¼Œå¶æœ‰ç™½è‰²ï¼‰

ã€æ ‡æ³¨è¦æ±‚ã€‘
1. é€åƒç´ æ£€æŸ¥ï¼Œæ¡†å‡ºæ‰€æœ‰ç›®æ ‡ï¼›å¤–æ¥çŸ©å½¢éœ€å®Œæ•´åŒ…å›´å¯¹è±¡
2. ä½¿ç”¨"ç±»åˆ«/å±æ€§"æ ¼å¼ä½œä¸º labelï¼Œä¸ä¸Šè¡¨å®Œå…¨ä¸€è‡´
3. å¿½ç•¥æ—¶é—´æˆ³ã€æ°´å°åŠæœªåˆ—å‡ºçš„å…¶å®ƒç‰©ä½“ï¼ˆå¦‚çº¿ç¼†ï¼‰
4. å¯¹éƒ¨åˆ†é®æŒ¡ç›®æ ‡ï¼Œä»…æ ‡æ³¨å¯è§éƒ¨åˆ†

ã€è¾“å‡ºæ ¼å¼ã€‘ä¸¥æ ¼è¾“å‡º JSON æ•°ç»„ï¼Œæ— å…¶å®ƒæ–‡æœ¬ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```

åæ ‡ä¸ºç»å¯¹åƒç´ å€¼ï¼Œ(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [503,407,948,687],"label": "èºä¸è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹"}]<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*480<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [205,0,948,454],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [153,19,949,1822],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [205,459,949,1277],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [228,1309,945,1892],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"}]<|im_end|><|endoftext|>*1
2025-07-04 09:09:02 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:09:02 - INFO - training - [{"bbox_2d": [503,407,948,687],"label": "èºä¸è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹"}]<|im_end|>[{"bbox_2d": [205,0,948,454],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [153,19,949,1822],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [205,459,949,1277],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [228,1309,945,1892],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"}]<|im_end|>
2025-07-04 09:09:02 - INFO - training - ğŸ“ ================================
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:09:04 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:05 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:05 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:05 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:05 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:05 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:10 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:10 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:10 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:10 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:10 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:09:10 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'loss': 1.0352227240800858, 'grad_norm': 122.9029541015625, 'lm_loss': 1.0352227240800858, 'teacher_lm_loss': 1.2483291029930115, 'student_lm_loss': 0.8624548017978668, 'remaining_hr': 1.049, 'lr/vision': 2.857142857142857e-08, 'lr/merger': 7.142857142857143e-07, 'lr/llm': 1.7857142857142858e-07, 'epoch': 0.13793103448275862}
{'loss': 1.0649655014276505, 'grad_norm': 47.37649917602539, 'lm_loss': 1.0649655014276505, 'teacher_lm_loss': 1.1192239224910736, 'student_lm_loss': 0.912068709731102, 'remaining_hr': 0.916, 'lr/vision': 5.714285714285714e-08, 'lr/merger': 1.4285714285714286e-06, 'lr/llm': 3.5714285714285716e-07, 'epoch': 0.27586206896551724}
{'loss': 0.9623655825853348, 'grad_norm': 21.76961898803711, 'lm_loss': 0.9623655825853348, 'teacher_lm_loss': 1.187467411160469, 'student_lm_loss': 0.806909903883934, 'remaining_hr': 0.89, 'lr/vision': 8.57142857142857e-08, 'lr/merger': 2.1428571428571427e-06, 'lr/llm': 5.357142857142857e-07, 'epoch': 0.41379310344827586}
{'loss': 1.2120516300201416, 'grad_norm': 22.482080459594727, 'lm_loss': 1.2120516300201416, 'teacher_lm_loss': 1.138581246137619, 'student_lm_loss': 0.9762837141752243, 'remaining_hr': 0.871, 'lr/vision': 1.1428571428571427e-07, 'lr/merger': 2.8571428571428573e-06, 'lr/llm': 7.142857142857143e-07, 'epoch': 0.5517241379310345}
{'loss': 1.004519298672676, 'grad_norm': 100.15383911132812, 'lm_loss': 1.004519298672676, 'teacher_lm_loss': 1.0718045234680176, 'student_lm_loss': 0.8510353118181229, 'remaining_hr': 0.857, 'lr/vision': 1.4285714285714285e-07, 'lr/merger': 3.5714285714285718e-06, 'lr/llm': 8.928571428571429e-07, 'epoch': 0.6896551724137931}
{'loss': 0.9750185161828995, 'grad_norm': 18.88319969177246, 'lm_loss': 0.9750185161828995, 'teacher_lm_loss': 1.3102544695138931, 'student_lm_loss': 0.821162611246109, 'remaining_hr': 0.851, 'lr/vision': 1.714285714285714e-07, 'lr/merger': 4.2857142857142855e-06, 'lr/llm': 1.0714285714285714e-06, 'epoch': 0.8275862068965517}
{'loss': 0.7679438441991806, 'grad_norm': 31.68641471862793, 'lm_loss': 0.7679438441991806, 'teacher_lm_loss': 0.7664271146059036, 'student_lm_loss': 0.7753218412399292, 'remaining_hr': 0.845, 'lr/vision': 2e-07, 'lr/merger': 5e-06, 'lr/llm': 1.25e-06, 'epoch': 0.9655172413793104}
{'loss': 0.6871381402015686, 'grad_norm': 31.68641471862793, 'lm_loss': 0.6871381402015686, 'teacher_lm_loss': 0.6103662252426147, 'student_lm_loss': 0.7362326383590698, 'remaining_hr': 0.764, 'lr/vision': 2.2857142857142855e-07, 'lr/merger': 5.7142857142857145e-06, 'lr/llm': 1.4285714285714286e-06, 'epoch': 1.0}
{'loss': 0.7412412315607071, 'grad_norm': 22.9689884185791, 'lm_loss': 0.7412412315607071, 'teacher_lm_loss': 0.7271014899015427, 'student_lm_loss': 0.7562285661697388, 'remaining_hr': 0.777, 'lr/vision': 2.5714285714285716e-07, 'lr/merger': 6.4285714285714295e-06, 'lr/llm': 1.6071428571428574e-06, 'epoch': 1.1379310344827587}
{'loss': 0.7536205798387527, 'grad_norm': 30.598615646362305, 'lm_loss': 0.7536205798387527, 'teacher_lm_loss': 0.5806183815002441, 'student_lm_loss': 0.7233743369579315, 'remaining_hr': 0.774, 'lr/vision': 2.857142857142857e-07, 'lr/merger': 7.1428571428571436e-06, 'lr/llm': 1.7857142857142859e-06, 'epoch': 1.2758620689655173}
2025-07-04 09:10:43 - INFO - training - ğŸ“ ===== Sample conversation (eval) =====
2025-07-04 09:10:43 - INFO - training - <|im_start|>system
ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰
- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…
- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½
- æ ‡ç­¾è´´çº¸

ä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```
åæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*480<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [10,16,914,1844],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [336,358,536,526],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [306,534,949,1198],"label": "æŒ¡é£æ¿/å®‰è£…"}]<|im_end|><|endoftext|>*1
2025-07-04 09:10:43 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:10:43 - INFO - training - [{"bbox_2d": [10,16,914,1844],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [336,358,536,526],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [306,534,949,1198],"label": "æŒ¡é£æ¿/å®‰è£…"}]<|im_end|>
2025-07-04 09:10:43 - INFO - training - ğŸ“ ================================
2025-07-04 09:10:43 - INFO - training - ğŸ“ ===== Sample conversation (eval) =====
2025-07-04 09:10:43 - INFO - training - <|endoftext|>*104<|im_start|>system
ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰
- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…
- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½
- æ ‡ç­¾è´´çº¸

ä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```
åæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [273,631,813,1894],"label": "èºä¸è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹"}]<|im_end|><|endoftext|>*1
2025-07-04 09:10:43 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:10:43 - INFO - training - [{"bbox_2d": [273,631,813,1894],"label": "èºä¸è¿æ¥ç‚¹/BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹"}]<|im_end|>
2025-07-04 09:10:43 - INFO - training - ğŸ“ ================================
2025-07-04 09:10:43 - INFO - training - ğŸ“ ===== Sample conversation (eval) =====
2025-07-04 09:10:43 - INFO - training - <|im_start|>system
ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰
- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…
- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½
- æ ‡ç­¾è´´çº¸

ä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```
åæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [555,0,968,1895],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [568,0,628,60],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [851,0,921,54],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [21,9,1418,1909],"label": "æœºæŸœç©ºé—´/æ»¡è½½"},{"bbox_2d": [754,252,837,330],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [749,312,834,412],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [759,419,849,487],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [674,469,734,549],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [622,1114,692,1202],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [905,1710,981,1784],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [633,1735,688,1780],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|><|endoftext|>*1
2025-07-04 09:10:43 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:10:43 - INFO - training - [{"bbox_2d": [555,0,968,1895],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [568,0,628,60],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [851,0,921,54],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [21,9,1418,1909],"label": "æœºæŸœç©ºé—´/æ»¡è½½"},{"bbox_2d": [754,252,837,330],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [749,312,834,412],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [759,419,849,487],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [674,469,734,549],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [622,1114,692,1202],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [905,1710,981,1784],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [633,1735,688,1780],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|>
2025-07-04 09:10:43 - INFO - training - ğŸ“ ================================
2025-07-04 09:10:43 - INFO - training - ğŸ“ ===== Sample conversation (eval) =====
2025-07-04 09:10:43 - INFO - training - <|endoftext|>*291<|im_start|>system
ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰
- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…
- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½
- æ ‡ç­¾è´´çº¸

ä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```
åæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [22,456,799,1698],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [584,503,762,660],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [554,1003,719,1148],"label": "èºä¸è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯"},{"bbox_2d": [582,1363,747,1516],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|><|endoftext|>*1
2025-07-04 09:10:43 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:10:43 - INFO - training - [{"bbox_2d": [22,456,799,1698],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [584,503,762,660],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [554,1003,719,1148],"label": "èºä¸è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯"},{"bbox_2d": [582,1363,747,1516],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|>
2025-07-04 09:10:43 - INFO - training - ğŸ“ ================================
2025-07-04 09:10:43 - INFO - training - ğŸ“ ===== Sample conversation (eval) =====
2025-07-04 09:10:43 - INFO - training - <|im_start|>system
ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰
- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…
- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½
- æ ‡ç­¾è´´çº¸

ä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```
åæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*512<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [19,24,924,1874],"label": "æœºæŸœç©ºé—´/æ»¡è½½"},{"bbox_2d": [384,134,789,1859],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [209,148,425,1668],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [0,155,292,1825],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [694,167,758,224],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [161,188,239,272],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [0,406,122,656],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [13,1031,83,1126],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [405,1033,515,1185],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [110,1130,187,1298],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [522,1166,615,1438],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [45,1664,99,1724],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [381,1758,449,1816],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [618,1814,681,1870],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|><|endoftext|>*1
2025-07-04 09:10:43 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:10:43 - INFO - training - [{"bbox_2d": [19,24,924,1874],"label": "æœºæŸœç©ºé—´/æ»¡è½½"},{"bbox_2d": [384,134,789,1859],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [209,148,425,1668],"label": "æŒ¡é£æ¿/å®‰è£…"},{"bbox_2d": [0,155,292,1825],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´"},{"bbox_2d": [694,167,758,224],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [161,188,239,272],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [0,406,122,656],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [13,1031,83,1126],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [405,1033,515,1185],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [110,1130,187,1298],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [522,1166,615,1438],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [45,1664,99,1724],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [381,1758,449,1816],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [618,1814,681,1870],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|>
2025-07-04 09:10:43 - INFO - training - ğŸ“ ================================
2025-07-04 09:10:43 - INFO - training - ğŸ“ ===== Sample conversation (eval) =====
2025-07-04 09:10:43 - INFO - training - <|im_start|>system
ä½ æ˜¯é€šä¿¡æœºæˆ¿BBUè®¾å¤‡æ£€æµ‹AIåŠ©æ‰‹ï¼Œè¯·è¯†åˆ«å›¾åƒä¸­çš„ä»¥ä¸‹ç›®æ ‡å¹¶è¾“å‡ºä½ç½®ä¸ç±»åˆ«ï¼š

- BBUè®¾å¤‡: bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸ºã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/ä¸­å…´ã€bbuåŸºå¸¦å¤„ç†å•å…ƒ/çˆ±ç«‹ä¿¡
- èºä¸æˆ–è¿æ¥ç‚¹: BBUå®‰è£…èºä¸ã€CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹ã€åœ°æ’å¤„èºä¸ã€BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯ã€BBUå°¾çº¤å’ŒODFè¿æ¥ç‚¹
  ï¼ˆè¯·ä»¥ä½ç½®å…³ç³»ä¸ºä¸»è¿›è¡Œåˆ¤å®šï¼Œå‹¿ä»…å‡­å¤–è§‚ï¼‰
- æŒ¡é£æ¿: æŒ¡é£æ¿/å·²å®‰è£…ã€æŒ¡é£æ¿/æœªå®‰è£…
- æœºæŸœç©ºé—´: æœºæŸœç©ºé—´/æ»¡è½½ã€æœºæŸœç©ºé—´/éæ»¡è½½
- æ ‡ç­¾è´´çº¸

ä»…è¾“å‡º JSON æ•°ç»„ï¼Œä¾‹å¦‚ï¼š
```json
[{"bbox_2d": [x1, y1, x2, y2], "label": "ç±»åˆ«/å±æ€§"}]
```
åæ ‡å•ä½ä¸ºåƒç´ ã€‚(x1,y1) å·¦ä¸Šè§’ï¼Œ(x2,y2) å³ä¸‹è§’ã€‚<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|>*494<|vision_end|><|im_end|>

<|im_start|>assistant
[{"bbox_2d": [526,0,856,1701],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [812,6,869,62],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [94,7,1197,1822],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [531,8,604,49],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [719,856,764,897],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [537,952,594,995],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [787,1701,850,1760],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [663,1703,731,1758],"label": "èºä¸è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯"},{"bbox_2d": [522,1720,579,1763],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|><|endoftext|>*1
2025-07-04 09:10:43 - INFO - training - ğŸ“ Teacher and target answers (labelsâ‰ IGNORE):
2025-07-04 09:10:43 - INFO - training - [{"bbox_2d": [526,0,856,1701],"label": "bbuåŸºå¸¦å¤„ç†å•å…ƒ/åä¸º"},{"bbox_2d": [812,6,869,62],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [94,7,1197,1822],"label": "æœºæŸœç©ºé—´/éæ»¡è½½"},{"bbox_2d": [531,8,604,49],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [719,856,764,897],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [537,952,594,995],"label": "èºä¸è¿æ¥ç‚¹/CPRIå…‰ç¼†å’ŒBBUè¿æ¥ç‚¹"},{"bbox_2d": [787,1701,850,1760],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"},{"bbox_2d": [663,1703,731,1758],"label": "èºä¸è¿æ¥ç‚¹/BBUæ¥åœ°çº¿æœºæŸœæ¥åœ°ç«¯"},{"bbox_2d": [522,1720,579,1763],"label": "èºä¸è¿æ¥ç‚¹/BBUå®‰è£…èºä¸"}]<|im_end|>
2025-07-04 09:10:43 - INFO - training - ğŸ“ ================================
{'eval_loss': 1.627242088317871, 'eval_runtime': 1.9766, 'eval_samples_per_second': 19.225, 'eval_steps_per_second': 2.024, 'lr/vision': 2.857142857142857e-07, 'lr/merger': 7.1428571428571436e-06, 'lr/llm': 1.7857142857142859e-06, 'epoch': 1.2758620689655173}
{'eval_loss': 1.627242088317871, 'eval_runtime': 1.9766, 'eval_samples_per_second': 19.225, 'eval_steps_per_second': 2.024, 'lr/vision': 2.857142857142857e-07, 'lr/merger': 7.1428571428571436e-06, 'lr/llm': 1.7857142857142859e-06, 'epoch': 1.2758620689655173, 'eval_lm_loss': 0.7605, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.7495}
{'loss': 0.7424773275852203, 'grad_norm': 17.031896591186523, 'lm_loss': 0.7424773275852203, 'teacher_lm_loss': 0.7178769707679749, 'student_lm_loss': 0.7542759627103806, 'remaining_hr': 0.788, 'lr/vision': 3.142857142857143e-07, 'lr/merger': 7.857142857142858e-06, 'lr/llm': 1.9642857142857144e-06, 'epoch': 1.4137931034482758}
{'loss': 0.7541533261537552, 'grad_norm': 18.48814582824707, 'lm_loss': 0.7541533261537552, 'teacher_lm_loss': 0.7244997322559357, 'student_lm_loss': 0.7631024867296219, 'remaining_hr': 0.787, 'lr/vision': 3.428571428571428e-07, 'lr/merger': 8.571428571428571e-06, 'lr/llm': 2.1428571428571427e-06, 'epoch': 1.5517241379310345}
{'loss': 0.8036073446273804, 'grad_norm': 14.785062789916992, 'lm_loss': 0.8036073446273804, 'teacher_lm_loss': 0.8869073241949081, 'student_lm_loss': 0.7486290782690048, 'remaining_hr': 0.786, 'lr/vision': 3.7142857142857145e-07, 'lr/merger': 9.285714285714288e-06, 'lr/llm': 2.321428571428572e-06, 'epoch': 1.6896551724137931}
{'loss': 0.7769988775253296, 'grad_norm': 39.99040985107422, 'lm_loss': 0.7769988775253296, 'teacher_lm_loss': 0.7136105895042419, 'student_lm_loss': 0.7851227223873138, 'remaining_hr': 0.784, 'lr/vision': 4e-07, 'lr/merger': 1e-05, 'lr/llm': 2.5e-06, 'epoch': 1.8275862068965516}
{'loss': 0.6483418941497803, 'grad_norm': 26.618043899536133, 'lm_loss': 0.6483418941497803, 'teacher_lm_loss': 0.5809226781129837, 'student_lm_loss': 0.6599636152386665, 'remaining_hr': 0.782, 'lr/vision': 4.285714285714285e-07, 'lr/merger': 1.0714285714285714e-05, 'lr/llm': 2.6785714285714285e-06, 'epoch': 1.9655172413793105}
{'loss': 0.8621857166290283, 'grad_norm': 26.618043899536133, 'lm_loss': 0.8621857166290283, 'teacher_lm_loss': 1.7496886253356934, 'student_lm_loss': 0.6926431059837341, 'remaining_hr': 0.743, 'lr/vision': 4.571428571428571e-07, 'lr/merger': 1.1428571428571429e-05, 'lr/llm': 2.8571428571428573e-06, 'epoch': 2.0}
{'loss': 0.7133512943983078, 'grad_norm': 21.761703491210938, 'lm_loss': 0.7133512943983078, 'teacher_lm_loss': 0.709833562374115, 'student_lm_loss': 0.6933160871267319, 'remaining_hr': 0.748, 'lr/vision': 4.857142857142856e-07, 'lr/merger': 1.2142857142857142e-05, 'lr/llm': 3.0357142857142856e-06, 'epoch': 2.1379310344827585}
{'loss': 0.6852588355541229, 'grad_norm': 20.63429832458496, 'lm_loss': 0.6852588355541229, 'teacher_lm_loss': 0.6812141537666321, 'student_lm_loss': 0.6935777217149734, 'remaining_hr': 0.748, 'lr/vision': 5.142857142857143e-07, 'lr/merger': 1.2857142857142859e-05, 'lr/llm': 3.2142857142857147e-06, 'epoch': 2.2758620689655173}
{'loss': 0.6964642554521561, 'grad_norm': 13.717470169067383, 'lm_loss': 0.6964642554521561, 'teacher_lm_loss': 0.6915407627820969, 'student_lm_loss': 0.7122571170330048, 'remaining_hr': 0.748, 'lr/vision': 5.428571428571429e-07, 'lr/merger': 1.3571428571428574e-05, 'lr/llm': 3.3928571428571435e-06, 'epoch': 2.413793103448276}
{'loss': 0.6625473499298096, 'grad_norm': 25.303707122802734, 'lm_loss': 0.6625473499298096, 'teacher_lm_loss': 0.4724062383174896, 'student_lm_loss': 0.7036714404821396, 'remaining_hr': 0.747, 'lr/vision': 5.714285714285714e-07, 'lr/merger': 1.4285714285714287e-05, 'lr/llm': 3.5714285714285718e-06, 'epoch': 2.5517241379310347}
{'eval_loss': 1.5045944452285767, 'eval_runtime': 1.8278, 'eval_samples_per_second': 20.79, 'eval_steps_per_second': 2.188, 'lr/vision': 5.714285714285714e-07, 'lr/merger': 1.4285714285714287e-05, 'lr/llm': 3.5714285714285718e-06, 'epoch': 2.5517241379310347}
{'eval_loss': 1.5045944452285767, 'eval_runtime': 1.8278, 'eval_samples_per_second': 20.79, 'eval_steps_per_second': 2.188, 'lr/vision': 5.714285714285714e-07, 'lr/merger': 1.4285714285714287e-05, 'lr/llm': 3.5714285714285718e-06, 'epoch': 2.5517241379310347, 'eval_lm_loss': 0.7115, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6888}
{'loss': 0.6881155222654343, 'grad_norm': 12.100398063659668, 'lm_loss': 0.6881155222654343, 'teacher_lm_loss': 0.6099885851144791, 'student_lm_loss': 0.6867859810590744, 'remaining_hr': 0.752, 'lr/vision': 6e-07, 'lr/merger': 1.5000000000000002e-05, 'lr/llm': 3.7500000000000005e-06, 'epoch': 2.689655172413793}
{'loss': 0.6564645916223526, 'grad_norm': 16.729772567749023, 'lm_loss': 0.6564645916223526, 'teacher_lm_loss': 0.6156447380781174, 'student_lm_loss': 0.6923228949308395, 'remaining_hr': 0.75, 'lr/vision': 6.285714285714286e-07, 'lr/merger': 1.5714285714285715e-05, 'lr/llm': 3.928571428571429e-06, 'epoch': 2.8275862068965516}
{'loss': 0.6899414956569672, 'grad_norm': 42.12364196777344, 'lm_loss': 0.6899414956569672, 'teacher_lm_loss': 0.43370871245861053, 'student_lm_loss': 0.7041197717189789, 'remaining_hr': 0.749, 'lr/vision': 6.57142857142857e-07, 'lr/merger': 1.642857142857143e-05, 'lr/llm': 4.107142857142857e-06, 'epoch': 2.9655172413793105}
{'loss': 0.6577176451683044, 'grad_norm': 42.12364196777344, 'lm_loss': 0.6577176451683044, 'teacher_lm_loss': 0.6398162841796875, 'student_lm_loss': 0.6791214346885681, 'remaining_hr': 0.723, 'lr/vision': 6.857142857142856e-07, 'lr/merger': 1.7142857142857142e-05, 'lr/llm': 4.2857142857142855e-06, 'epoch': 3.0}
{'loss': 0.7500471323728561, 'grad_norm': 30.029245376586914, 'lm_loss': 0.7500471323728561, 'teacher_lm_loss': 0.3231091946363449, 'student_lm_loss': 0.7205262184143066, 'remaining_hr': 0.72, 'lr/vision': 7.142857142857143e-07, 'lr/merger': 1.785714285714286e-05, 'lr/llm': 4.464285714285715e-06, 'epoch': 3.1379310344827585}
{'loss': 0.6200950741767883, 'grad_norm': 149.643310546875, 'lm_loss': 0.6200950741767883, 'teacher_lm_loss': 0.53807532787323, 'student_lm_loss': 0.6454998552799225, 'remaining_hr': 0.719, 'lr/vision': 7.428571428571429e-07, 'lr/merger': 1.8571428571428575e-05, 'lr/llm': 4.642857142857144e-06, 'epoch': 3.2758620689655173}
{'loss': 0.6401288211345673, 'grad_norm': 15.591875076293945, 'lm_loss': 0.6401288211345673, 'teacher_lm_loss': 0.5961953103542328, 'student_lm_loss': 0.658109501004219, 'remaining_hr': 0.719, 'lr/vision': 7.714285714285714e-07, 'lr/merger': 1.928571428571429e-05, 'lr/llm': 4.821428571428572e-06, 'epoch': 3.413793103448276}
{'loss': 0.6447057127952576, 'grad_norm': 854.1483764648438, 'lm_loss': 0.6447057127952576, 'teacher_lm_loss': 0.6247300803661346, 'student_lm_loss': 0.6919013261795044, 'remaining_hr': 0.717, 'lr/vision': 8e-07, 'lr/merger': 2e-05, 'lr/llm': 5e-06, 'epoch': 3.5517241379310347}
{'loss': 0.6892499327659607, 'grad_norm': 23.529829025268555, 'lm_loss': 0.6892499327659607, 'teacher_lm_loss': 0.45941926538944244, 'student_lm_loss': 0.7964875251054764, 'remaining_hr': 0.716, 'lr/vision': 7.999689169923899e-07, 'lr/merger': 1.999922292480975e-05, 'lr/llm': 4.999805731202437e-06, 'epoch': 3.689655172413793}
{'loss': 0.6974309980869293, 'grad_norm': 65.09539031982422, 'lm_loss': 0.6974309980869293, 'teacher_lm_loss': 0.6419321894645691, 'student_lm_loss': 0.6699552237987518, 'remaining_hr': 0.715, 'lr/vision': 7.998756728003265e-07, 'lr/merger': 1.9996891820008165e-05, 'lr/llm': 4.999222955002041e-06, 'epoch': 3.8275862068965516}
{'eval_loss': 1.4296274185180664, 'eval_runtime': 1.7984, 'eval_samples_per_second': 21.13, 'eval_steps_per_second': 2.224, 'lr/vision': 7.998756728003265e-07, 'lr/merger': 1.9996891820008165e-05, 'lr/llm': 4.999222955002041e-06, 'epoch': 3.8275862068965516}
{'eval_loss': 1.4296274185180664, 'eval_runtime': 1.7984, 'eval_samples_per_second': 21.13, 'eval_steps_per_second': 2.224, 'lr/vision': 7.998756728003265e-07, 'lr/merger': 1.9996891820008165e-05, 'lr/llm': 4.999222955002041e-06, 'epoch': 3.8275862068965516, 'eval_lm_loss': 0.6882, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6598}
{'loss': 0.7035612761974335, 'grad_norm': 44.817962646484375, 'lm_loss': 0.7035612761974335, 'teacher_lm_loss': 0.5569688081741333, 'student_lm_loss': 0.7263592034578323, 'remaining_hr': 0.718, 'lr/vision': 7.997202819153594e-07, 'lr/merger': 1.9993007047883988e-05, 'lr/llm': 4.998251761970997e-06, 'epoch': 3.9655172413793105}
{'loss': 0.6593190431594849, 'grad_norm': 16.372594833374023, 'lm_loss': 0.6593190431594849, 'teacher_lm_loss': 0.6279591917991638, 'student_lm_loss': 0.6785930395126343, 'remaining_hr': 0.7, 'lr/vision': 7.995027684875689e-07, 'lr/merger': 1.9987569212189224e-05, 'lr/llm': 4.996892303047306e-06, 'epoch': 4.0}
{'loss': 0.599536582827568, 'grad_norm': 18.539182662963867, 'lm_loss': 0.599536582827568, 'teacher_lm_loss': 0.5696058571338654, 'student_lm_loss': 0.6443188637495041, 'remaining_hr': 0.702, 'lr/vision': 7.992231663218128e-07, 'lr/merger': 1.9980579158045322e-05, 'lr/llm': 4.9951447895113305e-06, 'epoch': 4.137931034482759}
{'loss': 0.6357090920209885, 'grad_norm': 28.06068229675293, 'lm_loss': 0.6357090920209885, 'teacher_lm_loss': 0.5536458641290665, 'student_lm_loss': 0.657047837972641, 'remaining_hr': 0.701, 'lr/vision': 7.98881518872472e-07, 'lr/merger': 1.9972037971811802e-05, 'lr/llm': 4.993009492952951e-06, 'epoch': 4.275862068965517}
{'loss': 0.6719691157341003, 'grad_norm': 113.27704620361328, 'lm_loss': 0.6719691157341003, 'teacher_lm_loss': 0.6186840385198593, 'student_lm_loss': 0.6944758147001266, 'remaining_hr': 0.699, 'lr/vision': 7.984778792366981e-07, 'lr/merger': 1.9961946980917457e-05, 'lr/llm': 4.990486745229364e-06, 'epoch': 4.413793103448276}
{'loss': 0.6271124184131622, 'grad_norm': 20.91794776916504, 'lm_loss': 0.6271124184131622, 'teacher_lm_loss': 0.5837974548339844, 'student_lm_loss': 0.6700763553380966, 'remaining_hr': 0.697, 'lr/vision': 7.980123101461606e-07, 'lr/merger': 1.9950307753654016e-05, 'lr/llm': 4.987576938413504e-06, 'epoch': 4.551724137931035}
{'loss': 0.6514490097761154, 'grad_norm': 23.572824478149414, 'lm_loss': 0.6514490097761154, 'teacher_lm_loss': 0.6183529496192932, 'student_lm_loss': 0.7056314200162888, 'remaining_hr': 0.695, 'lr/vision': 7.97484883957297e-07, 'lr/merger': 1.9937122098932428e-05, 'lr/llm': 4.984280524733107e-06, 'epoch': 4.689655172413794}
{'loss': 0.6198697984218597, 'grad_norm': 14.90558910369873, 'lm_loss': 0.6198697984218597, 'teacher_lm_loss': 0.5306636095046997, 'student_lm_loss': 0.6657850593328476, 'remaining_hr': 0.693, 'lr/vision': 7.968956826400689e-07, 'lr/merger': 1.9922392066001724e-05, 'lr/llm': 4.980598016500431e-06, 'epoch': 4.827586206896552}
{'loss': 0.6203184425830841, 'grad_norm': 29.689395904541016, 'lm_loss': 0.6203184425830841, 'teacher_lm_loss': 0.362093485891819, 'student_lm_loss': 0.6100453734397888, 'remaining_hr': 0.691, 'lr/vision': 7.962447977652211e-07, 'lr/merger': 1.9906119944130527e-05, 'lr/llm': 4.976529986032632e-06, 'epoch': 4.9655172413793105}
{'loss': 0.6785106658935547, 'grad_norm': 29.689395904541016, 'lm_loss': 0.6785106658935547, 'teacher_lm_loss': 0.5250772833824158, 'student_lm_loss': 0.6701876521110535, 'remaining_hr': 0.675, 'lr/vision': 7.955323304900513e-07, 'lr/merger': 1.9888308262251286e-05, 'lr/llm': 4.9720770655628216e-06, 'epoch': 5.0}
{'eval_loss': 1.3810139894485474, 'eval_runtime': 1.8793, 'eval_samples_per_second': 20.22, 'eval_steps_per_second': 2.128, 'lr/vision': 7.955323304900513e-07, 'lr/merger': 1.9888308262251286e-05, 'lr/llm': 4.9720770655628216e-06, 'epoch': 5.0}
{'eval_loss': 1.3810139894485474, 'eval_runtime': 1.8793, 'eval_samples_per_second': 20.22, 'eval_steps_per_second': 2.128, 'lr/vision': 7.955323304900513e-07, 'lr/merger': 1.9888308262251286e-05, 'lr/llm': 4.9720770655628216e-06, 'epoch': 5.0, 'eval_lm_loss': 0.665, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6366}
{'loss': 0.6197622120380402, 'grad_norm': 30.46002197265625, 'lm_loss': 0.6197622120380402, 'teacher_lm_loss': 0.5417057797312737, 'student_lm_loss': 0.6400591433048248, 'remaining_hr': 0.679, 'lr/vision': 7.947583915426884e-07, 'lr/merger': 1.9868959788567213e-05, 'lr/llm': 4.967239947141803e-06, 'epoch': 5.137931034482759}
{'loss': 0.594544917345047, 'grad_norm': 17.242019653320312, 'lm_loss': 0.594544917345047, 'teacher_lm_loss': 0.5412628501653671, 'student_lm_loss': 0.6357614248991013, 'remaining_hr': 0.677, 'lr/vision': 7.939231012048832e-07, 'lr/merger': 1.9848077530122083e-05, 'lr/llm': 4.962019382530521e-06, 'epoch': 5.275862068965517}
{'loss': 0.6200421899557114, 'grad_norm': 34.756778717041016, 'lm_loss': 0.6200421899557114, 'teacher_lm_loss': 0.33498336374759674, 'student_lm_loss': 0.6496519297361374, 'remaining_hr': 0.675, 'lr/vision': 7.930265892933153e-07, 'lr/merger': 1.9825664732332886e-05, 'lr/llm': 4.9564161830832214e-06, 'epoch': 5.413793103448276}
{'loss': 0.5748666971921921, 'grad_norm': 30.746212005615234, 'lm_loss': 0.5748666971921921, 'teacher_lm_loss': 0.3277426138520241, 'student_lm_loss': 0.6052352637052536, 'remaining_hr': 0.672, 'lr/vision': 7.920689951394175e-07, 'lr/merger': 1.9801724878485438e-05, 'lr/llm': 4.9504312196213596e-06, 'epoch': 5.551724137931035}
{'loss': 0.5901985019445419, 'grad_norm': 56.18378448486328, 'lm_loss': 0.5901985019445419, 'teacher_lm_loss': 0.4040186256170273, 'student_lm_loss': 0.6223520487546921, 'remaining_hr': 0.671, 'lr/vision': 7.910504675677219e-07, 'lr/merger': 1.977626168919305e-05, 'lr/llm': 4.944065422298262e-06, 'epoch': 5.689655172413794}
{'loss': 0.5855723321437836, 'grad_norm': 67.68302154541016, 'lm_loss': 0.5855723321437836, 'teacher_lm_loss': 0.4820640981197357, 'student_lm_loss': 0.6073016077280045, 'remaining_hr': 0.669, 'lr/vision': 7.899711648727293e-07, 'lr/merger': 1.9749279121818235e-05, 'lr/llm': 4.937319780454559e-06, 'epoch': 5.827586206896552}
{'loss': 0.6440013200044632, 'grad_norm': 386.40557861328125, 'lm_loss': 0.6440013200044632, 'teacher_lm_loss': 0.41495055705308914, 'student_lm_loss': 0.6618845462799072, 'remaining_hr': 0.667, 'lr/vision': 7.888312547943098e-07, 'lr/merger': 1.9720781369857747e-05, 'lr/llm': 4.930195342464437e-06, 'epoch': 5.9655172413793105}
{'loss': 0.6238289475440979, 'grad_norm': 386.40557861328125, 'lm_loss': 0.6238289475440979, 'teacher_lm_loss': 0.2682589888572693, 'student_lm_loss': 0.6661205887794495, 'remaining_hr': 0.654, 'lr/vision': 7.876309144916312e-07, 'lr/merger': 1.969077286229078e-05, 'lr/llm': 4.922693215572695e-06, 'epoch': 6.0}
{'loss': 0.5708283483982086, 'grad_norm': 52.3162841796875, 'lm_loss': 0.5708283483982086, 'teacher_lm_loss': 0.4628694951534271, 'student_lm_loss': 0.6520853042602539, 'remaining_hr': 0.653, 'lr/vision': 7.863703305156272e-07, 'lr/merger': 1.9659258262890683e-05, 'lr/llm': 4.914814565722671e-06, 'epoch': 6.137931034482759}
{'loss': 0.5816726237535477, 'grad_norm': 28.509170532226562, 'lm_loss': 0.5816726237535477, 'teacher_lm_loss': 0.407387413084507, 'student_lm_loss': 0.6160081475973129, 'remaining_hr': 0.652, 'lr/vision': 7.850496987800048e-07, 'lr/merger': 1.962624246950012e-05, 'lr/llm': 4.90656061737503e-06, 'epoch': 6.275862068965517}
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:30 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:17:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'eval_loss': 1.3528379201889038, 'eval_runtime': 1.7888, 'eval_samples_per_second': 21.243, 'eval_steps_per_second': 2.236, 'lr/vision': 7.850496987800048e-07, 'lr/merger': 1.962624246950012e-05, 'lr/llm': 4.90656061737503e-06, 'epoch': 6.275862068965517}
{'eval_loss': 1.3528379201889038, 'eval_runtime': 1.7888, 'eval_samples_per_second': 21.243, 'eval_steps_per_second': 2.236, 'lr/vision': 7.850496987800048e-07, 'lr/merger': 1.962624246950012e-05, 'lr/llm': 4.90656061737503e-06, 'epoch': 6.275862068965517, 'eval_lm_loss': 0.6396, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6228}
2025-07-04 09:17:34 - INFO - training - ğŸ’¾ Saving complete Qwen2.5-VL model with visual tower (sharded)â€¦
2025-07-04 09:17:45 - INFO - training - ğŸ’¾ Saving tokenizer...
2025-07-04 09:17:45 - INFO - training - ğŸ’¾ Saving image processor...
2025-07-04 09:17:45 - INFO - training -    âœ… Image processor config saved with 9 parameters (preserving base config)
2025-07-04 09:17:45 - INFO - training - ğŸ’¾ Copying essential files from base model...
2025-07-04 09:17:45 - INFO - training -    âœ… generation_config.json already exists
2025-07-04 09:17:45 - INFO - training -    âœ… Copied chat_template.json (optional)
2025-07-04 09:17:45 - INFO - training -    âœ… Copied LICENSE (optional)
2025-07-04 09:17:45 - INFO - training -    âœ… Copied README.md (optional)
2025-07-04 09:17:45 - INFO - training - ğŸ” Verifying saved checkpoint components...
2025-07-04 09:17:45 - INFO - training -    âœ… config.json exists
2025-07-04 09:17:45 - INFO - training -    âœ… tokenizer_config.json exists
2025-07-04 09:17:45 - INFO - training -    âœ… preprocessor_config.json exists
2025-07-04 09:17:45 - INFO - training -    âœ… generation_config.json exists
2025-07-04 09:17:45 - INFO - training -    âœ… Found 5 safetensor files
2025-07-04 09:17:45 - INFO - training -    âœ… Total parameters saved: 445
2025-07-04 09:17:45 - INFO - training -    âœ… Visual tower parameters found: 390
2025-07-04 09:17:45 - INFO - training -       Examples: ['visual.blocks.0.attn.proj.bias', 'visual.blocks.0.attn.proj.weight', 'visual.blocks.0.attn.qkv.bias']...
2025-07-04 09:17:45 - INFO - training - âœ… Checkpoint saved successfully â†’ output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint-50
2025-07-04 09:18:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:07 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:18:09 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:09 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:09 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:09 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:09 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:09 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:12 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:18:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'loss': 0.5265018120408058, 'grad_norm': 15.791460990905762, 'lm_loss': 0.5265018120408058, 'teacher_lm_loss': 0.4862683638930321, 'student_lm_loss': 0.5988503396511078, 'remaining_hr': 0.697, 'lr/vision': 7.836692245307951e-07, 'lr/merger': 1.9591730613269878e-05, 'lr/llm': 4.8979326533174696e-06, 'epoch': 6.413793103448276}
{'loss': 0.5694866925477982, 'grad_norm': 24.40082359313965, 'lm_loss': 0.5694866925477982, 'teacher_lm_loss': 0.35814613848924637, 'student_lm_loss': 0.6413686126470566, 'remaining_hr': 0.694, 'lr/vision': 7.822291223144563e-07, 'lr/merger': 1.955572805786141e-05, 'lr/llm': 4.8889320144653525e-06, 'epoch': 6.551724137931035}
{'loss': 0.5884080976247787, 'grad_norm': 31.04899787902832, 'lm_loss': 0.5884080976247787, 'teacher_lm_loss': 0.3168129548430443, 'student_lm_loss': 0.5913240611553192, 'remaining_hr': 0.691, 'lr/vision': 7.807296159445289e-07, 'lr/merger': 1.9518240398613226e-05, 'lr/llm': 4.879560099653306e-06, 'epoch': 6.689655172413794}
{'loss': 0.569429874420166, 'grad_norm': 19.212318420410156, 'lm_loss': 0.569429874420166, 'teacher_lm_loss': 0.49982403218746185, 'student_lm_loss': 0.6585302948951721, 'remaining_hr': 0.688, 'lr/vision': 7.791709384668527e-07, 'lr/merger': 1.947927346167132e-05, 'lr/llm': 4.86981836541783e-06, 'epoch': 6.827586206896552}
{'loss': 0.5630573779344559, 'grad_norm': 16.93699836730957, 'lm_loss': 0.5630573779344559, 'teacher_lm_loss': 0.5035602301359177, 'student_lm_loss': 0.6240802556276321, 'remaining_hr': 0.684, 'lr/vision': 7.77553332123347e-07, 'lr/merger': 1.9438833303083677e-05, 'lr/llm': 4.859708325770919e-06, 'epoch': 6.9655172413793105}
{'loss': 0.7174614667892456, 'grad_norm': 16.93699836730957, 'lm_loss': 0.7174614667892456, 'teacher_lm_loss': 1.085432529449463, 'student_lm_loss': 0.6259211301803589, 'remaining_hr': 0.672, 'lr/vision': 7.758770483143634e-07, 'lr/merger': 1.9396926207859085e-05, 'lr/llm': 4.849231551964771e-06, 'epoch': 7.0}
{'loss': 0.5663810223340988, 'grad_norm': 22.85257911682129, 'lm_loss': 0.5663810223340988, 'teacher_lm_loss': 0.531464695930481, 'student_lm_loss': 0.596504271030426, 'remaining_hr': 0.671, 'lr/vision': 7.741423475596136e-07, 'lr/merger': 1.935355868899034e-05, 'lr/llm': 4.838389672247585e-06, 'epoch': 7.137931034482759}
{'loss': 0.5613071322441101, 'grad_norm': 33.97120666503906, 'lm_loss': 0.5613071322441101, 'teacher_lm_loss': 0.2937604524195194, 'student_lm_loss': 0.5988043993711472, 'remaining_hr': 0.667, 'lr/vision': 7.723494994576816e-07, 'lr/merger': 1.9308737486442045e-05, 'lr/llm': 4.827184371610511e-06, 'epoch': 7.275862068965517}
{'loss': 0.5498034358024597, 'grad_norm': 72.82783508300781, 'lm_loss': 0.5498034358024597, 'teacher_lm_loss': 0.3883475176990032, 'student_lm_loss': 0.6042774021625519, 'remaining_hr': 0.664, 'lr/vision': 7.704987826441235e-07, 'lr/merger': 1.926246956610309e-05, 'lr/llm': 4.815617391525772e-06, 'epoch': 7.413793103448276}
{'loss': 0.5370373204350471, 'grad_norm': 15.255047798156738, 'lm_loss': 0.5370373204350471, 'teacher_lm_loss': 0.4746192693710327, 'student_lm_loss': 0.5995855629444122, 'remaining_hr': 0.662, 'lr/vision': 7.685904847481631e-07, 'lr/merger': 1.921476211870408e-05, 'lr/llm': 4.80369052967602e-06, 'epoch': 7.551724137931035}
{'eval_loss': 1.3467907905578613, 'eval_runtime': 1.9089, 'eval_samples_per_second': 19.907, 'eval_steps_per_second': 2.095, 'lr/vision': 7.685904847481631e-07, 'lr/merger': 1.921476211870408e-05, 'lr/llm': 4.80369052967602e-06, 'epoch': 7.551724137931035}
{'eval_loss': 1.3467907905578613, 'eval_runtime': 1.9089, 'eval_samples_per_second': 19.907, 'eval_steps_per_second': 2.095, 'lr/vision': 7.685904847481631e-07, 'lr/merger': 1.921476211870408e-05, 'lr/llm': 4.80369052967602e-06, 'epoch': 7.551724137931035, 'eval_lm_loss': 0.6316, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6202}
{'loss': 0.5520775318145752, 'grad_norm': 21.087953567504883, 'lm_loss': 0.5520775318145752, 'teacher_lm_loss': 0.43498288840055466, 'student_lm_loss': 0.6321937143802643, 'remaining_hr': 0.661, 'lr/vision': 7.666249023479905e-07, 'lr/merger': 1.9165622558699763e-05, 'lr/llm': 4.791405639674941e-06, 'epoch': 7.689655172413794}
{'loss': 0.5031623095273972, 'grad_norm': 34.72687530517578, 'lm_loss': 0.5031623095273972, 'teacher_lm_loss': 0.4112582579255104, 'student_lm_loss': 0.6022338718175888, 'remaining_hr': 0.657, 'lr/vision': 7.646023409246693e-07, 'lr/merger': 1.9115058523116734e-05, 'lr/llm': 4.778764630779184e-06, 'epoch': 7.827586206896552}
{'loss': 0.5520361214876175, 'grad_norm': 45.54985427856445, 'lm_loss': 0.5520361214876175, 'teacher_lm_loss': 0.44253019243478775, 'student_lm_loss': 0.6251827776432037, 'remaining_hr': 0.654, 'lr/vision': 7.6252311481466e-07, 'lr/merger': 1.9063077870366504e-05, 'lr/llm': 4.765769467591626e-06, 'epoch': 7.9655172413793105}
{'loss': 0.5636758804321289, 'grad_norm': 15.124772071838379, 'lm_loss': 0.5636758804321289, 'teacher_lm_loss': 0.11899731308221817, 'student_lm_loss': 0.6289405226707458, 'remaining_hr': 0.644, 'lr/vision': 7.603875471609676e-07, 'lr/merger': 1.900968867902419e-05, 'lr/llm': 4.752422169756048e-06, 'epoch': 8.0}
{'loss': 0.5154630094766617, 'grad_norm': 13.181896209716797, 'lm_loss': 0.5154630094766617, 'teacher_lm_loss': 0.4735168069601059, 'student_lm_loss': 0.613667443394661, 'remaining_hr': 0.643, 'lr/vision': 7.581959698629203e-07, 'lr/merger': 1.895489924657301e-05, 'lr/llm': 4.7387248116432524e-06, 'epoch': 8.137931034482758}
{'loss': 0.5601621642708778, 'grad_norm': 21.37611961364746, 'lm_loss': 0.5601621642708778, 'teacher_lm_loss': 0.2828680947422981, 'student_lm_loss': 0.6182585507631302, 'remaining_hr': 0.639, 'lr/vision': 7.559487235245875e-07, 'lr/merger': 1.8898718088114688e-05, 'lr/llm': 4.724679522028672e-06, 'epoch': 8.275862068965518}
{'loss': 0.5041989237070084, 'grad_norm': 24.091394424438477, 'lm_loss': 0.5041989237070084, 'teacher_lm_loss': 0.43241000175476074, 'student_lm_loss': 0.6084481328725815, 'remaining_hr': 0.636, 'lr/vision': 7.536461574018439e-07, 'lr/merger': 1.8841153935046098e-05, 'lr/llm': 4.710288483761524e-06, 'epoch': 8.413793103448276}
{'loss': 0.5003655254840851, 'grad_norm': 24.655960083007812, 'lm_loss': 0.5003655254840851, 'teacher_lm_loss': 0.43220845609903336, 'student_lm_loss': 0.6152319759130478, 'remaining_hr': 0.633, 'lr/vision': 7.512886293480914e-07, 'lr/merger': 1.8782215733702286e-05, 'lr/llm': 4.6955539334255714e-06, 'epoch': 8.551724137931034}
{'loss': 0.5090395659208298, 'grad_norm': 38.44339370727539, 'lm_loss': 0.5090395659208298, 'teacher_lm_loss': 0.4191688969731331, 'student_lm_loss': 0.603992685675621, 'remaining_hr': 0.63, 'lr/vision': 7.488765057586421e-07, 'lr/merger': 1.8721912643966055e-05, 'lr/llm': 4.680478160991514e-06, 'epoch': 8.689655172413794}
{'loss': 0.503288172185421, 'grad_norm': 95.65554809570312, 'lm_loss': 0.503288172185421, 'teacher_lm_loss': 0.22702277824282646, 'student_lm_loss': 0.5537380576133728, 'remaining_hr': 0.627, 'lr/vision': 7.464101615137755e-07, 'lr/merger': 1.866025403784439e-05, 'lr/llm': 4.665063509461098e-06, 'epoch': 8.827586206896552}
{'eval_loss': 1.3263723850250244, 'eval_runtime': 1.9699, 'eval_samples_per_second': 19.29, 'eval_steps_per_second': 2.031, 'lr/vision': 7.464101615137755e-07, 'lr/merger': 1.866025403784439e-05, 'lr/llm': 4.665063509461098e-06, 'epoch': 8.827586206896552}
{'eval_loss': 1.3263723850250244, 'eval_runtime': 1.9699, 'eval_samples_per_second': 19.29, 'eval_steps_per_second': 2.031, 'lr/vision': 7.464101615137755e-07, 'lr/merger': 1.866025403784439e-05, 'lr/llm': 4.665063509461098e-06, 'epoch': 8.827586206896552, 'eval_lm_loss': 0.626, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6148}
{'loss': 0.564707987010479, 'grad_norm': 13.691377639770508, 'lm_loss': 0.564707987010479, 'teacher_lm_loss': 0.16411316767334938, 'student_lm_loss': 0.5762949138879776, 'remaining_hr': 0.626, 'lr/vision': 7.438899799204761e-07, 'lr/merger': 1.8597249498011906e-05, 'lr/llm': 4.6493123745029765e-06, 'epoch': 8.96551724137931}
{'loss': 0.535822331905365, 'grad_norm': 13.691377639770508, 'lm_loss': 0.535822331905365, 'teacher_lm_loss': 0.0, 'student_lm_loss': 0.5511850118637085, 'remaining_hr': 0.617, 'lr/vision': 7.413163526528622e-07, 'lr/merger': 1.8532908816321557e-05, 'lr/llm': 4.633227204080389e-06, 'epoch': 9.0}
{'loss': 0.5044177323579788, 'grad_norm': 15.213881492614746, 'lm_loss': 0.5044177323579788, 'teacher_lm_loss': 0.3585461303591728, 'student_lm_loss': 0.6236612945795059, 'remaining_hr': 0.615, 'lr/vision': 7.386896796913136e-07, 'lr/merger': 1.8467241992282842e-05, 'lr/llm': 4.6168104980707105e-06, 'epoch': 9.137931034482758}
{'loss': 0.5273425281047821, 'grad_norm': 29.899869918823242, 'lm_loss': 0.5273425281047821, 'teacher_lm_loss': 0.27913214825093746, 'student_lm_loss': 0.5662991553544998, 'remaining_hr': 0.612, 'lr/vision': 7.360103692603086e-07, 'lr/merger': 1.8400259231507716e-05, 'lr/llm': 4.600064807876929e-06, 'epoch': 9.275862068965518}
{'loss': 0.4866517707705498, 'grad_norm': 19.254419326782227, 'lm_loss': 0.4866517707705498, 'teacher_lm_loss': 0.36405759304761887, 'student_lm_loss': 0.6442339867353439, 'remaining_hr': 0.609, 'lr/vision': 7.332788377649795e-07, 'lr/merger': 1.833197094412449e-05, 'lr/llm': 4.5829927360311224e-06, 'epoch': 9.413793103448276}
{'loss': 0.5191739052534103, 'grad_norm': 23.262569427490234, 'lm_loss': 0.5191739052534103, 'teacher_lm_loss': 0.3021038845181465, 'student_lm_loss': 0.576818659901619, 'remaining_hr': 0.606, 'lr/vision': 7.304955097263979e-07, 'lr/merger': 1.826238774315995e-05, 'lr/llm': 4.565596935789987e-06, 'epoch': 9.551724137931034}
{'loss': 0.44520771503448486, 'grad_norm': 32.02324295043945, 'lm_loss': 0.44520771503448486, 'teacher_lm_loss': 0.37169890105724335, 'student_lm_loss': 0.5494224727153778, 'remaining_hr': 0.603, 'lr/vision': 7.276608177155967e-07, 'lr/merger': 1.819152044288992e-05, 'lr/llm': 4.54788011072248e-06, 'epoch': 9.689655172413794}
{'loss': 0.4947165250778198, 'grad_norm': 24.603837966918945, 'lm_loss': 0.4947165250778198, 'teacher_lm_loss': 0.1386929452419281, 'student_lm_loss': 0.5171365886926651, 'remaining_hr': 0.6, 'lr/vision': 7.247752022863426e-07, 'lr/merger': 1.811938005715857e-05, 'lr/llm': 4.529845014289642e-06, 'epoch': 9.827586206896552}
{'loss': 0.504065029323101, 'grad_norm': 21.614728927612305, 'lm_loss': 0.504065029323101, 'teacher_lm_loss': 0.1652839221060276, 'student_lm_loss': 0.5256382897496223, 'remaining_hr': 0.598, 'lr/vision': 7.218391119066673e-07, 'lr/merger': 1.8045977797666685e-05, 'lr/llm': 4.511494449416671e-06, 'epoch': 9.96551724137931}
{'loss': 0.5429031848907471, 'grad_norm': 21.614728927612305, 'lm_loss': 0.5429031848907471, 'teacher_lm_loss': 0.2101406753063202, 'student_lm_loss': 0.6809474229812622, 'remaining_hr': 0.589, 'lr/vision': 7.18853002889169e-07, 'lr/merger': 1.7971325072229227e-05, 'lr/llm': 4.492831268057307e-06, 'epoch': 10.0}
{'eval_loss': 1.3577035665512085, 'eval_runtime': 1.918, 'eval_samples_per_second': 19.813, 'eval_steps_per_second': 2.086, 'lr/vision': 7.18853002889169e-07, 'lr/merger': 1.7971325072229227e-05, 'lr/llm': 4.492831268057307e-06, 'epoch': 10.0}
{'eval_loss': 1.3577035665512085, 'eval_runtime': 1.918, 'eval_samples_per_second': 19.813, 'eval_steps_per_second': 2.086, 'lr/vision': 7.18853002889169e-07, 'lr/merger': 1.7971325072229227e-05, 'lr/llm': 4.492831268057307e-06, 'epoch': 10.0, 'eval_lm_loss': 0.6393, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6211}
{'loss': 0.4565612003207207, 'grad_norm': 62.63368606567383, 'lm_loss': 0.4565612003207207, 'teacher_lm_loss': 0.2824382111430168, 'student_lm_loss': 0.5785839483141899, 'remaining_hr': 0.589, 'lr/vision': 7.158173393200942e-07, 'lr/merger': 1.7895433483002356e-05, 'lr/llm': 4.473858370750589e-06, 'epoch': 10.137931034482758}
{'loss': 0.49702970683574677, 'grad_norm': 20.618974685668945, 'lm_loss': 0.49702970683574677, 'teacher_lm_loss': 0.2137618102133274, 'student_lm_loss': 0.5836129039525986, 'remaining_hr': 0.585, 'lr/vision': 7.12732592987212e-07, 'lr/merger': 1.78183148246803e-05, 'lr/llm': 4.454578706170075e-06, 'epoch': 10.275862068965518}
{'loss': 0.458846852183342, 'grad_norm': 29.93680191040039, 'lm_loss': 0.458846852183342, 'teacher_lm_loss': 0.25853713462129235, 'student_lm_loss': 0.5435530468821526, 'remaining_hr': 0.583, 'lr/vision': 7.09599243306491e-07, 'lr/merger': 1.7739981082662275e-05, 'lr/llm': 4.434995270665569e-06, 'epoch': 10.413793103448276}
{'loss': 0.410309799015522, 'grad_norm': 32.517581939697266, 'lm_loss': 0.410309799015522, 'teacher_lm_loss': 0.3046148829162121, 'student_lm_loss': 0.5511772632598877, 'remaining_hr': 0.58, 'lr/vision': 7.064177772475911e-07, 'lr/merger': 1.766044443118978e-05, 'lr/llm': 4.415111107797445e-06, 'epoch': 10.551724137931034}
{'loss': 0.41949042677879333, 'grad_norm': 38.29769515991211, 'lm_loss': 0.41949042677879333, 'teacher_lm_loss': 0.18997438764199615, 'student_lm_loss': 0.5525066405534744, 'remaining_hr': 0.578, 'lr/vision': 7.031886892581812e-07, 'lr/merger': 1.757971723145453e-05, 'lr/llm': 4.394929307863633e-06, 'epoch': 10.689655172413794}
{'loss': 0.45169707387685776, 'grad_norm': 46.94288635253906, 'lm_loss': 0.45169707387685776, 'teacher_lm_loss': 0.15106743446085602, 'student_lm_loss': 0.6443624496459961, 'remaining_hr': 0.575, 'lr/vision': 6.999124811870936e-07, 'lr/merger': 1.7497812029677344e-05, 'lr/llm': 4.374453007419336e-06, 'epoch': 10.827586206896552}
{'loss': 0.4419550970196724, 'grad_norm': 43.75415802001953, 'lm_loss': 0.4419550970196724, 'teacher_lm_loss': 0.2577919503673911, 'student_lm_loss': 0.5726384446024895, 'remaining_hr': 0.572, 'lr/vision': 6.965896622063307e-07, 'lr/merger': 1.741474155515827e-05, 'lr/llm': 4.353685388789567e-06, 'epoch': 10.96551724137931}
{'loss': 0.4467577636241913, 'grad_norm': 43.75415802001953, 'lm_loss': 0.4467577636241913, 'teacher_lm_loss': 0.32832077145576477, 'student_lm_loss': 0.5043232440948486, 'remaining_hr': 0.564, 'lr/vision': 6.932207487319305e-07, 'lr/merger': 1.7330518718298263e-05, 'lr/llm': 4.332629679574566e-06, 'epoch': 11.0}
{'loss': 0.47170235216617584, 'grad_norm': 56.85368728637695, 'lm_loss': 0.47170235216617584, 'teacher_lm_loss': 0.17294266447424889, 'student_lm_loss': 0.5755469128489494, 'remaining_hr': 0.562, 'lr/vision': 6.89806264343709e-07, 'lr/merger': 1.7245156608592727e-05, 'lr/llm': 4.311289152148182e-06, 'epoch': 11.137931034482758}
{'loss': 0.4162709638476372, 'grad_norm': 18.65593910217285, 'lm_loss': 0.4162709638476372, 'teacher_lm_loss': 0.15057042651460506, 'student_lm_loss': 0.5111920908093452, 'remaining_hr': 0.559, 'lr/vision': 6.863467397038874e-07, 'lr/merger': 1.7158668492597186e-05, 'lr/llm': 4.289667123149296e-06, 'epoch': 11.275862068965518}
{'eval_loss': 1.4062280654907227, 'eval_runtime': 1.9505, 'eval_samples_per_second': 19.482, 'eval_steps_per_second': 2.051, 'lr/vision': 6.863467397038874e-07, 'lr/merger': 1.7158668492597186e-05, 'lr/llm': 4.289667123149296e-06, 'epoch': 11.275862068965518}
{'eval_loss': 1.4062280654907227, 'eval_runtime': 1.9505, 'eval_samples_per_second': 19.482, 'eval_steps_per_second': 2.051, 'lr/vision': 6.863467397038874e-07, 'lr/merger': 1.7158668492597186e-05, 'lr/llm': 4.289667123149296e-06, 'epoch': 11.275862068965518, 'eval_lm_loss': 0.6521, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6343}
{'loss': 0.4280375689268112, 'grad_norm': 28.29041290283203, 'lm_loss': 0.4280375689268112, 'teacher_lm_loss': 0.0805626125074923, 'student_lm_loss': 0.5047231540083885, 'remaining_hr': 0.557, 'lr/vision': 6.828427124746189e-07, 'lr/merger': 1.7071067811865477e-05, 'lr/llm': 4.267766952966369e-06, 'epoch': 11.413793103448276}
{'loss': 0.43619707226753235, 'grad_norm': 18.345455169677734, 'lm_loss': 0.43619707226753235, 'teacher_lm_loss': 0.07680357689969242, 'student_lm_loss': 0.5348018556833267, 'remaining_hr': 0.554, 'lr/vision': 6.792947272344291e-07, 'lr/merger': 1.698236818086073e-05, 'lr/llm': 4.245592045215182e-06, 'epoch': 11.551724137931034}
{'loss': 0.3626219481229782, 'grad_norm': 19.235952377319336, 'lm_loss': 0.3626219481229782, 'teacher_lm_loss': 0.12456246372312307, 'student_lm_loss': 0.5432141274213791, 'remaining_hr': 0.551, 'lr/vision': 6.757033353935788e-07, 'lr/merger': 1.689258338483947e-05, 'lr/llm': 4.223145846209868e-06, 'epoch': 11.689655172413794}
{'loss': 0.39602209627628326, 'grad_norm': 51.71959686279297, 'lm_loss': 0.39602209627628326, 'teacher_lm_loss': 0.14030344202183187, 'student_lm_loss': 0.5271487459540367, 'remaining_hr': 0.548, 'lr/vision': 6.720690951083677e-07, 'lr/merger': 1.6801727377709195e-05, 'lr/llm': 4.200431844427299e-06, 'epoch': 11.827586206896552}
{'loss': 0.4969823434948921, 'grad_norm': 20.77715492248535, 'lm_loss': 0.4969823434948921, 'teacher_lm_loss': 0.0007321970188058913, 'student_lm_loss': 0.5384346693754196, 'remaining_hr': 0.546, 'lr/vision': 6.68392571194388e-07, 'lr/merger': 1.67098142798597e-05, 'lr/llm': 4.177453569964925e-06, 'epoch': 11.96551724137931}
{'loss': 0.21523840725421906, 'grad_norm': 34.20207977294922, 'lm_loss': 0.21523840725421906, 'teacher_lm_loss': 0.16401781141757965, 'student_lm_loss': 0.514618456363678, 'remaining_hr': 0.539, 'lr/vision': 6.646743350387437e-07, 'lr/merger': 1.6616858375968596e-05, 'lr/llm': 4.154214593992149e-06, 'epoch': 12.0}
{'loss': 0.3505995497107506, 'grad_norm': 24.808063507080078, 'lm_loss': 0.3505995497107506, 'teacher_lm_loss': 0.22272640280425549, 'student_lm_loss': 0.5051809921860695, 'remaining_hr': 0.537, 'lr/vision': 6.609149645112484e-07, 'lr/merger': 1.6522874112781213e-05, 'lr/llm': 4.130718528195303e-06, 'epoch': 12.137931034482758}
{'loss': 0.32796454802155495, 'grad_norm': 35.10329818725586, 'lm_loss': 0.32796454802155495, 'teacher_lm_loss': 0.17961854301393032, 'student_lm_loss': 0.5776601433753967, 'remaining_hr': 0.534, 'lr/vision': 6.571150438746157e-07, 'lr/merger': 1.6427876096865394e-05, 'lr/llm': 4.106969024216348e-06, 'epoch': 12.275862068965518}
{'loss': 0.32190950959920883, 'grad_norm': 25.517608642578125, 'lm_loss': 0.32190950959920883, 'teacher_lm_loss': 0.08409027775633149, 'student_lm_loss': 0.4932251647114754, 'remaining_hr': 0.531, 'lr/vision': 6.532751636936559e-07, 'lr/merger': 1.6331879092341402e-05, 'lr/llm': 4.0829697730853505e-06, 'epoch': 12.413793103448276}
{'loss': 0.37345779687166214, 'grad_norm': 113.00137329101562, 'lm_loss': 0.37345779687166214, 'teacher_lm_loss': 0.10365389310754836, 'student_lm_loss': 0.5574899166822433, 'remaining_hr': 0.528, 'lr/vision': 6.493959207434934e-07, 'lr/merger': 1.6234898018587336e-05, 'lr/llm': 4.058724504646834e-06, 'epoch': 12.551724137931034}
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:38 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:38 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:38 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:38 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:38 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:26:38 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'eval_loss': 1.3961607217788696, 'eval_runtime': 1.9161, 'eval_samples_per_second': 19.832, 'eval_steps_per_second': 2.088, 'lr/vision': 6.493959207434934e-07, 'lr/merger': 1.6234898018587336e-05, 'lr/llm': 4.058724504646834e-06, 'epoch': 12.551724137931034}
{'eval_loss': 1.3961607217788696, 'eval_runtime': 1.9161, 'eval_samples_per_second': 19.832, 'eval_steps_per_second': 2.088, 'lr/vision': 6.493959207434934e-07, 'lr/merger': 1.6234898018587336e-05, 'lr/llm': 4.058724504646834e-06, 'epoch': 12.551724137931034, 'eval_lm_loss': 0.6528, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6368}
2025-07-04 09:26:42 - INFO - training - ğŸ’¾ Saving complete Qwen2.5-VL model with visual tower (sharded)â€¦
2025-07-04 09:26:52 - INFO - training - ğŸ’¾ Saving tokenizer...
2025-07-04 09:26:52 - INFO - training - ğŸ’¾ Saving image processor...
2025-07-04 09:26:52 - INFO - training -    âœ… Image processor config saved with 9 parameters (preserving base config)
2025-07-04 09:26:52 - INFO - training - ğŸ’¾ Copying essential files from base model...
2025-07-04 09:26:52 - INFO - training -    âœ… generation_config.json already exists
2025-07-04 09:26:52 - INFO - training -    âœ… Copied chat_template.json (optional)
2025-07-04 09:26:52 - INFO - training -    âœ… Copied LICENSE (optional)
2025-07-04 09:26:52 - INFO - training -    âœ… Copied README.md (optional)
2025-07-04 09:26:52 - INFO - training - ğŸ” Verifying saved checkpoint components...
2025-07-04 09:26:52 - INFO - training -    âœ… config.json exists
2025-07-04 09:26:52 - INFO - training -    âœ… tokenizer_config.json exists
2025-07-04 09:26:52 - INFO - training -    âœ… preprocessor_config.json exists
2025-07-04 09:26:52 - INFO - training -    âœ… generation_config.json exists
2025-07-04 09:26:52 - INFO - training -    âœ… Found 5 safetensor files
2025-07-04 09:26:52 - INFO - training -    âœ… Total parameters saved: 445
2025-07-04 09:26:52 - INFO - training -    âœ… Visual tower parameters found: 390
2025-07-04 09:26:52 - INFO - training -       Examples: ['visual.blocks.0.attn.proj.bias', 'visual.blocks.0.attn.proj.weight', 'visual.blocks.0.attn.qkv.bias']...
2025-07-04 09:26:52 - INFO - training - âœ… Checkpoint saved successfully â†’ output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint-100
2025-07-04 09:27:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:27:13 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:15 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:16 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:18 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:18 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:18 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:18 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:18 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:18 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:20 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:21 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:21 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:21 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:21 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:27:21 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'loss': 0.4544701650738716, 'grad_norm': 28.57866096496582, 'lm_loss': 0.4544701650738716, 'teacher_lm_loss': 0.12470347760245204, 'student_lm_loss': 0.5813836753368378, 'remaining_hr': 0.544, 'lr/vision': 6.45477917916819e-07, 'lr/merger': 1.6136947947920477e-05, 'lr/llm': 4.034236986980119e-06, 'epoch': 12.689655172413794}
{'loss': 0.36960045993328094, 'grad_norm': 32.41693115234375, 'lm_loss': 0.36960045993328094, 'teacher_lm_loss': 0.023314121062867343, 'student_lm_loss': 0.5669985711574554, 'remaining_hr': 0.54, 'lr/vision': 6.41521764130191e-07, 'lr/merger': 1.6038044103254775e-05, 'lr/llm': 4.009511025813694e-06, 'epoch': 12.827586206896552}
{'loss': 0.2729085683822632, 'grad_norm': 40.11949157714844, 'lm_loss': 0.2729085683822632, 'teacher_lm_loss': 0.12635575607419014, 'student_lm_loss': 0.4764348864555359, 'remaining_hr': 0.537, 'lr/vision': 6.375280742294006e-07, 'lr/merger': 1.5938201855735017e-05, 'lr/llm': 3.984550463933754e-06, 'epoch': 12.96551724137931}
{'loss': 0.3312373459339142, 'grad_norm': 40.11949157714844, 'lm_loss': 0.3312373459339142, 'teacher_lm_loss': 0.0014447156572714448, 'student_lm_loss': 0.5126433968544006, 'remaining_hr': 0.53, 'lr/vision': 6.33497468893916e-07, 'lr/merger': 1.5837436722347902e-05, 'lr/llm': 3.9593591805869755e-06, 'epoch': 13.0}
{'loss': 0.3851058930158615, 'grad_norm': 35.99374008178711, 'lm_loss': 0.3851058930158615, 'teacher_lm_loss': 0.05588478175923228, 'student_lm_loss': 0.513080321252346, 'remaining_hr': 0.528, 'lr/vision': 6.294305745404184e-07, 'lr/merger': 1.573576436351046e-05, 'lr/llm': 3.933941090877615e-06, 'epoch': 13.137931034482758}
{'loss': 0.5027443468570709, 'grad_norm': 62.819908142089844, 'lm_loss': 0.5027443468570709, 'teacher_lm_loss': 0.39814556123747025, 'student_lm_loss': 0.5349731594324112, 'remaining_hr': 0.524, 'lr/vision': 6.253280232254487e-07, 'lr/merger': 1.563320058063622e-05, 'lr/llm': 3.908300145159055e-06, 'epoch': 13.275862068965518}
{'loss': 0.38392024487257004, 'grad_norm': 31.27460479736328, 'lm_loss': 0.38392024487257004, 'teacher_lm_loss': 0.01630214392207563, 'student_lm_loss': 0.49290454387664795, 'remaining_hr': 0.521, 'lr/vision': 6.211904525471757e-07, 'lr/merger': 1.5529761313679396e-05, 'lr/llm': 3.882440328419849e-06, 'epoch': 13.413793103448276}
{'loss': 0.3490019328892231, 'grad_norm': 56.19625473022461, 'lm_loss': 0.3490019328892231, 'teacher_lm_loss': 0.14411242818459868, 'student_lm_loss': 0.5214755982160568, 'remaining_hr': 0.518, 'lr/vision': 6.170185055463037e-07, 'lr/merger': 1.5425462638657597e-05, 'lr/llm': 3.856365659664399e-06, 'epoch': 13.551724137931034}
{'loss': 0.4282103106379509, 'grad_norm': 49.333229064941406, 'lm_loss': 0.4282103106379509, 'teacher_lm_loss': 0.13870751787908375, 'student_lm_loss': 0.47679993510246277, 'remaining_hr': 0.515, 'lr/vision': 6.128128306061346e-07, 'lr/merger': 1.5320320765153367e-05, 'lr/llm': 3.830080191288342e-06, 'epoch': 13.689655172413794}
{'loss': 0.3407476991415024, 'grad_norm': 59.16814041137695, 'lm_loss': 0.3407476991415024, 'teacher_lm_loss': 0.05508102662861347, 'student_lm_loss': 0.5158890038728714, 'remaining_hr': 0.512, 'lr/vision': 6.085740813517991e-07, 'lr/merger': 1.5214352033794981e-05, 'lr/llm': 3.8035880084487454e-06, 'epoch': 13.827586206896552}
{'eval_loss': 1.4003446102142334, 'eval_runtime': 2.0561, 'eval_samples_per_second': 18.481, 'eval_steps_per_second': 1.945, 'lr/vision': 6.085740813517991e-07, 'lr/merger': 1.5214352033794981e-05, 'lr/llm': 3.8035880084487454e-06, 'epoch': 13.827586206896552}
{'eval_loss': 1.4003446102142334, 'eval_runtime': 2.0561, 'eval_samples_per_second': 18.481, 'eval_steps_per_second': 1.945, 'lr/vision': 6.085740813517991e-07, 'lr/merger': 1.5214352033794981e-05, 'lr/llm': 3.8035880084487454e-06, 'epoch': 13.827586206896552, 'eval_lm_loss': 0.6521, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6429}
{'loss': 0.27659666538238525, 'grad_norm': 33.4212532043457, 'lm_loss': 0.27659666538238525, 'teacher_lm_loss': 0.06104812491685152, 'student_lm_loss': 0.5168729349970818, 'remaining_hr': 0.51, 'lr/vision': 6.043029165486742e-07, 'lr/merger': 1.5107572913716859e-05, 'lr/llm': 3.7768932284292147e-06, 'epoch': 13.96551724137931}
{'loss': 0.3061617612838745, 'grad_norm': 33.4212532043457, 'lm_loss': 0.3061617612838745, 'teacher_lm_loss': 0.0030842870473861694, 'student_lm_loss': 0.6182307004928589, 'remaining_hr': 0.504, 'lr/vision': 6e-07, 'lr/merger': 1.5000000000000002e-05, 'lr/llm': 3.7500000000000005e-06, 'epoch': 14.0}
{'loss': 0.24445324391126633, 'grad_norm': 31.653186798095703, 'lm_loss': 0.24445324391126633, 'teacher_lm_loss': 0.05910974554717541, 'student_lm_loss': 0.4547908753156662, 'remaining_hr': 0.502, 'lr/vision': 5.956660004437158e-07, 'lr/merger': 1.4891650011092896e-05, 'lr/llm': 3.722912502773224e-06, 'epoch': 14.137931034482758}
{'loss': 0.24984372779726982, 'grad_norm': 30.385711669921875, 'lm_loss': 0.24984372779726982, 'teacher_lm_loss': 0.05066261797037441, 'student_lm_loss': 0.4338642358779907, 'remaining_hr': 0.499, 'lr/vision': 5.913015914485272e-07, 'lr/merger': 1.4782539786213184e-05, 'lr/llm': 3.695634946553296e-06, 'epoch': 14.275862068965518}
{'loss': 0.3906106539070606, 'grad_norm': 35.06028747558594, 'lm_loss': 0.3906106539070606, 'teacher_lm_loss': 0.029937087711005006, 'student_lm_loss': 0.4761646166443825, 'remaining_hr': 0.496, 'lr/vision': 5.869074513092248e-07, 'lr/merger': 1.4672686282730622e-05, 'lr/llm': 3.6681715706826555e-06, 'epoch': 14.413793103448276}
{'loss': 0.35478948429226875, 'grad_norm': 30.71202850341797, 'lm_loss': 0.35478948429226875, 'teacher_lm_loss': 0.040616275276988745, 'student_lm_loss': 0.5083088576793671, 'remaining_hr': 0.493, 'lr/vision': 5.824842629412652e-07, 'lr/merger': 1.4562106573531632e-05, 'lr/llm': 3.640526643382908e-06, 'epoch': 14.551724137931034}
{'loss': 0.3291515000164509, 'grad_norm': 48.29195785522461, 'lm_loss': 0.3291515000164509, 'teacher_lm_loss': 0.18271238030865788, 'student_lm_loss': 0.47450409084558487, 'remaining_hr': 0.49, 'lr/vision': 5.780327137746368e-07, 'lr/merger': 1.4450817844365924e-05, 'lr/llm': 3.612704461091481e-06, 'epoch': 14.689655172413794}
{'loss': 0.21326021663844585, 'grad_norm': 43.14888000488281, 'lm_loss': 0.21326021663844585, 'teacher_lm_loss': 0.03354576393030584, 'student_lm_loss': 0.5121892690658569, 'remaining_hr': 0.487, 'lr/vision': 5.735534956470232e-07, 'lr/merger': 1.4338837391175582e-05, 'lr/llm': 3.5847093477938955e-06, 'epoch': 14.827586206896552}
{'loss': 0.38972559571266174, 'grad_norm': 23.787166595458984, 'lm_loss': 0.38972559571266174, 'teacher_lm_loss': 0.007638113864231855, 'student_lm_loss': 0.512848749756813, 'remaining_hr': 0.484, 'lr/vision': 5.690473046962798e-07, 'lr/merger': 1.4226182617406996e-05, 'lr/llm': 3.556545654351749e-06, 'epoch': 14.96551724137931}
{'loss': 0.2562042772769928, 'grad_norm': 23.787166595458984, 'lm_loss': 0.2562042772769928, 'teacher_lm_loss': 0.01938212476670742, 'student_lm_loss': 0.36826395988464355, 'remaining_hr': 0.478, 'lr/vision': 5.645148412522447e-07, 'lr/merger': 1.4112871031306118e-05, 'lr/llm': 3.5282177578265295e-06, 'epoch': 15.0}
{'eval_loss': 1.4423737525939941, 'eval_runtime': 1.9466, 'eval_samples_per_second': 19.521, 'eval_steps_per_second': 2.055, 'lr/vision': 5.645148412522447e-07, 'lr/merger': 1.4112871031306118e-05, 'lr/llm': 3.5282177578265295e-06, 'epoch': 15.0}
{'eval_loss': 1.4423737525939941, 'eval_runtime': 1.9466, 'eval_samples_per_second': 19.521, 'eval_steps_per_second': 2.055, 'lr/vision': 5.645148412522447e-07, 'lr/merger': 1.4112871031306118e-05, 'lr/llm': 3.5282177578265295e-06, 'epoch': 15.0, 'eval_lm_loss': 0.6633, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.6504}
{'loss': 0.3124793954193592, 'grad_norm': 22.644437789916992, 'lm_loss': 0.3124793954193592, 'teacher_lm_loss': 0.008564503979869187, 'student_lm_loss': 0.47981058061122894, 'remaining_hr': 0.476, 'lr/vision': 5.599568097278963e-07, 'lr/merger': 1.3998920243197408e-05, 'lr/llm': 3.499730060799352e-06, 'epoch': 15.137931034482758}
{'loss': 0.31209155917167664, 'grad_norm': 37.60024642944336, 'lm_loss': 0.31209155917167664, 'teacher_lm_loss': 0.004966307431459427, 'student_lm_loss': 0.4053909108042717, 'remaining_hr': 0.472, 'lr/vision': 5.553739185098779e-07, 'lr/merger': 1.3884347962746949e-05, 'lr/llm': 3.471086990686737e-06, 'epoch': 15.275862068965518}
{'loss': 0.298140998929739, 'grad_norm': 30.74222183227539, 'lm_loss': 0.298140998929739, 'teacher_lm_loss': 0.07431657612323761, 'student_lm_loss': 0.3768777847290039, 'remaining_hr': 0.469, 'lr/vision': 5.507668798484021e-07, 'lr/merger': 1.3769171996210053e-05, 'lr/llm': 3.4422929990525133e-06, 'epoch': 15.413793103448276}
{'loss': 0.2732940539717674, 'grad_norm': 33.22437286376953, 'lm_loss': 0.2732940539717674, 'teacher_lm_loss': 0.045310191868338734, 'student_lm_loss': 0.37992486357688904, 'remaining_hr': 0.467, 'lr/vision': 5.461364097465581e-07, 'lr/merger': 1.3653410243663953e-05, 'lr/llm': 3.4133525609159883e-06, 'epoch': 15.551724137931034}
{'loss': 0.19004211015999317, 'grad_norm': 27.850027084350586, 'lm_loss': 0.19004211015999317, 'teacher_lm_loss': 0.0032644807070028037, 'student_lm_loss': 0.40957146137952805, 'remaining_hr': 0.464, 'lr/vision': 5.414832278490325e-07, 'lr/merger': 1.3537080696225815e-05, 'lr/llm': 3.384270174056454e-06, 'epoch': 15.689655172413794}
{'loss': 0.21422229893505573, 'grad_norm': 257.9627990722656, 'lm_loss': 0.21422229893505573, 'teacher_lm_loss': 0.033296926485490985, 'student_lm_loss': 0.33185412734746933, 'remaining_hr': 0.461, 'lr/vision': 5.368080573302676e-07, 'lr/merger': 1.342020143325669e-05, 'lr/llm': 3.3550503583141726e-06, 'epoch': 15.827586206896552}
{'loss': 0.26704687252640724, 'grad_norm': 45.58196258544922, 'lm_loss': 0.26704687252640724, 'teacher_lm_loss': 0.014818658368312754, 'student_lm_loss': 0.3929721899330616, 'remaining_hr': 0.458, 'lr/vision': 5.321116247820669e-07, 'lr/merger': 1.3302790619551673e-05, 'lr/llm': 3.3256976548879183e-06, 'epoch': 15.96551724137931}
{'loss': 0.22096306085586548, 'grad_norm': 52.66282272338867, 'lm_loss': 0.22096306085586548, 'teacher_lm_loss': 0.0019353808602318168, 'student_lm_loss': 0.39518868923187256, 'remaining_hr': 0.452, 'lr/vision': 5.273946601006738e-07, 'lr/merger': 1.3184866502516846e-05, 'lr/llm': 3.2962166256292116e-06, 'epoch': 16.0}
{'loss': 0.30816053599119186, 'grad_norm': 86.75348663330078, 'lm_loss': 0.30816053599119186, 'teacher_lm_loss': 0.002583223511464894, 'student_lm_loss': 0.3974795639514923, 'remaining_hr': 0.45, 'lr/vision': 5.226578963733337e-07, 'lr/merger': 1.3066447409333345e-05, 'lr/llm': 3.2666118523333363e-06, 'epoch': 16.137931034482758}
{'loss': 0.12183303385972977, 'grad_norm': 46.690406799316406, 'lm_loss': 0.12183303385972977, 'teacher_lm_loss': 0.009400349110364914, 'student_lm_loss': 0.2980516329407692, 'remaining_hr': 0.447, 'lr/vision': 5.179020697643617e-07, 'lr/merger': 1.2947551744109044e-05, 'lr/llm': 3.236887936027261e-06, 'epoch': 16.275862068965516}
{'eval_loss': 1.6265382766723633, 'eval_runtime': 1.959, 'eval_samples_per_second': 19.398, 'eval_steps_per_second': 2.042, 'lr/vision': 5.179020697643617e-07, 'lr/merger': 1.2947551744109044e-05, 'lr/llm': 3.236887936027261e-06, 'epoch': 16.275862068965516}
{'eval_loss': 1.6265382766723633, 'eval_runtime': 1.959, 'eval_samples_per_second': 19.398, 'eval_steps_per_second': 2.042, 'lr/vision': 5.179020697643617e-07, 'lr/merger': 1.2947551744109044e-05, 'lr/llm': 3.236887936027261e-06, 'epoch': 16.275862068965516, 'eval_lm_loss': 0.7356, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.715}
{'loss': 0.23486444540321827, 'grad_norm': 34.88698196411133, 'lm_loss': 0.23486444540321827, 'teacher_lm_loss': 0.005208623086218722, 'student_lm_loss': 0.42396313324570656, 'remaining_hr': 0.444, 'lr/vision': 5.131279194007309e-07, 'lr/merger': 1.2828197985018276e-05, 'lr/llm': 3.207049496254569e-06, 'epoch': 16.413793103448278}
{'loss': 0.3422883339226246, 'grad_norm': 34.61906051635742, 'lm_loss': 0.3422883339226246, 'teacher_lm_loss': 0.0010779618751257658, 'student_lm_loss': 0.4467494487762451, 'remaining_hr': 0.442, 'lr/vision': 5.08336187257202e-07, 'lr/merger': 1.2708404681430054e-05, 'lr/llm': 3.1771011703575134e-06, 'epoch': 16.551724137931036}
{'loss': 0.2967674545943737, 'grad_norm': 29.252151489257812, 'lm_loss': 0.2967674545943737, 'teacher_lm_loss': 0.002303760527865961, 'student_lm_loss': 0.37360988184809685, 'remaining_hr': 0.439, 'lr/vision': 5.035276180410083e-07, 'lr/merger': 1.2588190451025209e-05, 'lr/llm': 3.147047612756302e-06, 'epoch': 16.689655172413794}
{'loss': 0.35386707819998264, 'grad_norm': 67.55338287353516, 'lm_loss': 0.35386707819998264, 'teacher_lm_loss': 0.06960621262987843, 'student_lm_loss': 0.44755110144615173, 'remaining_hr': 0.436, 'lr/vision': 4.987029590761174e-07, 'lr/merger': 1.2467573976902936e-05, 'lr/llm': 3.116893494225734e-06, 'epoch': 16.82758620689655}
{'loss': 0.26662901043891907, 'grad_norm': 23.06415367126465, 'lm_loss': 0.26662901043891907, 'teacher_lm_loss': 0.0028636676142923534, 'student_lm_loss': 0.37224576249718666, 'remaining_hr': 0.433, 'lr/vision': 4.938629601870861e-07, 'lr/merger': 1.2346574004677154e-05, 'lr/llm': 3.0866435011692884e-06, 'epoch': 16.96551724137931}
{'loss': 0.2765391767024994, 'grad_norm': 23.06415367126465, 'lm_loss': 0.2765391767024994, 'teacher_lm_loss': 0.0024042706936597824, 'student_lm_loss': 0.5047618746757507, 'remaining_hr': 0.428, 'lr/vision': 4.890083735825257e-07, 'lr/merger': 1.2225209339563144e-05, 'lr/llm': 3.056302334890786e-06, 'epoch': 17.0}
{'loss': 0.22539043053984642, 'grad_norm': 45.15283203125, 'lm_loss': 0.22539043053984642, 'teacher_lm_loss': 0.0024511220690328628, 'student_lm_loss': 0.4966907724738121, 'remaining_hr': 0.425, 'lr/vision': 4.841399537381984e-07, 'lr/merger': 1.210349884345496e-05, 'lr/llm': 3.02587471086374e-06, 'epoch': 17.137931034482758}
{'loss': 0.2750836107879877, 'grad_norm': 34.76020431518555, 'lm_loss': 0.2750836107879877, 'teacher_lm_loss': 0.028418068275641417, 'student_lm_loss': 0.2903217151761055, 'remaining_hr': 0.422, 'lr/vision': 4.79258457279759e-07, 'lr/merger': 1.1981461431993978e-05, 'lr/llm': 2.9953653579984945e-06, 'epoch': 17.275862068965516}
{'loss': 0.25939783826470375, 'grad_norm': 32.926910400390625, 'lm_loss': 0.25939783826470375, 'teacher_lm_loss': 0.0026533238124102354, 'student_lm_loss': 0.4047965407371521, 'remaining_hr': 0.419, 'lr/vision': 4.743646428651659e-07, 'lr/merger': 1.1859116071629148e-05, 'lr/llm': 2.964779017907287e-06, 'epoch': 17.413793103448278}
{'loss': 0.2849414236843586, 'grad_norm': 55.50444030761719, 'lm_loss': 0.2849414236843586, 'teacher_lm_loss': 0.0011487119627417997, 'student_lm_loss': 0.31612996943295, 'remaining_hr': 0.416, 'lr/vision': 4.694592710667722e-07, 'lr/merger': 1.1736481776669307e-05, 'lr/llm': 2.9341204441673267e-06, 'epoch': 17.551724137931036}
{'eval_loss': 1.6310707330703735, 'eval_runtime': 2.4514, 'eval_samples_per_second': 15.501, 'eval_steps_per_second': 1.632, 'lr/vision': 4.694592710667722e-07, 'lr/merger': 1.1736481776669307e-05, 'lr/llm': 2.9341204441673267e-06, 'epoch': 17.551724137931036}
{'eval_loss': 1.6310707330703735, 'eval_runtime': 2.4514, 'eval_samples_per_second': 15.501, 'eval_steps_per_second': 1.632, 'lr/vision': 4.694592710667722e-07, 'lr/merger': 1.1736481776669307e-05, 'lr/llm': 2.9341204441673267e-06, 'epoch': 17.551724137931036, 'eval_lm_loss': 0.7453, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.7278}
{'loss': 0.32520848140120506, 'grad_norm': 48.03762435913086, 'lm_loss': 0.32520848140120506, 'teacher_lm_loss': 0.0020174324163235724, 'student_lm_loss': 0.3823610097169876, 'remaining_hr': 0.414, 'lr/vision': 4.6454310425312265e-07, 'lr/merger': 1.1613577606328068e-05, 'lr/llm': 2.903394401582017e-06, 'epoch': 17.689655172413794}
{'loss': 0.3195243179798126, 'grad_norm': 25.429981231689453, 'lm_loss': 0.3195243179798126, 'teacher_lm_loss': 0.0023460054508177564, 'student_lm_loss': 0.39550135284662247, 'remaining_hr': 0.411, 'lr/vision': 4.596169064704697e-07, 'lr/merger': 1.1490422661761744e-05, 'lr/llm': 2.872605665440436e-06, 'epoch': 17.82758620689655}
{'loss': 0.2572320429608226, 'grad_norm': 108.1958999633789, 'lm_loss': 0.2572320429608226, 'teacher_lm_loss': 0.0019833852202282287, 'student_lm_loss': 0.3516746312379837, 'remaining_hr': 0.408, 'lr/vision': 4.5468144332402937e-07, 'lr/merger': 1.1367036083100735e-05, 'lr/llm': 2.841759020775184e-06, 'epoch': 17.96551724137931}
{'loss': 0.21786223351955414, 'grad_norm': 108.1958999633789, 'lm_loss': 0.21786223351955414, 'teacher_lm_loss': 0.004500481765717268, 'student_lm_loss': 0.562042772769928, 'remaining_hr': 0.403, 'lr/vision': 4.4973748185899413e-07, 'lr/merger': 1.1243437046474854e-05, 'lr/llm': 2.8108592616187135e-06, 'epoch': 18.0}
{'loss': 0.11419591400772333, 'grad_norm': 27.04041290283203, 'lm_loss': 0.11419591400772333, 'teacher_lm_loss': 0.01584281586110592, 'student_lm_loss': 0.2601591870188713, 'remaining_hr': 0.401, 'lr/vision': 4.447857904413231e-07, 'lr/merger': 1.1119644761033079e-05, 'lr/llm': 2.7799111902582697e-06, 'epoch': 18.137931034482758}
{'loss': 0.1677592694759369, 'grad_norm': 24.3877010345459, 'lm_loss': 0.1677592694759369, 'teacher_lm_loss': 0.009043932950589806, 'student_lm_loss': 0.3265937753021717, 'remaining_hr': 0.398, 'lr/vision': 4.3982713863832666e-07, 'lr/merger': 1.0995678465958168e-05, 'lr/llm': 2.748919616489542e-06, 'epoch': 18.275862068965516}
{'loss': 0.15395196340978146, 'grad_norm': 47.20966339111328, 'lm_loss': 0.15395196340978146, 'teacher_lm_loss': 0.002625994970003376, 'student_lm_loss': 0.33870963379740715, 'remaining_hr': 0.395, 'lr/vision': 4.3486229709906335e-07, 'lr/merger': 1.0871557427476585e-05, 'lr/llm': 2.717889356869146e-06, 'epoch': 18.413793103448278}
{'loss': 0.38378214836120605, 'grad_norm': 63.365150451660156, 'lm_loss': 0.38378214836120605, 'teacher_lm_loss': 0.002923067113442812, 'student_lm_loss': 0.4009583741426468, 'remaining_hr': 0.392, 'lr/vision': 4.298920374345697e-07, 'lr/merger': 1.0747300935864245e-05, 'lr/llm': 2.686825233966061e-06, 'epoch': 18.551724137931036}
{'loss': 0.20400891825556755, 'grad_norm': 24.569272994995117, 'lm_loss': 0.20400891825556755, 'teacher_lm_loss': 0.04492460216715699, 'student_lm_loss': 0.29070471972227097, 'remaining_hr': 0.389, 'lr/vision': 4.249171320979409e-07, 'lr/merger': 1.0622928302448523e-05, 'lr/llm': 2.6557320756121306e-06, 'epoch': 18.689655172413794}
{'loss': 0.1932658925652504, 'grad_norm': 24.066768646240234, 'lm_loss': 0.1932658925652504, 'teacher_lm_loss': 0.005220881575951353, 'student_lm_loss': 0.2592640034854412, 'remaining_hr': 0.386, 'lr/vision': 4.1993835426427883e-07, 'lr/merger': 1.0498458856606972e-05, 'lr/llm': 2.624614714151743e-06, 'epoch': 18.82758620689655}
2025-07-04 09:35:43 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:45 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:45 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:45 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:45 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:45 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:35:45 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'eval_loss': 1.647900104522705, 'eval_runtime': 1.9804, 'eval_samples_per_second': 19.188, 'eval_steps_per_second': 2.02, 'lr/vision': 4.1993835426427883e-07, 'lr/merger': 1.0498458856606972e-05, 'lr/llm': 2.624614714151743e-06, 'epoch': 18.82758620689655}
{'eval_loss': 1.647900104522705, 'eval_runtime': 1.9804, 'eval_samples_per_second': 19.188, 'eval_steps_per_second': 2.02, 'lr/vision': 4.1993835426427883e-07, 'lr/merger': 1.0498458856606972e-05, 'lr/llm': 2.624614714151743e-06, 'epoch': 18.82758620689655, 'eval_lm_loss': 0.7555, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.7356}
2025-07-04 09:35:49 - INFO - training - ğŸ’¾ Saving complete Qwen2.5-VL model with visual tower (sharded)â€¦
2025-07-04 09:35:58 - INFO - training - ğŸ’¾ Saving tokenizer...
2025-07-04 09:35:58 - INFO - training - ğŸ’¾ Saving image processor...
2025-07-04 09:35:58 - INFO - training -    âœ… Image processor config saved with 9 parameters (preserving base config)
2025-07-04 09:35:58 - INFO - training - ğŸ’¾ Copying essential files from base model...
2025-07-04 09:35:58 - INFO - training -    âœ… generation_config.json already exists
2025-07-04 09:35:58 - INFO - training -    âœ… Copied chat_template.json (optional)
2025-07-04 09:35:58 - INFO - training -    âœ… Copied LICENSE (optional)
2025-07-04 09:35:58 - INFO - training -    âœ… Copied README.md (optional)
2025-07-04 09:35:58 - INFO - training - ğŸ” Verifying saved checkpoint components...
2025-07-04 09:35:58 - INFO - training -    âœ… config.json exists
2025-07-04 09:35:58 - INFO - training -    âœ… tokenizer_config.json exists
2025-07-04 09:35:58 - INFO - training -    âœ… preprocessor_config.json exists
2025-07-04 09:35:58 - INFO - training -    âœ… generation_config.json exists
2025-07-04 09:35:58 - INFO - training -    âœ… Found 5 safetensor files
2025-07-04 09:35:58 - INFO - training -    âœ… Total parameters saved: 445
2025-07-04 09:35:58 - INFO - training -    âœ… Visual tower parameters found: 390
2025-07-04 09:35:58 - INFO - training -       Examples: ['visual.blocks.0.attn.proj.bias', 'visual.blocks.0.attn.proj.weight', 'visual.blocks.0.attn.qkv.bias']...
2025-07-04 09:35:58 - INFO - training - âœ… Checkpoint saved successfully â†’ output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint-150
2025-07-04 09:36:19 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:19 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:19 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:19 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:19 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:25 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:36:28 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:28 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:28 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:28 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:28 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:28 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:31 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:36:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'loss': 0.11976447701454163, 'grad_norm': 39.38932800292969, 'lm_loss': 0.11976447701454163, 'teacher_lm_loss': 0.002431238579447381, 'student_lm_loss': 0.1863686814904213, 'remaining_hr': 0.393, 'lr/vision': 4.1495647771053034e-07, 'lr/merger': 1.037391194276326e-05, 'lr/llm': 2.593477985690815e-06, 'epoch': 18.96551724137931}
{'loss': 0.10094073414802551, 'grad_norm': 39.38932800292969, 'lm_loss': 0.10094073414802551, 'teacher_lm_loss': 0.001663193921558559, 'student_lm_loss': 0.1999582052230835, 'remaining_hr': 0.388, 'lr/vision': 4.0997227669522914e-07, 'lr/merger': 1.0249306917380731e-05, 'lr/llm': 2.5623267293451827e-06, 'epoch': 19.0}
{'loss': 0.2666211649775505, 'grad_norm': 77.06690979003906, 'lm_loss': 0.2666211649775505, 'teacher_lm_loss': 0.012029472651192918, 'student_lm_loss': 0.3977807052433491, 'remaining_hr': 0.385, 'lr/vision': 4.04986525838166e-07, 'lr/merger': 1.0124663145954152e-05, 'lr/llm': 2.531165786488538e-06, 'epoch': 19.137931034482758}
{'loss': 0.1562395803630352, 'grad_norm': 28.067108154296875, 'lm_loss': 0.1562395803630352, 'teacher_lm_loss': 0.00761756906285882, 'student_lm_loss': 0.2643367927521467, 'remaining_hr': 0.382, 'lr/vision': 4e-07, 'lr/merger': 1e-05, 'lr/llm': 2.5e-06, 'epoch': 19.275862068965516}
{'loss': 0.14748560078442097, 'grad_norm': 68.05036163330078, 'lm_loss': 0.14748560078442097, 'teacher_lm_loss': 0.012573470245115459, 'student_lm_loss': 0.3221425265073776, 'remaining_hr': 0.379, 'lr/vision': 3.9501347416183395e-07, 'lr/merger': 9.87533685404585e-06, 'lr/llm': 2.4688342135114625e-06, 'epoch': 19.413793103448278}
{'loss': 0.23221943154931068, 'grad_norm': 27.819791793823242, 'lm_loss': 0.23221943154931068, 'teacher_lm_loss': 0.003995576727902517, 'student_lm_loss': 0.2578541152179241, 'remaining_hr': 0.376, 'lr/vision': 3.900277233047709e-07, 'lr/merger': 9.750693082619274e-06, 'lr/llm': 2.4376732706548185e-06, 'epoch': 19.551724137931036}
{'loss': 0.27588289231061935, 'grad_norm': 33.0781364440918, 'lm_loss': 0.27588289231061935, 'teacher_lm_loss': 0.006150547415018082, 'student_lm_loss': 0.3476434797048569, 'remaining_hr': 0.373, 'lr/vision': 3.850435222894698e-07, 'lr/merger': 9.626088057236745e-06, 'lr/llm': 2.4065220143091863e-06, 'epoch': 19.689655172413794}
{'loss': 0.3139415457844734, 'grad_norm': 30.636951446533203, 'lm_loss': 0.3139415457844734, 'teacher_lm_loss': 0.0014232068206183612, 'student_lm_loss': 0.316077571362257, 'remaining_hr': 0.37, 'lr/vision': 3.800616457357211e-07, 'lr/merger': 9.501541143393028e-06, 'lr/llm': 2.375385285848257e-06, 'epoch': 19.82758620689655}
{'loss': 0.30281764827668667, 'grad_norm': 89.16950225830078, 'lm_loss': 0.30281764827668667, 'teacher_lm_loss': 0.2905538959603291, 'student_lm_loss': 0.2344419602304697, 'remaining_hr': 0.367, 'lr/vision': 3.7508286790205914e-07, 'lr/merger': 9.377071697551479e-06, 'lr/llm': 2.3442679243878698e-06, 'epoch': 19.96551724137931}
{'loss': 0.298111230134964, 'grad_norm': 23.34953498840332, 'lm_loss': 0.298111230134964, 'teacher_lm_loss': 0.0, 'student_lm_loss': 0.30659881234169006, 'remaining_hr': 0.362, 'lr/vision': 3.7010796256543027e-07, 'lr/merger': 9.252699064135759e-06, 'lr/llm': 2.3131747660339396e-06, 'epoch': 20.0}
{'eval_loss': 1.874212622642517, 'eval_runtime': 2.0126, 'eval_samples_per_second': 18.881, 'eval_steps_per_second': 1.987, 'lr/vision': 3.7010796256543027e-07, 'lr/merger': 9.252699064135759e-06, 'lr/llm': 2.3131747660339396e-06, 'epoch': 20.0}
{'eval_loss': 1.874212622642517, 'eval_runtime': 2.0126, 'eval_samples_per_second': 18.881, 'eval_steps_per_second': 1.987, 'lr/vision': 3.7010796256543027e-07, 'lr/merger': 9.252699064135759e-06, 'lr/llm': 2.3131747660339396e-06, 'epoch': 20.0, 'eval_lm_loss': 0.8386, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.8243}
{'loss': 0.04719650046899915, 'grad_norm': 38.70962142944336, 'lm_loss': 0.04719650046899915, 'teacher_lm_loss': 0.004489053069846705, 'student_lm_loss': 0.1468344610184431, 'remaining_hr': 0.36, 'lr/vision': 3.6513770290093667e-07, 'lr/merger': 9.128442572523418e-06, 'lr/llm': 2.2821106431308546e-06, 'epoch': 20.137931034482758}
{'loss': 0.12391015980392694, 'grad_norm': 49.46807098388672, 'lm_loss': 0.12391015980392694, 'teacher_lm_loss': 0.00767354154959321, 'student_lm_loss': 0.23094492405653, 'remaining_hr': 0.357, 'lr/vision': 3.6017286136167336e-07, 'lr/merger': 9.004321534041836e-06, 'lr/llm': 2.251080383510459e-06, 'epoch': 20.275862068965516}
{'loss': 0.1383805125951767, 'grad_norm': 56.508724212646484, 'lm_loss': 0.1383805125951767, 'teacher_lm_loss': 0.0010083352608489804, 'student_lm_loss': 0.20837749913334846, 'remaining_hr': 0.354, 'lr/vision': 3.5521420955867687e-07, 'lr/merger': 8.880355238966923e-06, 'lr/llm': 2.2200888097417308e-06, 'epoch': 20.413793103448278}
{'loss': 0.10450284508988261, 'grad_norm': 44.54517364501953, 'lm_loss': 0.10450284508988261, 'teacher_lm_loss': 0.0019032739583053626, 'student_lm_loss': 0.13741544261574745, 'remaining_hr': 0.351, 'lr/vision': 3.5026251814100604e-07, 'lr/merger': 8.756562953525151e-06, 'lr/llm': 2.1891407383812878e-06, 'epoch': 20.551724137931036}
{'loss': 0.15102128125727177, 'grad_norm': 56.4702262878418, 'lm_loss': 0.15102128125727177, 'teacher_lm_loss': 0.0037662175527657382, 'student_lm_loss': 0.3712603375315666, 'remaining_hr': 0.348, 'lr/vision': 3.453185566759707e-07, 'lr/merger': 8.632963916899268e-06, 'lr/llm': 2.158240979224817e-06, 'epoch': 20.689655172413794}
{'loss': 0.15727674216032028, 'grad_norm': 42.96276092529297, 'lm_loss': 0.15727674216032028, 'teacher_lm_loss': 0.006782296157325618, 'student_lm_loss': 0.2704612873494625, 'remaining_hr': 0.345, 'lr/vision': 3.4038309352953014e-07, 'lr/merger': 8.509577338238255e-06, 'lr/llm': 2.1273943345595637e-06, 'epoch': 20.82758620689655}
{'loss': 0.10258679371327162, 'grad_norm': 45.65968704223633, 'lm_loss': 0.10258679371327162, 'teacher_lm_loss': 0.003939647329389118, 'student_lm_loss': 0.1796854017302394, 'remaining_hr': 0.342, 'lr/vision': 3.354568957468773e-07, 'lr/merger': 8.386422393671934e-06, 'lr/llm': 2.0966055984179834e-06, 'epoch': 20.96551724137931}
{'loss': 0.229395791888237, 'grad_norm': 45.65968704223633, 'lm_loss': 0.229395791888237, 'teacher_lm_loss': 0.001221049576997757, 'student_lm_loss': 0.2898496389389038, 'remaining_hr': 0.337, 'lr/vision': 3.3054072893322785e-07, 'lr/merger': 8.263518223330698e-06, 'lr/llm': 2.0658795558326745e-06, 'epoch': 21.0}
{'loss': 0.14780933037400246, 'grad_norm': 23.993099212646484, 'lm_loss': 0.14780933037400246, 'teacher_lm_loss': 0.034229126205900684, 'student_lm_loss': 0.20837554335594177, 'remaining_hr': 0.334, 'lr/vision': 3.256353571348342e-07, 'lr/merger': 8.140883928370855e-06, 'lr/llm': 2.035220982092714e-06, 'epoch': 21.137931034482758}
{'loss': 0.09193855570629239, 'grad_norm': 30.342252731323242, 'lm_loss': 0.09193855570629239, 'teacher_lm_loss': 0.0023347248788923025, 'student_lm_loss': 0.14559407532215118, 'remaining_hr': 0.331, 'lr/vision': 3.2074154272024104e-07, 'lr/merger': 8.018538568006027e-06, 'lr/llm': 2.004634642001507e-06, 'epoch': 21.275862068965516}
{'eval_loss': 2.0847582817077637, 'eval_runtime': 1.817, 'eval_samples_per_second': 20.913, 'eval_steps_per_second': 2.201, 'lr/vision': 3.2074154272024104e-07, 'lr/merger': 8.018538568006027e-06, 'lr/llm': 2.004634642001507e-06, 'epoch': 21.275862068965516}
{'eval_loss': 2.0847582817077637, 'eval_runtime': 1.817, 'eval_samples_per_second': 20.913, 'eval_steps_per_second': 2.201, 'lr/vision': 3.2074154272024104e-07, 'lr/merger': 8.018538568006027e-06, 'lr/llm': 2.004634642001507e-06, 'epoch': 21.275862068965516, 'eval_lm_loss': 0.922, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 0.9049}
{'loss': 0.19897343311458826, 'grad_norm': 44.797298431396484, 'lm_loss': 0.19897343311458826, 'teacher_lm_loss': 0.0015277533966582268, 'student_lm_loss': 0.22208221442997456, 'remaining_hr': 0.329, 'lr/vision': 3.158600462618017e-07, 'lr/merger': 7.896501156545044e-06, 'lr/llm': 1.974125289136261e-06, 'epoch': 21.413793103448278}
{'loss': 0.18570292089134455, 'grad_norm': 101.68795776367188, 'lm_loss': 0.18570292089134455, 'teacher_lm_loss': 0.0018838263349607587, 'student_lm_loss': 0.24276433512568474, 'remaining_hr': 0.326, 'lr/vision': 3.1099162641747425e-07, 'lr/merger': 7.774790660436857e-06, 'lr/llm': 1.9436976651092143e-06, 'epoch': 21.551724137931036}
{'loss': 0.10207371227443218, 'grad_norm': 62.04401779174805, 'lm_loss': 0.10207371227443218, 'teacher_lm_loss': 0.0012681041480391286, 'student_lm_loss': 0.19538597390055656, 'remaining_hr': 0.323, 'lr/vision': 3.06137039812914e-07, 'lr/merger': 7.653425995322852e-06, 'lr/llm': 1.913356498830713e-06, 'epoch': 21.689655172413794}
{'loss': 0.1669406984001398, 'grad_norm': 38.98624801635742, 'lm_loss': 0.1669406984001398, 'teacher_lm_loss': 0.012908790056826547, 'student_lm_loss': 0.31939441710710526, 'remaining_hr': 0.32, 'lr/vision': 3.012970409238825e-07, 'lr/merger': 7.532426023097063e-06, 'lr/llm': 1.8831065057742658e-06, 'epoch': 21.82758620689655}
{'loss': 0.09835082478821278, 'grad_norm': 57.1616325378418, 'lm_loss': 0.09835082478821278, 'teacher_lm_loss': 0.003658842484583147, 'student_lm_loss': 0.19175520539283752, 'remaining_hr': 0.317, 'lr/vision': 2.9647238195899166e-07, 'lr/merger': 7.411809548974792e-06, 'lr/llm': 1.852952387243698e-06, 'epoch': 21.96551724137931}
{'loss': 0.231502965092659, 'grad_norm': 57.1616325378418, 'lm_loss': 0.231502965092659, 'teacher_lm_loss': 0.0, 'student_lm_loss': 0.23560965061187744, 'remaining_hr': 0.312, 'lr/vision': 2.91663812742798e-07, 'lr/merger': 7.291595318569951e-06, 'lr/llm': 1.8228988296424877e-06, 'epoch': 22.0}
{'loss': 0.14931494370102882, 'grad_norm': 37.47873306274414, 'lm_loss': 0.14931494370102882, 'teacher_lm_loss': 0.004351378622232005, 'student_lm_loss': 0.16568168625235558, 'remaining_hr': 0.31, 'lr/vision': 2.86872080599269e-07, 'lr/merger': 7.171802014981726e-06, 'lr/llm': 1.7929505037454315e-06, 'epoch': 22.137931034482758}
{'loss': 0.10434021055698395, 'grad_norm': 36.654624938964844, 'lm_loss': 0.10434021055698395, 'teacher_lm_loss': 0.000427032369771041, 'student_lm_loss': 0.1462363563477993, 'remaining_hr': 0.306, 'lr/vision': 2.820979302356383e-07, 'lr/merger': 7.052448255890958e-06, 'lr/llm': 1.7631120639727396e-06, 'epoch': 22.275862068965516}
{'loss': 0.05889613274484873, 'grad_norm': 26.567256927490234, 'lm_loss': 0.05889613274484873, 'teacher_lm_loss': 0.009920296724885702, 'student_lm_loss': 0.11149536911398172, 'remaining_hr': 0.304, 'lr/vision': 2.7734210362666634e-07, 'lr/merger': 6.933552590666659e-06, 'lr/llm': 1.7333881476666648e-06, 'epoch': 22.413793103448278}
{'loss': 0.08933000732213259, 'grad_norm': 29.553356170654297, 'lm_loss': 0.08933000732213259, 'teacher_lm_loss': 0.004770954757987056, 'student_lm_loss': 0.37823736388236284, 'remaining_hr': 0.3, 'lr/vision': 2.7260533989932626e-07, 'lr/merger': 6.815133497483157e-06, 'lr/llm': 1.7037833743707892e-06, 'epoch': 22.551724137931036}
{'eval_loss': 2.3904669284820557, 'eval_runtime': 1.8105, 'eval_samples_per_second': 20.989, 'eval_steps_per_second': 2.209, 'lr/vision': 2.7260533989932626e-07, 'lr/merger': 6.815133497483157e-06, 'lr/llm': 1.7037833743707892e-06, 'epoch': 22.551724137931036}
{'eval_loss': 2.3904669284820557, 'eval_runtime': 1.8105, 'eval_samples_per_second': 20.989, 'eval_steps_per_second': 2.209, 'lr/vision': 2.7260533989932626e-07, 'lr/merger': 6.815133497483157e-06, 'lr/llm': 1.7037833743707892e-06, 'epoch': 22.551724137931036, 'eval_lm_loss': 1.0585, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.0347}
{'loss': 0.18640337884426117, 'grad_norm': 51.20962142944336, 'lm_loss': 0.18640337884426117, 'teacher_lm_loss': 0.00042370294613647275, 'student_lm_loss': 0.2217950001358986, 'remaining_hr': 0.298, 'lr/vision': 2.678883752179333e-07, 'lr/merger': 6.697209380448333e-06, 'lr/llm': 1.6743023451120831e-06, 'epoch': 22.689655172413794}
{'loss': 0.19389829225838184, 'grad_norm': 46.236480712890625, 'lm_loss': 0.19389829225838184, 'teacher_lm_loss': 0.0001937622218974866, 'student_lm_loss': 0.1841643638908863, 'remaining_hr': 0.295, 'lr/vision': 2.631919426697325e-07, 'lr/merger': 6.579798566743314e-06, 'lr/llm': 1.6449496416858285e-06, 'epoch': 22.82758620689655}
{'loss': 0.09093949012458324, 'grad_norm': 104.45954895019531, 'lm_loss': 0.09093949012458324, 'teacher_lm_loss': 0.01767955815194, 'student_lm_loss': 0.1809421069920063, 'remaining_hr': 0.292, 'lr/vision': 2.5851677215096743e-07, 'lr/merger': 6.462919303774186e-06, 'lr/llm': 1.6157298259435466e-06, 'epoch': 22.96551724137931}
{'loss': 0.03211761638522148, 'grad_norm': 104.45954895019531, 'lm_loss': 0.03211761638522148, 'teacher_lm_loss': 0.0009835062082856894, 'student_lm_loss': 0.17083792388439178, 'remaining_hr': 0.288, 'lr/vision': 2.5386359025344197e-07, 'lr/merger': 6.34658975633605e-06, 'lr/llm': 1.5866474390840126e-06, 'epoch': 23.0}
{'loss': 0.08277455158531666, 'grad_norm': 87.21544647216797, 'lm_loss': 0.08277455158531666, 'teacher_lm_loss': 0.0014098332030698657, 'student_lm_loss': 0.13161841593682766, 'remaining_hr': 0.285, 'lr/vision': 2.492331201515979e-07, 'lr/merger': 6.230828003789949e-06, 'lr/llm': 1.5577070009474872e-06, 'epoch': 23.137931034482758}
{'loss': 0.1342591904103756, 'grad_norm': 41.62614822387695, 'lm_loss': 0.1342591904103756, 'teacher_lm_loss': 0.06110669887129916, 'student_lm_loss': 0.13559416122734547, 'remaining_hr': 0.282, 'lr/vision': 2.4462608149012213e-07, 'lr/merger': 6.115652037253054e-06, 'lr/llm': 1.5289130093132634e-06, 'epoch': 23.275862068965516}
{'loss': 0.1061219573020935, 'grad_norm': 26.28349494934082, 'lm_loss': 0.1061219573020935, 'teacher_lm_loss': 0.0031705564388175844, 'student_lm_loss': 0.21600482799112797, 'remaining_hr': 0.279, 'lr/vision': 2.4004319027210367e-07, 'lr/merger': 6.001079756802592e-06, 'lr/llm': 1.500269939200648e-06, 'epoch': 23.413793103448278}
{'loss': 0.0998893091455102, 'grad_norm': 59.06071472167969, 'lm_loss': 0.0998893091455102, 'teacher_lm_loss': 0.002496596280252561, 'student_lm_loss': 0.1807199027389288, 'remaining_hr': 0.276, 'lr/vision': 2.3548515874775546e-07, 'lr/merger': 5.887128968693887e-06, 'lr/llm': 1.4717822421734717e-06, 'epoch': 23.551724137931036}
{'loss': 0.117637830786407, 'grad_norm': 46.665504455566406, 'lm_loss': 0.117637830786407, 'teacher_lm_loss': 0.0008027824906093883, 'student_lm_loss': 0.10852683894336224, 'remaining_hr': 0.273, 'lr/vision': 2.3095269530372028e-07, 'lr/merger': 5.773817382593008e-06, 'lr/llm': 1.443454345648252e-06, 'epoch': 23.689655172413794}
{'loss': 0.1686320323497057, 'grad_norm': 30.668333053588867, 'lm_loss': 0.1686320323497057, 'teacher_lm_loss': 0.00217216710007051, 'student_lm_loss': 0.18882282450795174, 'remaining_hr': 0.27, 'lr/vision': 2.2644650435297675e-07, 'lr/merger': 5.66116260882442e-06, 'lr/llm': 1.415290652206105e-06, 'epoch': 23.82758620689655}
{'eval_loss': 2.3652782440185547, 'eval_runtime': 1.8254, 'eval_samples_per_second': 20.817, 'eval_steps_per_second': 2.191, 'lr/vision': 2.2644650435297675e-07, 'lr/merger': 5.66116260882442e-06, 'lr/llm': 1.415290652206105e-06, 'epoch': 23.82758620689655}
{'eval_loss': 2.3652782440185547, 'eval_runtime': 1.8254, 'eval_samples_per_second': 20.817, 'eval_steps_per_second': 2.191, 'lr/vision': 2.2644650435297675e-07, 'lr/merger': 5.66116260882442e-06, 'lr/llm': 1.415290652206105e-06, 'epoch': 23.82758620689655, 'eval_lm_loss': 1.0786, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.0723}
{'loss': 0.10268436465412378, 'grad_norm': 30.659854888916016, 'lm_loss': 0.10268436465412378, 'teacher_lm_loss': 0.0009103039446927141, 'student_lm_loss': 0.10081044770777225, 'remaining_hr': 0.267, 'lr/vision': 2.2196728622536304e-07, 'lr/merger': 5.549182155634076e-06, 'lr/llm': 1.387295538908519e-06, 'epoch': 23.96551724137931}
{'loss': 0.05638366937637329, 'grad_norm': 52.338592529296875, 'lm_loss': 0.05638366937637329, 'teacher_lm_loss': 0.003490794450044632, 'student_lm_loss': 0.18633794784545898, 'remaining_hr': 0.263, 'lr/vision': 2.1751573705873477e-07, 'lr/merger': 5.43789342646837e-06, 'lr/llm': 1.3594733566170925e-06, 'epoch': 24.0}
{'loss': 0.04068675497546792, 'grad_norm': 19.742971420288086, 'lm_loss': 0.04068675497546792, 'teacher_lm_loss': 0.00333819814841263, 'student_lm_loss': 0.08336487226188183, 'remaining_hr': 0.26, 'lr/vision': 2.1309254869077518e-07, 'lr/merger': 5.32731371726938e-06, 'lr/llm': 1.331828429317345e-06, 'epoch': 24.137931034482758}
{'loss': 0.09858230128884315, 'grad_norm': 34.1872673034668, 'lm_loss': 0.09858230128884315, 'teacher_lm_loss': 0.0007516499463235959, 'student_lm_loss': 0.0950482222251594, 'remaining_hr': 0.257, 'lr/vision': 2.0869840855147282e-07, 'lr/merger': 5.217460213786822e-06, 'lr/llm': 1.3043650534467054e-06, 'epoch': 24.275862068965516}
{'loss': 0.08188670128583908, 'grad_norm': 39.059810638427734, 'lm_loss': 0.08188670128583908, 'teacher_lm_loss': 0.0018660393252503127, 'student_lm_loss': 0.13849926181137562, 'remaining_hr': 0.254, 'lr/vision': 2.0433399955628442e-07, 'lr/merger': 5.108349988907111e-06, 'lr/llm': 1.2770874972267777e-06, 'epoch': 24.413793103448278}
{'loss': 0.06031125318259001, 'grad_norm': 33.405879974365234, 'lm_loss': 0.06031125318259001, 'teacher_lm_loss': 0.0005170958393136971, 'student_lm_loss': 0.07241693465039134, 'remaining_hr': 0.251, 'lr/vision': 2.0000000000000007e-07, 'lr/merger': 5.000000000000003e-06, 'lr/llm': 1.2500000000000007e-06, 'epoch': 24.551724137931036}
{'loss': 0.08722015377134085, 'grad_norm': 63.89753723144531, 'lm_loss': 0.08722015377134085, 'teacher_lm_loss': 0.0014147465990390629, 'student_lm_loss': 0.15336656151339412, 'remaining_hr': 0.248, 'lr/vision': 1.9569708345132585e-07, 'lr/merger': 4.892427086283147e-06, 'lr/llm': 1.2231067715707868e-06, 'epoch': 24.689655172413794}
{'loss': 0.05677294684574008, 'grad_norm': 35.0782585144043, 'lm_loss': 0.05677294684574008, 'teacher_lm_loss': 0.001876128910225816, 'student_lm_loss': 0.0983468871563673, 'remaining_hr': 0.246, 'lr/vision': 1.9142591864820078e-07, 'lr/merger': 4.78564796620502e-06, 'lr/llm': 1.196411991551255e-06, 'epoch': 24.82758620689655}
{'loss': 0.08624346647411585, 'grad_norm': 67.84889221191406, 'lm_loss': 0.08624346647411585, 'teacher_lm_loss': 0.001885231708001811, 'student_lm_loss': 0.11728912778198719, 'remaining_hr': 0.243, 'lr/vision': 1.871871693938654e-07, 'lr/merger': 4.679679234846636e-06, 'lr/llm': 1.169919808711659e-06, 'epoch': 24.96551724137931}
{'loss': 0.004382109269499779, 'grad_norm': 67.84889221191406, 'lm_loss': 0.004382109269499779, 'teacher_lm_loss': 0.0013685475569218397, 'student_lm_loss': 0.015530225820839405, 'remaining_hr': 0.239, 'lr/vision': 1.8298149445369627e-07, 'lr/merger': 4.5745373613424075e-06, 'lr/llm': 1.1436343403356019e-06, 'epoch': 25.0}
2025-07-04 09:44:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:44:48 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'eval_loss': 2.3581905364990234, 'eval_runtime': 1.8383, 'eval_samples_per_second': 20.672, 'eval_steps_per_second': 2.176, 'lr/vision': 1.8298149445369627e-07, 'lr/merger': 4.5745373613424075e-06, 'lr/llm': 1.1436343403356019e-06, 'epoch': 25.0}
{'eval_loss': 2.3581905364990234, 'eval_runtime': 1.8383, 'eval_samples_per_second': 20.672, 'eval_steps_per_second': 2.176, 'lr/vision': 1.8298149445369627e-07, 'lr/merger': 4.5745373613424075e-06, 'lr/llm': 1.1436343403356019e-06, 'epoch': 25.0, 'eval_lm_loss': 1.0472, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.0415}
2025-07-04 09:44:52 - INFO - training - ğŸ’¾ Saving complete Qwen2.5-VL model with visual tower (sharded)â€¦
2025-07-04 09:45:03 - INFO - training - ğŸ’¾ Saving tokenizer...
2025-07-04 09:45:03 - INFO - training - ğŸ’¾ Saving image processor...
2025-07-04 09:45:03 - INFO - training -    âœ… Image processor config saved with 9 parameters (preserving base config)
2025-07-04 09:45:03 - INFO - training - ğŸ’¾ Copying essential files from base model...
2025-07-04 09:45:03 - INFO - training -    âœ… generation_config.json already exists
2025-07-04 09:45:03 - INFO - training -    âœ… Copied chat_template.json (optional)
2025-07-04 09:45:03 - INFO - training -    âœ… Copied LICENSE (optional)
2025-07-04 09:45:03 - INFO - training -    âœ… Copied README.md (optional)
2025-07-04 09:45:03 - INFO - training - ğŸ” Verifying saved checkpoint components...
2025-07-04 09:45:03 - INFO - training -    âœ… config.json exists
2025-07-04 09:45:03 - INFO - training -    âœ… tokenizer_config.json exists
2025-07-04 09:45:03 - INFO - training -    âœ… preprocessor_config.json exists
2025-07-04 09:45:03 - INFO - training -    âœ… generation_config.json exists
2025-07-04 09:45:03 - INFO - training -    âœ… Found 5 safetensor files
2025-07-04 09:45:03 - INFO - training -    âœ… Total parameters saved: 445
2025-07-04 09:45:03 - INFO - training -    âœ… Visual tower parameters found: 390
2025-07-04 09:45:03 - INFO - training -       Examples: ['visual.blocks.0.attn.proj.bias', 'visual.blocks.0.attn.proj.weight', 'visual.blocks.0.attn.qkv.bias']...
2025-07-04 09:45:03 - INFO - training - âœ… Checkpoint saved successfully â†’ output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint-200
2025-07-04 09:45:26 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:26 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:26 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:26 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:26 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:32 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:45:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:34 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:37 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:40 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:40 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:40 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:40 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:40 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:45:40 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'loss': 0.08573183603584766, 'grad_norm': 41.675716400146484, 'lm_loss': 0.08573183603584766, 'teacher_lm_loss': 0.01142841084219981, 'student_lm_loss': 0.14625211246311665, 'remaining_hr': 0.241, 'lr/vision': 1.788095474528242e-07, 'lr/merger': 4.470238686320606e-06, 'lr/llm': 1.1175596715801515e-06, 'epoch': 25.137931034482758}
{'loss': 0.03286915319040418, 'grad_norm': 20.72083854675293, 'lm_loss': 0.03286915319040418, 'teacher_lm_loss': 0.0015892462615738623, 'student_lm_loss': 0.07067985646426678, 'remaining_hr': 0.238, 'lr/vision': 1.7467197677455116e-07, 'lr/merger': 4.3667994193637794e-06, 'lr/llm': 1.0916998548409449e-06, 'epoch': 25.275862068965516}
{'loss': 0.053127698600292206, 'grad_norm': 35.51368713378906, 'lm_loss': 0.053127698600292206, 'teacher_lm_loss': 0.003725128175574355, 'student_lm_loss': 0.03650982049293816, 'remaining_hr': 0.234, 'lr/vision': 1.7056942545958166e-07, 'lr/merger': 4.264235636489542e-06, 'lr/llm': 1.0660589091223854e-06, 'epoch': 25.413793103448278}
{'loss': 0.09246268402785063, 'grad_norm': 25.96040916442871, 'lm_loss': 0.09246268402785063, 'teacher_lm_loss': 0.0007386810830212198, 'student_lm_loss': 0.12022927100770175, 'remaining_hr': 0.231, 'lr/vision': 1.6650253110608414e-07, 'lr/merger': 4.162563277652104e-06, 'lr/llm': 1.040640819413026e-06, 'epoch': 25.551724137931036}
{'loss': 0.05295591149479151, 'grad_norm': 19.112964630126953, 'lm_loss': 0.05295591149479151, 'teacher_lm_loss': 0.0008339761302522675, 'student_lm_loss': 0.08143972977995872, 'remaining_hr': 0.228, 'lr/vision': 1.6247192577059941e-07, 'lr/merger': 4.061798144264986e-06, 'lr/llm': 1.0154495360662464e-06, 'epoch': 25.689655172413794}
{'loss': 0.06360847596079111, 'grad_norm': 112.62275695800781, 'lm_loss': 0.06360847596079111, 'teacher_lm_loss': 0.002513143361738912, 'student_lm_loss': 0.06400364066939801, 'remaining_hr': 0.225, 'lr/vision': 1.5847823586980895e-07, 'lr/merger': 3.961955896745224e-06, 'lr/llm': 9.90488974186306e-07, 'epoch': 25.82758620689655}
{'loss': 0.05217292136512697, 'grad_norm': 46.478580474853516, 'lm_loss': 0.05217292136512697, 'teacher_lm_loss': 0.0014356295432662591, 'student_lm_loss': 0.0988143915310502, 'remaining_hr': 0.222, 'lr/vision': 1.545220820831811e-07, 'lr/merger': 3.8630520520795275e-06, 'lr/llm': 9.657630130198819e-07, 'epoch': 25.96551724137931}
{'loss': 0.07164015620946884, 'grad_norm': 46.478580474853516, 'lm_loss': 0.07164015620946884, 'teacher_lm_loss': 0.0005269789835438132, 'student_lm_loss': 0.09761814773082733, 'remaining_hr': 0.218, 'lr/vision': 1.506040792565066e-07, 'lr/merger': 3.7651019814126656e-06, 'lr/llm': 9.412754953531664e-07, 'epoch': 26.0}
{'loss': 0.08842172753065825, 'grad_norm': 22.05105972290039, 'lm_loss': 0.08842172753065825, 'teacher_lm_loss': 0.01451720530167222, 'student_lm_loss': 0.08191131753847003, 'remaining_hr': 0.215, 'lr/vision': 1.467248363063441e-07, 'lr/merger': 3.6681209076586035e-06, 'lr/llm': 9.170302269146509e-07, 'epoch': 26.137931034482758}
{'loss': 0.062464283779263496, 'grad_norm': 29.031230926513672, 'lm_loss': 0.062464283779263496, 'teacher_lm_loss': 0.0029048397263977677, 'student_lm_loss': 0.10029612760990858, 'remaining_hr': 0.212, 'lr/vision': 1.4288495612538425e-07, 'lr/merger': 3.5721239031346067e-06, 'lr/llm': 8.930309757836517e-07, 'epoch': 26.275862068965516}
{'eval_loss': 2.5553202629089355, 'eval_runtime': 2.1431, 'eval_samples_per_second': 17.731, 'eval_steps_per_second': 1.866, 'lr/vision': 1.4288495612538425e-07, 'lr/merger': 3.5721239031346067e-06, 'lr/llm': 8.930309757836517e-07, 'epoch': 26.275862068965516}
{'eval_loss': 2.5553202629089355, 'eval_runtime': 2.1431, 'eval_samples_per_second': 17.731, 'eval_steps_per_second': 1.866, 'lr/vision': 1.4288495612538425e-07, 'lr/merger': 3.5721239031346067e-06, 'lr/llm': 8.930309757836517e-07, 'epoch': 26.275862068965516, 'eval_lm_loss': 1.1576, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.1323}
{'loss': 0.09218135196715593, 'grad_norm': 35.441646575927734, 'lm_loss': 0.09218135196715593, 'teacher_lm_loss': 0.0006898152837493399, 'student_lm_loss': 0.08615591912530363, 'remaining_hr': 0.21, 'lr/vision': 1.3908503548875167e-07, 'lr/merger': 3.4771258872187917e-06, 'lr/llm': 8.692814718046979e-07, 'epoch': 26.413793103448278}
{'loss': 0.0762417670339346, 'grad_norm': 26.601354598999023, 'lm_loss': 0.0762417670339346, 'teacher_lm_loss': 0.00030983046599430963, 'student_lm_loss': 0.11305366829037666, 'remaining_hr': 0.207, 'lr/vision': 1.3532566496125632e-07, 'lr/merger': 3.3831416240314085e-06, 'lr/llm': 8.457854060078521e-07, 'epoch': 26.551724137931036}
{'loss': 0.04525674041360617, 'grad_norm': 64.65742492675781, 'lm_loss': 0.04525674041360617, 'teacher_lm_loss': 0.00016759758727857843, 'student_lm_loss': 0.09369131550192833, 'remaining_hr': 0.203, 'lr/vision': 1.3160742880561202e-07, 'lr/merger': 3.290185720140301e-06, 'lr/llm': 8.225464300350752e-07, 'epoch': 26.689655172413794}
{'loss': 0.05105866421945393, 'grad_norm': 61.532718658447266, 'lm_loss': 0.05105866421945393, 'teacher_lm_loss': 0.017890294577227905, 'student_lm_loss': 0.11936183273792267, 'remaining_hr': 0.2, 'lr/vision': 1.2793090489163218e-07, 'lr/merger': 3.1982726222908046e-06, 'lr/llm': 7.995681555727011e-07, 'epoch': 26.82758620689655}
{'loss': 0.04763946961611509, 'grad_norm': 48.776309967041016, 'lm_loss': 0.04763946961611509, 'teacher_lm_loss': 0.0014929571234461037, 'student_lm_loss': 0.07906295452266932, 'remaining_hr': 0.197, 'lr/vision': 1.2429666460642118e-07, 'lr/merger': 3.10741661516053e-06, 'lr/llm': 7.768541537901325e-07, 'epoch': 26.96551724137931}
{'loss': 0.03761754184961319, 'grad_norm': 48.776309967041016, 'lm_loss': 0.03761754184961319, 'teacher_lm_loss': 0.004165266640484333, 'student_lm_loss': 0.10265593230724335, 'remaining_hr': 0.194, 'lr/vision': 1.207052727655709e-07, 'lr/merger': 3.017631819139273e-06, 'lr/llm': 7.544079547848183e-07, 'epoch': 27.0}
{'loss': 0.07111665070988238, 'grad_norm': 37.6070442199707, 'lm_loss': 0.07111665070988238, 'teacher_lm_loss': 0.0026606108440319076, 'student_lm_loss': 0.08656956348568201, 'remaining_hr': 0.191, 'lr/vision': 1.17157287525381e-07, 'lr/merger': 2.9289321881345257e-06, 'lr/llm': 7.322330470336314e-07, 'epoch': 27.137931034482758}
{'loss': 0.03270652983337641, 'grad_norm': 20.54102325439453, 'lm_loss': 0.03270652983337641, 'teacher_lm_loss': 0.0034738560098048765, 'student_lm_loss': 0.07668926008045673, 'remaining_hr': 0.188, 'lr/vision': 1.1365326029611262e-07, 'lr/merger': 2.8413315074028157e-06, 'lr/llm': 7.103328768507039e-07, 'epoch': 27.275862068965516}
{'loss': 0.026505551068112254, 'grad_norm': 22.57189178466797, 'lm_loss': 0.026505551068112254, 'teacher_lm_loss': 0.002021467480517458, 'student_lm_loss': 0.05659287446178496, 'remaining_hr': 0.185, 'lr/vision': 1.1019373565629093e-07, 'lr/merger': 2.7548433914072736e-06, 'lr/llm': 6.887108478518184e-07, 'epoch': 27.413793103448278}
{'loss': 0.10447310097515583, 'grad_norm': 30.317142486572266, 'lm_loss': 0.10447310097515583, 'teacher_lm_loss': 0.0012138531310483813, 'student_lm_loss': 0.174730337690562, 'remaining_hr': 0.182, 'lr/vision': 1.0677925126806955e-07, 'lr/merger': 2.669481281701739e-06, 'lr/llm': 6.673703204254348e-07, 'epoch': 27.551724137931036}
{'eval_loss': 2.7206153869628906, 'eval_runtime': 2.1283, 'eval_samples_per_second': 17.854, 'eval_steps_per_second': 1.879, 'lr/vision': 1.0677925126806955e-07, 'lr/merger': 2.669481281701739e-06, 'lr/llm': 6.673703204254348e-07, 'epoch': 27.551724137931036}
{'eval_loss': 2.7206153869628906, 'eval_runtime': 2.1283, 'eval_samples_per_second': 17.854, 'eval_steps_per_second': 1.879, 'lr/vision': 1.0677925126806955e-07, 'lr/merger': 2.669481281701739e-06, 'lr/llm': 6.673703204254348e-07, 'epoch': 27.551724137931036, 'eval_lm_loss': 1.2318, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.2288}
{'loss': 0.053646641317754984, 'grad_norm': 36.4621696472168, 'lm_loss': 0.053646641317754984, 'teacher_lm_loss': 0.003368489809872699, 'student_lm_loss': 0.07009285222738981, 'remaining_hr': 0.179, 'lr/vision': 1.034103377936693e-07, 'lr/merger': 2.5852584448417327e-06, 'lr/llm': 6.463146112104332e-07, 'epoch': 27.689655172413794}
{'loss': 0.05898275692015886, 'grad_norm': 21.937725067138672, 'lm_loss': 0.05898275692015886, 'teacher_lm_loss': 0.014099294672632823, 'student_lm_loss': 0.09681467711925507, 'remaining_hr': 0.176, 'lr/vision': 1.0008751881290627e-07, 'lr/merger': 2.502187970322657e-06, 'lr/llm': 6.255469925806643e-07, 'epoch': 27.82758620689655}
{'loss': 0.038812264101579785, 'grad_norm': 23.25750160217285, 'lm_loss': 0.038812264101579785, 'teacher_lm_loss': 0.03331696080567781, 'student_lm_loss': 0.06486678076907992, 'remaining_hr': 0.173, 'lr/vision': 9.681131074181874e-08, 'lr/merger': 2.420282768545469e-06, 'lr/llm': 6.050706921363672e-07, 'epoch': 27.96551724137931}
{'loss': 0.008200472220778465, 'grad_norm': 63.13316345214844, 'lm_loss': 0.008200472220778465, 'teacher_lm_loss': 0.0026177861727774143, 'student_lm_loss': 0.022987646982073784, 'remaining_hr': 0.169, 'lr/vision': 9.358222275240884e-08, 'lr/merger': 2.339555568810221e-06, 'lr/llm': 5.848888922025553e-07, 'epoch': 28.0}
{'loss': 0.039683046052232385, 'grad_norm': 18.117494583129883, 'lm_loss': 0.039683046052232385, 'teacher_lm_loss': 0.0011861388484248891, 'student_lm_loss': 0.08299438515678048, 'remaining_hr': 0.166, 'lr/vision': 9.040075669350904e-08, 'lr/merger': 2.2600189173377263e-06, 'lr/llm': 5.650047293344316e-07, 'epoch': 28.137931034482758}
{'loss': 0.06626195181161165, 'grad_norm': 17.553380966186523, 'lm_loss': 0.06626195181161165, 'teacher_lm_loss': 0.00023357401732937433, 'student_lm_loss': 0.060982564464211464, 'remaining_hr': 0.163, 'lr/vision': 8.726740701278807e-08, 'lr/merger': 2.1816851753197023e-06, 'lr/llm': 5.454212938299256e-07, 'epoch': 28.275862068965516}
{'loss': 0.05651884758844972, 'grad_norm': 43.71162796020508, 'lm_loss': 0.05651884758844972, 'teacher_lm_loss': 0.05182313881232403, 'student_lm_loss': 0.0977604715153575, 'remaining_hr': 0.16, 'lr/vision': 8.418266067990587e-08, 'lr/merger': 2.104566516997647e-06, 'lr/llm': 5.261416292494118e-07, 'epoch': 28.413793103448278}
{'loss': 0.06246393779292703, 'grad_norm': 35.21453857421875, 'lm_loss': 0.06246393779292703, 'teacher_lm_loss': 0.06407740701979492, 'student_lm_loss': 0.027899403125047684, 'remaining_hr': 0.157, 'lr/vision': 8.114699711083113e-08, 'lr/merger': 2.0286749277707783e-06, 'lr/llm': 5.071687319426946e-07, 'epoch': 28.551724137931036}
{'loss': 0.03190775541588664, 'grad_norm': 18.334264755249023, 'lm_loss': 0.03190775541588664, 'teacher_lm_loss': 0.0008008423487808614, 'student_lm_loss': 0.043847862631082535, 'remaining_hr': 0.154, 'lr/vision': 7.816088809333265e-08, 'lr/merger': 1.9540222023333165e-06, 'lr/llm': 4.885055505833291e-07, 'epoch': 28.689655172413794}
{'loss': 0.040143716149032116, 'grad_norm': 17.912492752075195, 'lm_loss': 0.040143716149032116, 'teacher_lm_loss': 0.00021487010963028297, 'student_lm_loss': 0.04202603711746633, 'remaining_hr': 0.151, 'lr/vision': 7.52247977136574e-08, 'lr/merger': 1.880619942841435e-06, 'lr/llm': 4.7015498571035877e-07, 'epoch': 28.82758620689655}
{'eval_loss': 2.9881703853607178, 'eval_runtime': 2.1599, 'eval_samples_per_second': 17.593, 'eval_steps_per_second': 1.852, 'lr/vision': 7.52247977136574e-08, 'lr/merger': 1.880619942841435e-06, 'lr/llm': 4.7015498571035877e-07, 'epoch': 28.82758620689655}
{'eval_loss': 2.9881703853607178, 'eval_runtime': 2.1599, 'eval_samples_per_second': 17.593, 'eval_steps_per_second': 1.852, 'lr/vision': 7.52247977136574e-08, 'lr/merger': 1.880619942841435e-06, 'lr/llm': 4.7015498571035877e-07, 'epoch': 28.82758620689655, 'eval_lm_loss': 1.3713, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.3524}
{'loss': 0.040942208375781775, 'grad_norm': 22.1036434173584, 'lm_loss': 0.040942208375781775, 'teacher_lm_loss': 0.000308944709104253, 'student_lm_loss': 0.031312158796936274, 'remaining_hr': 0.148, 'lr/vision': 7.233918228440323e-08, 'lr/merger': 1.808479557110081e-06, 'lr/llm': 4.5211988927752026e-07, 'epoch': 28.96551724137931}
{'loss': 0.03655411675572395, 'grad_norm': 22.1036434173584, 'lm_loss': 0.03655411675572395, 'teacher_lm_loss': 2.3160948330769315e-05, 'student_lm_loss': 0.025915585458278656, 'remaining_hr': 0.145, 'lr/vision': 6.950449027360213e-08, 'lr/merger': 1.7376122568400533e-06, 'lr/llm': 4.344030642100133e-07, 'epoch': 29.0}
{'loss': 0.05340188601985574, 'grad_norm': 38.256126403808594, 'lm_loss': 0.05340188601985574, 'teacher_lm_loss': 0.020905317724100314, 'student_lm_loss': 0.046566976234316826, 'remaining_hr': 0.142, 'lr/vision': 6.672116223502047e-08, 'lr/merger': 1.6680290558755119e-06, 'lr/llm': 4.1700726396887797e-07, 'epoch': 29.137931034482758}
{'loss': 0.04599849437363446, 'grad_norm': 21.631206512451172, 'lm_loss': 0.04599849437363446, 'teacher_lm_loss': 0.042099381709704176, 'student_lm_loss': 0.01571981981396675, 'remaining_hr': 0.139, 'lr/vision': 6.398963073969144e-08, 'lr/merger': 1.599740768492286e-06, 'lr/llm': 3.999351921230715e-07, 'epoch': 29.275862068965516}
{'loss': 0.020198993966914713, 'grad_norm': 126.73328399658203, 'lm_loss': 0.020198993966914713, 'teacher_lm_loss': 0.0005736208986490965, 'student_lm_loss': 0.028932093759067357, 'remaining_hr': 0.136, 'lr/vision': 6.131032030868634e-08, 'lr/merger': 1.5327580077171589e-06, 'lr/llm': 3.831895019292897e-07, 'epoch': 29.413793103448278}
{'loss': 0.04639142728410661, 'grad_norm': 16.506790161132812, 'lm_loss': 0.04639142728410661, 'teacher_lm_loss': 0.00014002461739437422, 'student_lm_loss': 0.04907174105755985, 'remaining_hr': 0.133, 'lr/vision': 5.8683647347137754e-08, 'lr/merger': 1.467091183678444e-06, 'lr/llm': 3.66772795919611e-07, 'epoch': 29.551724137931036}
{'loss': 0.027514695073477924, 'grad_norm': 120.64987182617188, 'lm_loss': 0.027514695073477924, 'teacher_lm_loss': 0.00041015256283571944, 'student_lm_loss': 0.018689856049604714, 'remaining_hr': 0.13, 'lr/vision': 5.611002007952388e-08, 'lr/merger': 1.4027505019880972e-06, 'lr/llm': 3.506876254970243e-07, 'epoch': 29.689655172413794}
{'loss': 0.024492505355738103, 'grad_norm': 33.883541107177734, 'lm_loss': 0.024492505355738103, 'teacher_lm_loss': 0.0007135507066777791, 'student_lm_loss': 0.029534785062423907, 'remaining_hr': 0.127, 'lr/vision': 5.358983848622451e-08, 'lr/merger': 1.339745962155613e-06, 'lr/llm': 3.3493649053890325e-07, 'epoch': 29.82758620689655}
{'loss': 0.03952912613749504, 'grad_norm': 33.162261962890625, 'lm_loss': 0.03952912613749504, 'teacher_lm_loss': 0.0003438830447066721, 'student_lm_loss': 0.039572146721184254, 'remaining_hr': 0.124, 'lr/vision': 5.112349424135787e-08, 'lr/merger': 1.278087356033947e-06, 'lr/llm': 3.1952183900848673e-07, 'epoch': 29.96551724137931}
{'loss': 0.02491879090666771, 'grad_norm': 33.162261962890625, 'lm_loss': 0.02491879090666771, 'teacher_lm_loss': 0.001424744725227356, 'student_lm_loss': 0.08254128694534302, 'remaining_hr': 0.12, 'lr/vision': 4.8711370651908536e-08, 'lr/merger': 1.2177842662977136e-06, 'lr/llm': 3.044460665744284e-07, 'epoch': 30.0}
{'eval_loss': 3.041684865951538, 'eval_runtime': 2.1634, 'eval_samples_per_second': 17.565, 'eval_steps_per_second': 1.849, 'lr/vision': 4.8711370651908536e-08, 'lr/merger': 1.2177842662977136e-06, 'lr/llm': 3.044460665744284e-07, 'epoch': 30.0}
{'eval_loss': 3.041684865951538, 'eval_runtime': 2.1634, 'eval_samples_per_second': 17.565, 'eval_steps_per_second': 1.849, 'lr/vision': 4.8711370651908536e-08, 'lr/merger': 1.2177842662977136e-06, 'lr/llm': 3.044460665744284e-07, 'epoch': 30.0, 'eval_lm_loss': 1.393, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.3558}
{'loss': 0.02438785950653255, 'grad_norm': 168.05577087402344, 'lm_loss': 0.02438785950653255, 'teacher_lm_loss': 0.000996308372123167, 'student_lm_loss': 0.031167147331871092, 'remaining_hr': 0.117, 'lr/vision': 4.6353842598156134e-08, 'lr/merger': 1.1588460649539036e-06, 'lr/llm': 2.897115162384759e-07, 'epoch': 30.137931034482758}
{'loss': 0.02284544031135738, 'grad_norm': 29.86360740661621, 'lm_loss': 0.02284544031135738, 'teacher_lm_loss': 0.002364256675946308, 'student_lm_loss': 0.021717563504353166, 'remaining_hr': 0.114, 'lr/vision': 4.405127647541258e-08, 'lr/merger': 1.1012819118853147e-06, 'lr/llm': 2.7532047797132867e-07, 'epoch': 30.275862068965516}
{'loss': 0.03982995712431148, 'grad_norm': 29.000709533691406, 'lm_loss': 0.03982995712431148, 'teacher_lm_loss': 0.0009340878605144098, 'student_lm_loss': 0.05247163656167686, 'remaining_hr': 0.111, 'lr/vision': 4.180403013707963e-08, 'lr/merger': 1.0451007534269908e-06, 'lr/llm': 2.612751883567477e-07, 'epoch': 30.413793103448278}
{'loss': 0.0659751477651298, 'grad_norm': 16.754615783691406, 'lm_loss': 0.0659751477651298, 'teacher_lm_loss': 0.00016726029753044713, 'student_lm_loss': 0.07775294175371528, 'remaining_hr': 0.108, 'lr/vision': 3.9612452839032386e-08, 'lr/merger': 9.903113209758098e-07, 'lr/llm': 2.4757783024395244e-07, 'epoch': 30.551724137931036}
{'loss': 0.032091696979478, 'grad_norm': 31.942340850830078, 'lm_loss': 0.032091696979478, 'teacher_lm_loss': 0.00048254712783091236, 'student_lm_loss': 0.039877041010186076, 'remaining_hr': 0.105, 'lr/vision': 3.7476885185340025e-08, 'lr/merger': 9.369221296335007e-07, 'lr/llm': 2.3423053240837518e-07, 'epoch': 30.689655172413794}
{'loss': 0.02975265309214592, 'grad_norm': 20.57717514038086, 'lm_loss': 0.02975265309214592, 'teacher_lm_loss': 0.00034008483089564834, 'student_lm_loss': 0.04544633300974965, 'remaining_hr': 0.102, 'lr/vision': 3.539765907533074e-08, 'lr/merger': 8.849414768832687e-07, 'lr/llm': 2.2123536922081717e-07, 'epoch': 30.82758620689655}
{'loss': 0.019514385843649507, 'grad_norm': 31.15460777282715, 'lm_loss': 0.019514385843649507, 'teacher_lm_loss': 0.0016813976790217566, 'student_lm_loss': 0.08206786471419036, 'remaining_hr': 0.099, 'lr/vision': 3.337509765200952e-08, 'lr/merger': 8.343774413002382e-07, 'lr/llm': 2.0859436032505954e-07, 'epoch': 30.96551724137931}
{'loss': 0.04269750416278839, 'grad_norm': 31.15460777282715, 'lm_loss': 0.04269750416278839, 'teacher_lm_loss': 5.1787166739813983e-05, 'student_lm_loss': 0.003054068423807621, 'remaining_hr': 0.096, 'lr/vision': 3.1409515251836907e-08, 'lr/merger': 7.852378812959227e-07, 'lr/llm': 1.9630947032398068e-07, 'epoch': 31.0}
{'loss': 0.045841400627978146, 'grad_norm': 66.21253967285156, 'lm_loss': 0.045841400627978146, 'teacher_lm_loss': 0.040361035065870965, 'student_lm_loss': 0.018152873730286956, 'remaining_hr': 0.093, 'lr/vision': 2.950121735587654e-08, 'lr/merger': 7.375304338969135e-07, 'lr/llm': 1.843826084742284e-07, 'epoch': 31.137931034482758}
{'loss': 0.03734115255065262, 'grad_norm': 15.647638320922852, 'lm_loss': 0.03734115255065262, 'teacher_lm_loss': 0.0005558540851779981, 'student_lm_loss': 0.057741264812648296, 'remaining_hr': 0.09, 'lr/vision': 2.7650500542318344e-08, 'lr/merger': 6.912625135579587e-07, 'lr/llm': 1.7281562838948968e-07, 'epoch': 31.275862068965516}
2025-07-04 09:54:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:02 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:03 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'eval_loss': 3.030176877975464, 'eval_runtime': 2.1815, 'eval_samples_per_second': 17.419, 'eval_steps_per_second': 1.834, 'lr/vision': 2.7650500542318344e-08, 'lr/merger': 6.912625135579587e-07, 'lr/llm': 1.7281562838948968e-07, 'epoch': 31.275862068965516}
{'eval_loss': 3.030176877975464, 'eval_runtime': 2.1815, 'eval_samples_per_second': 17.419, 'eval_steps_per_second': 1.834, 'lr/vision': 2.7650500542318344e-08, 'lr/merger': 6.912625135579587e-07, 'lr/llm': 1.7281562838948968e-07, 'epoch': 31.275862068965516, 'eval_lm_loss': 1.3964, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.3763}
2025-07-04 09:54:08 - INFO - training - ğŸ’¾ Saving complete Qwen2.5-VL model with visual tower (sharded)â€¦
2025-07-04 09:54:18 - INFO - training - ğŸ’¾ Saving tokenizer...
2025-07-04 09:54:18 - INFO - training - ğŸ’¾ Saving image processor...
2025-07-04 09:54:18 - INFO - training -    âœ… Image processor config saved with 9 parameters (preserving base config)
2025-07-04 09:54:18 - INFO - training - ğŸ’¾ Copying essential files from base model...
2025-07-04 09:54:18 - INFO - training -    âœ… generation_config.json already exists
2025-07-04 09:54:18 - INFO - training -    âœ… Copied chat_template.json (optional)
2025-07-04 09:54:18 - INFO - training -    âœ… Copied LICENSE (optional)
2025-07-04 09:54:18 - INFO - training -    âœ… Copied README.md (optional)
2025-07-04 09:54:18 - INFO - training - ğŸ” Verifying saved checkpoint components...
2025-07-04 09:54:18 - INFO - training -    âœ… config.json exists
2025-07-04 09:54:18 - INFO - training -    âœ… tokenizer_config.json exists
2025-07-04 09:54:18 - INFO - training -    âœ… preprocessor_config.json exists
2025-07-04 09:54:18 - INFO - training -    âœ… generation_config.json exists
2025-07-04 09:54:18 - INFO - training -    âœ… Found 5 safetensor files
2025-07-04 09:54:18 - INFO - training -    âœ… Total parameters saved: 445
2025-07-04 09:54:18 - INFO - training -    âœ… Visual tower parameters found: 390
2025-07-04 09:54:18 - INFO - training -       Examples: ['visual.blocks.0.attn.proj.bias', 'visual.blocks.0.attn.proj.weight', 'visual.blocks.0.attn.qkv.bias']...
2025-07-04 09:54:18 - INFO - training - âœ… Checkpoint saved successfully â†’ output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint-250
2025-07-04 09:54:39 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:39 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:39 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:39 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:39 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:44 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
/opt/conda/envs/ms/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
2025-07-04 09:54:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:47 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:50 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:50 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:50 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:50 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:50 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:50 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:53 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:53 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:53 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:53 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:53 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
2025-07-04 09:54:53 - INFO - training - ğŸ¯ Loss weights: teacher=0.30, student=2.00
{'loss': 0.02159653150010854, 'grad_norm': 12.208534240722656, 'lm_loss': 0.02159653150010854, 'teacher_lm_loss': 0.001389230958011467, 'student_lm_loss': 0.01195499807363376, 'remaining_hr': 0.088, 'lr/vision': 2.5857652440386403e-08, 'lr/merger': 6.464413110096601e-07, 'lr/llm': 1.6161032775241502e-07, 'epoch': 31.413793103448278}
{'loss': 0.034563102992251515, 'grad_norm': 74.90948486328125, 'lm_loss': 0.034563102992251515, 'teacher_lm_loss': 0.0002537456084610312, 'student_lm_loss': 0.06740995030850172, 'remaining_hr': 0.085, 'lr/vision': 2.4122951685636674e-08, 'lr/merger': 6.030737921409169e-07, 'lr/llm': 1.507684480352292e-07, 'epoch': 31.551724137931036}
{'loss': 0.02496086247265339, 'grad_norm': 31.302934646606445, 'lm_loss': 0.02496086247265339, 'teacher_lm_loss': 0.0001890094663394848, 'student_lm_loss': 0.03182941861450672, 'remaining_hr': 0.082, 'lr/vision': 2.244666787665297e-08, 'lr/merger': 5.611666969163243e-07, 'lr/llm': 1.4029167422908107e-07, 'epoch': 31.689655172413794}
{'loss': 0.02399339631665498, 'grad_norm': 18.06266975402832, 'lm_loss': 0.02399339631665498, 'teacher_lm_loss': 0.0006045278714736924, 'student_lm_loss': 0.08692803404119331, 'remaining_hr': 0.079, 'lr/vision': 2.082906153314732e-08, 'lr/merger': 5.207265383286831e-07, 'lr/llm': 1.3018163458217076e-07, 'epoch': 31.82758620689655}
{'loss': 0.012375645572319627, 'grad_norm': 61.912452697753906, 'lm_loss': 0.012375645572319627, 'teacher_lm_loss': 0.0007982740644365549, 'student_lm_loss': 0.02599018788896501, 'remaining_hr': 0.076, 'lr/vision': 1.9270384055471056e-08, 'lr/merger': 4.817596013867765e-07, 'lr/llm': 1.2043990034669413e-07, 'epoch': 31.96551724137931}
{'loss': 0.010774888098239899, 'grad_norm': 30.795141220092773, 'lm_loss': 0.010774888098239899, 'teacher_lm_loss': 0.0005708280368708074, 'student_lm_loss': 0.01785919815301895, 'remaining_hr': 0.073, 'lr/vision': 1.7770877685543685e-08, 'lr/merger': 4.4427194213859216e-07, 'lr/llm': 1.1106798553464804e-07, 'epoch': 32.0}
{'loss': 0.01784802647307515, 'grad_norm': 41.1740608215332, 'lm_loss': 0.01784802647307515, 'teacher_lm_loss': 0.010569492169452133, 'student_lm_loss': 0.019995186012238264, 'remaining_hr': 0.07, 'lr/vision': 1.6330775469204895e-08, 'lr/merger': 4.082693867301224e-07, 'lr/llm': 1.020673466825306e-07, 'epoch': 32.13793103448276}
{'loss': 0.012903172289952636, 'grad_norm': 25.296518325805664, 'lm_loss': 0.012903172289952636, 'teacher_lm_loss': 0.0006142354664007144, 'student_lm_loss': 0.02201800642069429, 'remaining_hr': 0.067, 'lr/vision': 1.4950301219995187e-08, 'lr/merger': 3.7375753049987974e-07, 'lr/llm': 9.343938262496994e-08, 'epoch': 32.275862068965516}
{'loss': 0.02947141567710787, 'grad_norm': 23.704368591308594, 'lm_loss': 0.02947141567710787, 'teacher_lm_loss': 0.015211968950097798, 'student_lm_loss': 0.028023019200190902, 'remaining_hr': 0.064, 'lr/vision': 1.362966948437272e-08, 'lr/merger': 3.4074173710931804e-07, 'lr/llm': 8.518543427732951e-08, 'epoch': 32.41379310344828}
{'loss': 0.039761277846992016, 'grad_norm': 58.596500396728516, 'lm_loss': 0.039761277846992016, 'teacher_lm_loss': 0.0018980720592480793, 'student_lm_loss': 0.03141270705964416, 'remaining_hr': 0.061, 'lr/vision': 1.236908550836886e-08, 'lr/merger': 3.0922713770922155e-07, 'lr/llm': 7.730678442730539e-08, 'epoch': 32.55172413793103}
{'eval_loss': 3.454223155975342, 'eval_runtime': 2.1372, 'eval_samples_per_second': 17.78, 'eval_steps_per_second': 1.872, 'lr/vision': 1.236908550836886e-08, 'lr/merger': 3.0922713770922155e-07, 'lr/llm': 7.730678442730539e-08, 'epoch': 32.55172413793103}
{'eval_loss': 3.454223155975342, 'eval_runtime': 2.1372, 'eval_samples_per_second': 17.78, 'eval_steps_per_second': 1.872, 'lr/vision': 1.236908550836886e-08, 'lr/merger': 3.0922713770922155e-07, 'lr/llm': 7.730678442730539e-08, 'epoch': 32.55172413793103, 'eval_lm_loss': 1.6206, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.6167}
{'loss': 0.03758607432246208, 'grad_norm': 34.977169036865234, 'lm_loss': 0.03758607432246208, 'teacher_lm_loss': 0.011774072637308564, 'student_lm_loss': 0.03905105567537248, 'remaining_hr': 0.058, 'lr/vision': 1.1168745205690199e-08, 'lr/merger': 2.7921863014225504e-07, 'lr/llm': 6.980465753556376e-08, 'epoch': 32.689655172413794}
{'loss': 0.009712788392789662, 'grad_norm': 28.060829162597656, 'lm_loss': 0.009712788392789662, 'teacher_lm_loss': 0.0005543920124182478, 'student_lm_loss': 0.024337216280400753, 'remaining_hr': 0.055, 'lr/vision': 1.0028835127270552e-08, 'lr/merger': 2.507208781817638e-07, 'lr/llm': 6.268021954544095e-08, 'epoch': 32.827586206896555}
{'loss': 0.016622325405478477, 'grad_norm': 31.132537841796875, 'lm_loss': 0.016622325405478477, 'teacher_lm_loss': 0.0015552590552943002, 'student_lm_loss': 0.00893980439286679, 'remaining_hr': 0.052, 'lr/vision': 8.949532432278185e-09, 'lr/merger': 2.2373831080695463e-07, 'lr/llm': 5.593457770173866e-08, 'epoch': 32.96551724137931}
{'loss': 0.030788324773311615, 'grad_norm': 31.132537841796875, 'lm_loss': 0.030788324773311615, 'teacher_lm_loss': 0.000213505671126768, 'student_lm_loss': 0.03756115585565567, 'remaining_hr': 0.049, 'lr/vision': 7.931004860582468e-09, 'lr/merger': 1.9827512151456175e-07, 'lr/llm': 4.956878037864044e-08, 'epoch': 33.0}
{'loss': 0.024048177932854742, 'grad_norm': 17.132326126098633, 'lm_loss': 0.024048177932854742, 'teacher_lm_loss': 0.00034253744888701476, 'student_lm_loss': 0.03795528179034591, 'remaining_hr': 0.046, 'lr/vision': 6.9734107066846906e-09, 'lr/merger': 1.7433526766711727e-07, 'lr/llm': 4.358381691677932e-08, 'epoch': 33.13793103448276}
{'loss': 0.01252672984264791, 'grad_norm': 12.661482810974121, 'lm_loss': 0.01252672984264791, 'teacher_lm_loss': 0.00044398889076546766, 'student_lm_loss': 0.013661811841302551, 'remaining_hr': 0.043, 'lr/vision': 6.076898795116792e-09, 'lr/merger': 1.519224698779198e-07, 'lr/llm': 3.798061746947995e-08, 'epoch': 33.275862068965516}
{'loss': 0.02514417329803109, 'grad_norm': 21.07765007019043, 'lm_loss': 0.02514417329803109, 'teacher_lm_loss': 0.00023192036405816907, 'student_lm_loss': 0.03259435365907848, 'remaining_hr': 0.039, 'lr/vision': 5.2416084573115636e-09, 'lr/merger': 1.3104021143278911e-07, 'lr/llm': 3.276005285819728e-08, 'epoch': 33.41379310344828}
{'loss': 0.02294444222934544, 'grad_norm': 33.493743896484375, 'lm_loss': 0.02294444222934544, 'teacher_lm_loss': 0.0003670632213470526, 'student_lm_loss': 0.01690571999642998, 'remaining_hr': 0.036, 'lr/vision': 4.467669509948591e-09, 'lr/merger': 1.1169173774871478e-07, 'lr/llm': 2.7922934437178695e-08, 'epoch': 33.55172413793103}
{'loss': 0.017340827733278275, 'grad_norm': 28.580259323120117, 'lm_loss': 0.017340827733278275, 'teacher_lm_loss': 0.00028738432774844114, 'student_lm_loss': 0.012171285139629617, 'remaining_hr': 0.033, 'lr/vision': 3.755202234778876e-09, 'lr/merger': 9.388005586947191e-08, 'lr/llm': 2.347001396736798e-08, 'epoch': 33.689655172413794}
{'loss': 0.010355895676184446, 'grad_norm': 34.5518913269043, 'lm_loss': 0.010355895676184446, 'teacher_lm_loss': 0.00020308686816861155, 'student_lm_loss': 0.013830835814587772, 'remaining_hr': 0.03, 'lr/vision': 3.1043173599311746e-09, 'lr/merger': 7.760793399827937e-08, 'lr/llm': 1.9401983499569843e-08, 'epoch': 33.827586206896555}
{'eval_loss': 3.4089343547821045, 'eval_runtime': 2.062, 'eval_samples_per_second': 18.429, 'eval_steps_per_second': 1.94, 'lr/vision': 3.1043173599311746e-09, 'lr/merger': 7.760793399827937e-08, 'lr/llm': 1.9401983499569843e-08, 'epoch': 33.827586206896555}
{'eval_loss': 3.4089343547821045, 'eval_runtime': 2.062, 'eval_samples_per_second': 18.429, 'eval_steps_per_second': 1.94, 'lr/vision': 3.1043173599311746e-09, 'lr/merger': 7.760793399827937e-08, 'lr/llm': 1.9401983499569843e-08, 'epoch': 33.827586206896555, 'eval_lm_loss': 1.5543, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.5558}
{'loss': 0.024632780579850078, 'grad_norm': 22.383541107177734, 'lm_loss': 0.024632780579850078, 'teacher_lm_loss': 0.00032665582784829894, 'student_lm_loss': 0.02920713648200035, 'remaining_hr': 0.027, 'lr/vision': 2.5151160427029583e-09, 'lr/merger': 6.287790106757396e-08, 'lr/llm': 1.571947526689349e-08, 'epoch': 33.96551724137931}
{'loss': 0.00529957190155983, 'grad_norm': 22.383541107177734, 'lm_loss': 0.00529957190155983, 'teacher_lm_loss': 0.0, 'student_lm_loss': 0.006236785091459751, 'remaining_hr': 0.024, 'lr/vision': 1.987689853839436e-09, 'lr/merger': 4.9692246345985905e-08, 'lr/llm': 1.2423061586496476e-08, 'epoch': 34.0}
{'loss': 0.010716415708884597, 'grad_norm': 18.36136817932129, 'lm_loss': 0.010716415708884597, 'teacher_lm_loss': 0.00015172328312473837, 'student_lm_loss': 0.009695702116005123, 'remaining_hr': 0.021, 'lr/vision': 1.5221207633017818e-09, 'lr/merger': 3.805301908254455e-08, 'lr/llm': 9.513254770636138e-09, 'epoch': 34.13793103448276}
{'loss': 0.022753797005861998, 'grad_norm': 30.683094024658203, 'lm_loss': 0.022753797005861998, 'teacher_lm_loss': 0.0003614872839534655, 'student_lm_loss': 0.023373391712084413, 'remaining_hr': 0.018, 'lr/vision': 1.1184811275279481e-09, 'lr/merger': 2.796202818819871e-08, 'lr/llm': 6.990507047049677e-09, 'epoch': 34.275862068965516}
{'loss': 0.006815516273491085, 'grad_norm': 9.824540138244629, 'lm_loss': 0.006815516273491085, 'teacher_lm_loss': 0.000359094680788985, 'student_lm_loss': 0.00847140035330085, 'remaining_hr': 0.015, 'lr/vision': 7.768336781872608e-10, 'lr/merger': 1.9420841954681525e-08, 'lr/llm': 4.855210488670381e-09, 'epoch': 34.41379310344828}
{'loss': 0.011295138043351471, 'grad_norm': 15.610886573791504, 'lm_loss': 0.011295138043351471, 'teacher_lm_loss': 0.0002804786427077488, 'student_lm_loss': 0.01847436069510877, 'remaining_hr': 0.012, 'lr/vision': 4.972315124310622e-10, 'lr/merger': 1.2430787810776556e-08, 'lr/llm': 3.107696952694139e-09, 'epoch': 34.55172413793103}
{'loss': 0.012263593962416053, 'grad_norm': 37.37141036987305, 'lm_loss': 0.012263593962416053, 'teacher_lm_loss': 0.00023838106119455915, 'student_lm_loss': 0.012642086134292185, 'remaining_hr': 0.009, 'lr/vision': 2.7971808464055667e-10, 'lr/merger': 6.992952116013918e-09, 'lr/llm': 1.7482380290034795e-09, 'epoch': 34.689655172413794}
{'loss': 0.018495778611395508, 'grad_norm': 18.707508087158203, 'lm_loss': 0.018495778611395508, 'teacher_lm_loss': 0.009722585389681626, 'student_lm_loss': 0.014215236325981095, 'remaining_hr': 0.006, 'lr/vision': 1.243271996735018e-10, 'lr/merger': 3.1081799918375454e-09, 'lr/llm': 7.770449979593864e-10, 'epoch': 34.827586206896555}
{'loss': 0.01858262170571834, 'grad_norm': 20.437545776367188, 'lm_loss': 0.01858262170571834, 'teacher_lm_loss': 8.512982549291337e-05, 'student_lm_loss': 0.017175438697449863, 'remaining_hr': 0.003, 'lr/vision': 3.108300761005544e-11, 'lr/merger': 7.770751902513862e-10, 'lr/llm': 1.9426879756284656e-10, 'epoch': 34.96551724137931}
{'loss': 0.02770022489130497, 'grad_norm': 20.437545776367188, 'lm_loss': 0.02770022489130497, 'teacher_lm_loss': 0.00014785671373829246, 'student_lm_loss': 0.00016022338240873069, 'remaining_hr': 0.0, 'lr/vision': 0.0, 'lr/merger': 0.0, 'lr/llm': 0.0, 'epoch': 35.0}
{'eval_loss': 3.541808605194092, 'eval_runtime': 2.0633, 'eval_samples_per_second': 18.417, 'eval_steps_per_second': 1.939, 'lr/vision': 0.0, 'lr/merger': 0.0, 'lr/llm': 0.0, 'epoch': 35.0}
{'eval_loss': 3.541808605194092, 'eval_runtime': 2.0633, 'eval_samples_per_second': 18.417, 'eval_steps_per_second': 1.939, 'lr/vision': 0.0, 'lr/merger': 0.0, 'lr/llm': 0.0, 'epoch': 35.0, 'eval_lm_loss': 1.6554, 'eval_lm_teacher_loss': 0.0, 'eval_lm_student_loss': 1.65}
2025-07-04 09:59:50 - INFO - training - ğŸ’¾ Saving complete Qwen2.5-VL model with visual tower (sharded)â€¦
2025-07-04 10:00:00 - INFO - training - ğŸ’¾ Saving tokenizer...
2025-07-04 10:00:00 - INFO - training - ğŸ’¾ Saving image processor...
2025-07-04 10:00:00 - INFO - training -    âœ… Image processor config saved with 9 parameters (preserving base config)
2025-07-04 10:00:00 - INFO - training - ğŸ’¾ Copying essential files from base model...
2025-07-04 10:00:00 - INFO - training -    âœ… generation_config.json already exists
2025-07-04 10:00:00 - INFO - training -    âœ… Copied chat_template.json (optional)
2025-07-04 10:00:00 - INFO - training -    âœ… Copied LICENSE (optional)
2025-07-04 10:00:00 - INFO - training -    âœ… Copied README.md (optional)
2025-07-04 10:00:00 - INFO - training - ğŸ” Verifying saved checkpoint components...
2025-07-04 10:00:00 - INFO - training -    âœ… config.json exists
2025-07-04 10:00:00 - INFO - training -    âœ… tokenizer_config.json exists
2025-07-04 10:00:00 - INFO - training -    âœ… preprocessor_config.json exists
2025-07-04 10:00:00 - INFO - training -    âœ… generation_config.json exists
2025-07-04 10:00:00 - INFO - training -    âœ… Found 5 safetensor files
2025-07-04 10:00:00 - INFO - training -    âœ… Total parameters saved: 445
2025-07-04 10:00:00 - INFO - training -    âœ… Visual tower parameters found: 390
2025-07-04 10:00:00 - INFO - training -       Examples: ['visual.blocks.0.attn.proj.bias', 'visual.blocks.0.attn.proj.weight', 'visual.blocks.0.attn.qkv.bias']...
2025-07-04 10:00:00 - INFO - training - âœ… Checkpoint saved successfully â†’ output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint-280
2025-07-04 10:00:27 - INFO - training - ğŸ’¾ Trainer state saved
{'train_runtime': 3088.5452, 'train_samples_per_second': 4.494, 'train_steps_per_second': 0.091, 'train_loss': 0.6968509129115513, 'lr/vision': 0.0, 'lr/merger': 0.0, 'lr/llm': 0.0, 'epoch': 35.0}2025-07-04 10:00:27 - INFO - training - ğŸ’¾ Trainer state saved

2025-07-04 10:00:27 - INFO - training - ğŸ’¾ Trainer state saved
2025-07-04 10:00:27 - INFO - training - ğŸ’¾ Trainer state saved
2025-07-04 10:00:27 - INFO - training - ğŸ’¾ Trainer state saved
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
2025-07-04 10:00:27 - INFO - training - ğŸ’¾ Trainer state saved
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:28 - INFO - training - ğŸ“„ CheckpointManager using legacy configuration system
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Saving model to output-74/7-4-teacher_student_loss_weight_roundFloats...
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:28 - INFO - training - ğŸ“„ CheckpointManager using legacy configuration system
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Saving model to output-74/7-4-teacher_student_loss_weight_roundFloats...
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:28 - INFO - training - ğŸ“„ CheckpointManager using legacy configuration system
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Saving model to output-74/7-4-teacher_student_loss_weight_roundFloats...
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:28 - INFO - training - ğŸ“„ CheckpointManager using legacy configuration system
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Saving model to output-74/7-4-teacher_student_loss_weight_roundFloats...
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:28 - INFO - training - ğŸ“„ CheckpointManager using legacy configuration system
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Saving model to output-74/7-4-teacher_student_loss_weight_roundFloats...
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:28 - INFO - training - ğŸ“„ CheckpointManager using legacy configuration system
2025-07-04 10:00:28 - INFO - training - ğŸ’¾ Saving model to output-74/7-4-teacher_student_loss_weight_roundFloats...
2025-07-04 10:00:31 - INFO - training - ğŸ’¾ Saving complete Qwen2.5-VL model with visual tower (sharded)â€¦
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ“‹ Checkpoint metadata saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint_metadata.json
2025-07-04 10:00:33 - INFO - training - âœ… Model saved successfully to output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Model saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - âœ… Training completed successfully!
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ“‹ Checkpoint metadata saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint_metadata.json
2025-07-04 10:00:33 - INFO - training - âœ… Model saved successfully to output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Model saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - âœ… Training completed successfully!
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ“‹ Checkpoint metadata saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint_metadata.json
2025-07-04 10:00:33 - INFO - training - âœ… Model saved successfully to output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Model saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - âœ… Training completed successfully!
2025-07-04 10:00:33 - INFO - training - ğŸ“‹ Checkpoint metadata saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint_metadata.json
2025-07-04 10:00:33 - INFO - training - âœ… Model saved successfully to output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Model saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - âœ… Training completed successfully!
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ“‹ Checkpoint metadata saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint_metadata.json
2025-07-04 10:00:33 - INFO - training - âœ… Model saved successfully to output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - ğŸ’¾ Model saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:33 - INFO - training - âœ… Training completed successfully!
2025-07-04 10:00:41 - INFO - training - ğŸ’¾ Saving tokenizer...
2025-07-04 10:00:42 - INFO - training - ğŸ’¾ Saving image processor...
2025-07-04 10:00:42 - INFO - training -    âœ… Image processor config saved with 9 parameters (preserving base config)
2025-07-04 10:00:42 - INFO - training - ğŸ’¾ Copying essential files from base model...
2025-07-04 10:00:42 - INFO - training -    âœ… generation_config.json already exists
2025-07-04 10:00:42 - INFO - training -    âœ… Copied chat_template.json (optional)
2025-07-04 10:00:42 - INFO - training -    âœ… Copied LICENSE (optional)
2025-07-04 10:00:42 - INFO - training -    âœ… Copied README.md (optional)
2025-07-04 10:00:42 - INFO - training - ğŸ” Verifying saved checkpoint components...
2025-07-04 10:00:42 - INFO - training -    âœ… config.json exists
2025-07-04 10:00:42 - INFO - training -    âœ… tokenizer_config.json exists
2025-07-04 10:00:42 - INFO - training -    âœ… preprocessor_config.json exists
2025-07-04 10:00:42 - INFO - training -    âœ… generation_config.json exists
2025-07-04 10:00:42 - INFO - training -    âœ… Found 5 safetensor files
2025-07-04 10:00:42 - INFO - training -    âœ… Total parameters saved: 445
2025-07-04 10:00:42 - INFO - training -    âœ… Visual tower parameters found: 390
2025-07-04 10:00:42 - INFO - training -       Examples: ['visual.blocks.0.attn.proj.bias', 'visual.blocks.0.attn.proj.weight', 'visual.blocks.0.attn.qkv.bias']...
2025-07-04 10:00:42 - INFO - training - âœ… Checkpoint saved successfully â†’ output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:42 - INFO - training - ğŸ’¾ Image processor saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:42 - INFO - training - ğŸ“‹ Checkpoint metadata saved to: output-74/7-4-teacher_student_loss_weight_roundFloats/checkpoint_metadata.json
2025-07-04 10:00:42 - INFO - training - âœ… Model saved successfully to output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:42 - INFO - training - ğŸ’¾ Model saved to: output-74/7-4-teacher_student_loss_weight_roundFloats
2025-07-04 10:00:42 - INFO - training - âœ… Training completed successfully!
âœ… Training completed successfully!
